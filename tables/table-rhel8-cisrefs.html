<html xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Rules with CIS Reference in Guide to the Secure Configuration of Red Hat Enterprise Linux 8</title>
</head>
<body>
	<br><br><div style="text-align: center; font-size: x-large; font-weight:bold">Rules with CIS Reference in Guide to the Secure Configuration of Red Hat Enterprise Linux 8</div>
<br><br><style type="text/css">
		table
		{
			border-collapse:collapse;
		}
		table, th, td
		{
			border: 2px solid #dcdcdc;
			border-left: none;
			border-right: none;
			vertical-align: top;
			padding: 2px;
			font-family: verdana,arial,sans-serif;
			font-size:11px;
		}
		pre { 
			white-space: pre-wrap;
			white-space: -moz-pre-wrap !important;
			word-wrap:break-word; 
		}
		table tr:nth-child(2n+2) { background-color: #f4f4f4; }
		thead
		{
			display: table-header-group;
			font-weight: bold;
			background-color: #dedede;
		}
	</style>

<table>
<thead>
  <td>Mapping</td>
  <td>Rule Title</td>
  <td>Description</td>
  <td>Rationale</td>
</thead>
<tr>
  <td>1.1.1.1</td>
  <td>Disable Mounting of cramfs</td>
  <td xml:lang="en-US">

To configure the system to prevent the <code>cramfs</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install cramfs /bin/true</pre>
This effectively prevents usage of this uncommon filesystem.

The <tt>cramfs</tt> filesystem type is a compressed read-only
Linux filesystem embedded in small footprint systems. A
<tt>cramfs</tt> image can be used without having to first
decompress the image.
  </td>
  <td xml:lang="en-US">
Removing support for unneeded filesystem types reduces the local attack surface
of the server.
  </td>
</tr>
<tr>
  <td>1.1.1.2</td>
  <td>Disable Mounting of vFAT filesystems</td>
  <td xml:lang="en-US">

To configure the system to prevent the <code>vfat</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install vfat /bin/true</pre>
This effectively prevents usage of this uncommon filesystem.

The <tt>vFAT</tt> filesystem format is primarily used on older
windows systems and portable USB drives or flash modules. It comes
in three types <tt>FAT12</tt>, <tt>FAT16</tt>, and <tt>FAT32</tt>
all of which are supported by the <tt>vfat</tt> kernel module.
  </td>
  <td xml:lang="en-US">
Removing support for unneeded filesystems reduces the local attack
surface of the system.
  </td>
</tr>
<tr>
  <td>1.1.1.3</td>
  <td>Disable Mounting of squashfs</td>
  <td xml:lang="en-US">

To configure the system to prevent the <code>squashfs</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install squashfs /bin/true</pre>
This effectively prevents usage of this uncommon filesystem.

The <tt>squashfs</tt> filesystem type is a compressed read-only Linux
filesystem embedded in small footprint systems (similar to
<tt>cramfs</tt>). A <tt>squashfs</tt> image can be used without having
to first decompress the image.
  </td>
  <td xml:lang="en-US">
Removing support for unneeded filesystem types reduces the local attack
surface of the system.
  </td>
</tr>
<tr>
  <td>1.1.1.4</td>
  <td>Disable Mounting of udf</td>
  <td xml:lang="en-US">

To configure the system to prevent the <code>udf</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install udf /bin/true</pre>
This effectively prevents usage of this uncommon filesystem.

The <tt>udf</tt> filesystem type is the universal disk format
used to implement the ISO/IEC 13346 and ECMA-167 specifications.
This is an open vendor filesystem type for data storage on a broad
range of media. This filesystem type is neccessary to support
writing DVDs and newer optical disc formats.
  </td>
  <td xml:lang="en-US">
Removing support for unneeded filesystem types reduces the local
attack surface of the system.
  </td>
</tr>
<tr>
  <td>1.1.2</td>
  <td>Ensure /tmp Located On Separate Partition</td>
  <td xml:lang="en-US">
The <tt>/tmp</tt> directory is a world-writable directory used
for temporary file storage. Ensure it has its own partition or
logical volume at installation time, or migrate it using LVM.
  </td>
  <td xml:lang="en-US">
The <tt>/tmp</tt> partition is used as temporary storage by many programs.
Placing <tt>/tmp</tt> in its own partition enables the setting of more
restrictive mount options, which can help protect programs which use it.
  </td>
</tr>
<tr>
  <td>1.1.3</td>
  <td>Add nodev Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/tmp</tt>. Legitimate character and block devices
should not exist within temporary directories like <tt>/tmp</tt>.
Add the <code>nodev</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
</tr>
<tr>
  <td>1.1.4</td>
  <td>Add nosuid Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/tmp</tt>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
</tr>
<tr>
  <td>1.1.5</td>
  <td>Add noexec Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/tmp</tt>.
Add the <code>noexec</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/tmp</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
</tr>
<tr>
  <td>1.1.6</td>
  <td>Ensure /var Located On Separate Partition</td>
  <td xml:lang="en-US">
The <tt>/var</tt> directory is used by daemons and other system
services to store frequently-changing data. Ensure that <tt>/var</tt> has its own partition
or logical volume at installation time, or migrate it using LVM.
  </td>
  <td xml:lang="en-US">
Ensuring that <tt>/var</tt> is mounted on its own partition enables the
setting of more restrictive mount options. This helps protect
system services such as daemons or other programs which use it.
It is not uncommon for the <tt>/var</tt> directory to contain
world-writable directories installed by other software packages.
  </td>
</tr>
<tr>
  <td>1.1.7</td>
  <td>Ensure /var/tmp Located On Separate Partition</td>
  <td xml:lang="en-US">
The <tt>/var/tmp</tt> directory is a world-writable directory used
for temporary file storage. Ensure it has its own partition or
logical volume at installation time, or migrate it using LVM.
  </td>
  <td xml:lang="en-US">
The <tt>/var/tmp</tt> partition is used as temporary storage by many programs.
Placing <tt>/var/tmp</tt> in its own partition enables the setting of more
restrictive mount options, which can help protect programs which use it.
  </td>
</tr>
<tr>
  <td>1.1.8</td>
  <td>Add nodev Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/var/tmp</tt>. Legitimate character and block devices
should not exist within temporary directories like <tt>/var/tmp</tt>.
Add the <code>nodev</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
</tr>
<tr>
  <td>1.1.9</td>
  <td>Add nosuid Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/var/tmp</tt>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
</tr>
<tr>
  <td>1.1.10</td>
  <td>Add noexec Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/var/tmp</tt>.
Add the <code>noexec</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/var/tmp</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
</tr>
<tr>
  <td>1.1.11</td>
  <td>Ensure /var/log Located On Separate Partition</td>
  <td xml:lang="en-US">
System logs are stored in the <tt>/var/log</tt> directory.

Ensure that <code>/var/log</code> has its own partition or logical
volume at installation time, or migrate it using LVM.
  </td>
  <td xml:lang="en-US">
Placing <tt>/var/log</tt> in its own partition
enables better separation between log files
and other files in <tt>/var/</tt>.
  </td>
</tr>
<tr>
  <td>1.1.12</td>
  <td>Ensure /var/log/audit Located On Separate Partition</td>
  <td xml:lang="en-US">
Audit logs are stored in the <tt>/var/log/audit</tt> directory.

Ensure that <code>/var/log/audit</code> has its own partition or logical
volume at installation time, or migrate it using LVM.
Make absolutely certain that it is large enough to store all
audit logs that will be created by the auditing daemon.
  </td>
  <td xml:lang="en-US">
Placing <tt>/var/log/audit</tt> in its own partition
enables better separation between audit files
and other files, and helps ensure that
auditing cannot be halted due to the partition running out
of space.
  </td>
</tr>
<tr>
  <td>1.1.13</td>
  <td>Ensure /home Located On Separate Partition</td>
  <td xml:lang="en-US">
If user home directories will be stored locally, create a separate partition
for <tt>/home</tt> at installation time (or migrate it later using LVM). If
<tt>/home</tt> will be mounted from another system such as an NFS server, then
creating a separate partition is not necessary at installation time, and the
mountpoint can instead be configured later.
  </td>
  <td xml:lang="en-US">
Ensuring that <tt>/home</tt> is mounted on its own partition enables the
setting of more restrictive mount options, and also helps ensure that
users cannot trivially fill partitions used for log or audit data storage.
  </td>
</tr>
<tr>
  <td>1.1.14</td>
  <td>Add nodev Option to /home</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/home</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/home</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
</tr>
<tr>
  <td>1.1.15</td>
  <td>Add nodev Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent creation of device
files in <tt>/dev/shm</tt>. Legitimate character and block devices should
not exist within temporary directories like <tt>/dev/shm</tt>.
Add the <code>nodev</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
</tr>
<tr>
  <td>1.1.16</td>
  <td>Add nosuid Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent execution
of setuid programs in <tt>/dev/shm</tt>.  The SUID and SGID permissions should not
be required in these world-writable directories.
Add the <code>nosuid</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
</tr>
<tr>
  <td>1.1.17</td>
  <td>Add noexec Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/dev/shm</tt>.
It can be dangerous to allow the execution of binaries
from world-writable temporary storage directories such as <tt>/dev/shm</tt>.
Add the <code>noexec</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/dev/shm</tt> can expose the system to potential compromise.
  </td>
</tr>
<tr>
  <td>1.1.18</td>
  <td>Add nodev Option to Removable Media Partitions</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option prevents files from being
interpreted as character or block devices.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of

    any removable media partitions.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. An exception to this is chroot jails, and it is
not advised to set <tt>nodev</tt> on partitions which contain their root
filesystems.
  </td>
</tr>
<tr>
  <td>1.1.19</td>
  <td>Add nosuid Option to Removable Media Partitions</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option prevents set-user-identifier (SUID)
and set-group-identifier (SGID) permissions from taking effect. These permissions
allow users to execute binaries with the same permissions as the owner and group
of the file respectively. Users should not be allowed to introduce SUID and SGID
files into the system via partitions mounted from removeable media.
Add the <code>nosuid</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of

    any removable media partitions.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Allowing
users to introduce SUID or SGID binaries from partitions mounted off of
removable media would allow them to introduce their own highly-privileged programs.
  </td>
</tr>
<tr>
  <td>1.1.20</td>
  <td>Add noexec Option to Removable Media Partitions</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option prevents the direct execution of binaries
on the mounted filesystem. Preventing the direct execution of binaries from
removable media (such as a USB key) provides a defense against malicious
software that may be present on such untrusted media.
Add the <code>noexec</code> option to the fourth column of
<tt>/etc/fstab</tt> for the line which controls mounting of

    any removable media partitions.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from removable media such as USB keys exposes
the system to potential compromise.
  </td>
</tr>
<tr>
  <td>1.1.21</td>
  <td>Verify that All World-Writable Directories Have Sticky Bits Set</td>
  <td xml:lang="en-US">
When the so-called 'sticky bit' is set on a directory,
only the owner of a given file may remove that file from the
directory. Without the sticky bit, any user with write access to a
directory may remove any file in the directory. Setting the sticky
bit prevents users from removing each other's files. In cases where
there is no reason for a directory to be world-writable, a better
solution is to remove that permission rather than to set the sticky
bit. However, if a directory is used by a particular application,
consult that application's documentation instead of blindly
changing modes.
<br />
To set the sticky bit on a world-writable directory <i>DIR</i>, run the
following command:
<pre>$ sudo chmod +t <i>DIR</i></pre>
  </td>
  <td xml:lang="en-US">
Failing to set the sticky bit on public directories allows unauthorized
users to delete files in the directory structure.
<br /><br />
The only authorized public directories are those temporary directories
supplied with the system, or those designed to be temporary file
repositories. The setting is normally reserved for directories used by the
system, by users for temporary file storage (such as <tt>/tmp</tt>), and
for directories requiring global read/write access.
  </td>
</tr>
<tr>
  <td>1.1.22</td>
  <td>Disable the Automounter</td>
  <td xml:lang="en-US">
The <tt>autofs</tt> daemon mounts and unmounts filesystems, such as user
home directories shared via NFS, on demand. In addition, autofs can be used to handle
removable media, and the default configuration provides the cdrom device as <tt>/misc/cd</tt>.
However, this method of providing access to removable media is not common, so autofs
can almost always be disabled if NFS is not in use. Even if NFS is required, it may be
possible to configure filesystem mounts statically by editing <tt>/etc/fstab</tt>
rather than relying on the automounter.
<br /><br />

The <code>autofs</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now autofs.service</pre>
  </td>
  <td xml:lang="en-US">
Disabling the automounter permits the administrator to
statically control filesystem mounting through <tt>/etc/fstab</tt>.
<br /><br />
Additionally, automatically mounting filesystems permits easy introduction of
unknown devices, thereby facilitating malicious activity.
  </td>
</tr>
<tr>
  <td>1.1.23</td>
  <td>Disable Modprobe Loading of USB Storage Driver</td>
  <td xml:lang="en-US">
To prevent USB storage devices from being used, configure the kernel module loading system
to prevent automatic loading of the USB storage driver.

To configure the system to prevent the <code>usb-storage</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install usb-storage /bin/true</pre>
This will prevent the <tt>modprobe</tt> program from loading the <tt>usb-storage</tt>
module, but will not prevent an administrator (or another program) from using the
<tt>insmod</tt> program to load the module manually.
  </td>
  <td xml:lang="en-US">
USB storage devices such as thumb drives can be used to introduce
malicious software.
  </td>
</tr>
<tr>
  <td>1.2.2</td>
  <td>Disable Red Hat Network Service (rhnsd)</td>
  <td xml:lang="en-US">
The Red Hat Network service automatically queries Red Hat Network
servers to determine whether there are any actions that should be executed,
such as package updates. This only occurs if the system was registered to an
RHN server or satellite and managed as such.

The <code>rhnsd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now rhnsd.service</pre>
  </td>
  <td xml:lang="en-US">
Although systems management and patching is extremely important to
system security, management by a system outside the enterprise enclave is not
desirable for some environments.  However, if the system is being managed by RHN or
 RHN Satellite Server the <tt>rhnsd</tt> daemon can remain on.
  </td>
</tr>
<tr>
  <td>1.2.3</td>
  <td>Ensure Red Hat GPG Key Installed</td>
  <td xml:lang="en-US">
To ensure the system can cryptographically verify base software packages
come from Red Hat (and to connect to the Red Hat Network to receive them),
the Red Hat GPG key must properly be installed. To install the Red Hat GPG
key, run:
<pre>$ sudo subscription-manager register</pre>

If the system is not connected to the Internet or an RHN Satellite, then
install the Red Hat GPG key from trusted media such as the Red Hat
installation CD-ROM or DVD. Assuming the disc is mounted in
<tt>/media/cdrom</tt>, use the following command as the root user to import
it into the keyring:
<pre>$ sudo rpm --import /media/cdrom/RPM-GPG-KEY</pre>

Alternatively, the key may be pre-loaded during the RHEL installation. In
such cases, the key can be installed by running the following command:
<pre>sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</pre>
  </td>
  <td xml:lang="en-US">
Changes to software components can have significant effects on the overall
security of the operating system. This requirement ensures the software has
not been tampered with and that it has been provided by a trusted vendor.
The Red Hat GPG key is necessary to cryptographically verify packages are
from Red Hat.
  </td>
</tr>
<tr>
  <td>1.2.4</td>
  <td>Ensure gpgcheck Enabled In Main yum Configuration</td>
  <td xml:lang="en-US">
The <tt>gpgcheck</tt> option controls whether
RPM packages' signatures are always checked prior to installation.
To configure yum to check package signatures before installing
them, ensure the following line appears in <tt>/etc/yum.conf</tt> in
the <tt>[main]</tt> section:
<pre>gpgcheck=1</pre>
  </td>
  <td xml:lang="en-US">
Changes to any software components can have significant effects on the
overall security of the operating system. This requirement ensures the
software has not been tampered with and that it has been provided by a
trusted vendor.
<br />
Accordingly, patches, service packs, device drivers, or operating system
components must be signed with a certificate recognized and approved by the
organization.
<br />Verifying the authenticity of the software prior to installation
validates the integrity of the patch or upgrade received from a vendor.
This ensures the software has not been tampered with and that it has been
provided by a trusted vendor. Self-signed certificates are disallowed by
this requirement. Certificates used to verify the software must be from an
approved Certificate Authority (CA).
  </td>
</tr>
<tr>
  <td>1.3.1</td>
  <td>Install sudo Package</td>
  <td xml:lang="en-US">
The <code>sudo</code> package can be installed with the following command:
<pre>
$ sudo yum install sudo</pre>
  </td>
  <td xml:lang="en-US">
<tt>sudo</tt> is a program designed to allow a system administrator to give
limited root privileges to users and log root activity. The basic philosophy
is to give as few privileges as possible but still allow system users to
get their work done.
  </td>
</tr>
<tr>
  <td>1.3.2</td>
  <td>Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo use_pty</td>
  <td xml:lang="en-US">
The sudo <tt>use_pty</tt> tag, when specified, will only execute sudo
commands from users logged in to a real tty.
This should be enabled by making sure that the <tt>use_pty</tt> tag exists in
<tt>/etc/sudoers</tt> configuration file or any sudo configuration snippets
in <tt>/etc/sudoers.d/</tt>.
  </td>
  <td xml:lang="en-US">
Requiring that sudo commands be run in a pseudo-terminal can prevent an attacker from retaining
access to the user's terminal after the main program has finished executing.
  </td>
</tr>
<tr>
  <td>1.3.3</td>
  <td>Ensure Sudo Logfile Exists - sudo logfile</td>
  <td xml:lang="en-US">
A custom log sudo file can be configured with the 'logfile' tag. This rule configures
a sudo custom logfile at the default location suggested by CIS, which uses
/var/log/sudo.log.
  </td>
  <td xml:lang="en-US">
A sudo log file simplifies auditing of sudo commands.
  </td>
</tr>
<tr>
  <td>1.4.1</td>
  <td>Install AIDE</td>
  <td xml:lang="en-US">
The <code>aide</code> package can be installed with the following command:
<pre>
$ sudo yum install aide</pre>
  </td>
  <td xml:lang="en-US">
The AIDE package must be installed if it is to be available for integrity checking.
  </td>
</tr>
<tr>
  <td>1.4.2</td>
  <td>Configure Periodic Execution of AIDE</td>
  <td xml:lang="en-US">
At a minimum, AIDE should be configured to run a weekly scan.
To implement a daily execution of AIDE at 4:05am using cron, add the following line to <tt>/etc/crontab</tt>:
<pre>05 4 * * * root  --check</pre>
To implement a weekly execution of AIDE at 4:05am using cron, add the following line to <tt>/etc/crontab</tt>:
<pre>05 4 * * 0 root  --check</pre>
AIDE can be executed periodically through other means; this is merely one example.
The usage of cron's special time codes, such as  <tt>@daily</tt> and
<tt>@weekly</tt> is acceptable.
  </td>
  <td xml:lang="en-US">
By default, AIDE does not install itself for periodic execution. Periodically
running AIDE is necessary to reveal unexpected changes in installed files.
<br /><br />
Unauthorized changes to the baseline configuration could make the system vulnerable
to various attacks or allow unauthorized access to the operating system. Changes to
operating system configurations can have unintended side effects, some of which may
be relevant to security.
<br /><br />
Detecting such changes and providing an automated response can help avoid unintended,
negative consequences that could ultimately affect the security state of the operating
system. The operating system's Information Management Officer (IMO)/Information System
Security Officer (ISSO) and System Administrators (SAs) must be notified via email and/or
monitoring system trap when there is an unauthorized modification of a configuration item.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify /boot/grub2/grub.cfg Permissions</td>
  <td xml:lang="en-US">
File permissions for <tt>/boot/grub2/grub.cfg</tt> should be set to 600.

To properly set the permissions of <code>/boot/grub2/grub.cfg</code>, run the command:
<pre>$ sudo chmod 600 /boot/grub2/grub.cfg</pre>
  </td>
  <td xml:lang="en-US">
Proper permissions ensure that only the root user can modify important boot
parameters.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify /boot/grub2/grub.cfg Group Ownership</td>
  <td xml:lang="en-US">
The file <tt>/boot/grub2/grub.cfg</tt> should
be group-owned by the <tt>root</tt> group to prevent
destruction or modification of the file.

To properly set the group owner of <code>/boot/grub2/grub.cfg</code>, run the command:
<pre>$ sudo chgrp root /boot/grub2/grub.cfg</pre>
  </td>
  <td xml:lang="en-US">
The <tt>root</tt> group is a highly-privileged group. Furthermore, the group-owner of this
file should not have any access privileges anyway.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify the UEFI Boot Loader grub.cfg Permissions</td>
  <td xml:lang="en-US">
File permissions for <tt>/boot/efi/EFI/redhat/grub.cfg</tt> should be set to 700.

To properly set the permissions of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:
<pre>$ sudo chmod 700 /boot/efi/EFI/redhat/grub.cfg</pre>
  </td>
  <td xml:lang="en-US">
Proper permissions ensure that only the root user can modify important boot
parameters.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify the UEFI Boot Loader grub.cfg Group Ownership</td>
  <td xml:lang="en-US">
The file <tt>/boot/efi/EFI/redhat/grub.cfg</tt> should
be group-owned by the <tt>root</tt> group to prevent
destruction or modification of the file.

To properly set the group owner of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:
<pre>$ sudo chgrp root /boot/efi/EFI/redhat/grub.cfg</pre>
  </td>
  <td xml:lang="en-US">
The <tt>root</tt> group is a highly-privileged group. Furthermore, the group-owner of this
file should not have any access privileges anyway.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify /boot/grub2/grub.cfg User Ownership</td>
  <td xml:lang="en-US">
The file <tt>/boot/grub2/grub.cfg</tt> should
be owned by the <tt>root</tt> user to prevent destruction
or modification of the file.

To properly set the owner of <code>/boot/grub2/grub.cfg</code>, run the command:
<pre>$ sudo chown root /boot/grub2/grub.cfg </pre>
  </td>
  <td xml:lang="en-US">
Only root should be able to modify important boot parameters.
  </td>
</tr>
<tr>
  <td>1.5.1</td>
  <td>Verify the UEFI Boot Loader grub.cfg User Ownership</td>
  <td xml:lang="en-US">
The file <tt>/boot/efi/EFI/redhat/grub.cfg</tt> should
be owned by the <tt>root</tt> user to prevent destruction
or modification of the file.

To properly set the owner of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:
<pre>$ sudo chown root /boot/efi/EFI/redhat/grub.cfg </pre>
  </td>
  <td xml:lang="en-US">
Only root should be able to modify important boot parameters.
  </td>
</tr>
<tr>
  <td>1.5.2</td>
  <td>Set the UEFI Boot Loader Password</td>
  <td xml:lang="en-US">
The grub2 boot loader should have a superuser account and password
protection enabled to protect boot-time settings.
<br /><br />
Since plaintext passwords are a security risk, generate a hash for the password
by running the following command:

<pre># grub2-setpassword</pre>

When prompted, enter the password that was selected.
<br /><br />
  </td>
  <td xml:lang="en-US">
Password protection on the boot loader configuration ensures
users with physical access cannot trivially alter
important bootloader settings. These include which kernel to use,
and whether to enter single-user mode.
  </td>
</tr>
<tr>
  <td>1.5.2</td>
  <td>Set Boot Loader Password in grub2</td>
  <td xml:lang="en-US">
The grub2 boot loader should have a superuser account and password
protection enabled to protect boot-time settings.
<br /><br />
Since plaintext passwords are a security risk, generate a hash for the password
by running the following command:

<pre># grub2-setpassword</pre>

When prompted, enter the password that was selected.
<br /><br />
  </td>
  <td xml:lang="en-US">
Password protection on the boot loader configuration ensures
users with physical access cannot trivially alter
important bootloader settings. These include which kernel to use,
and whether to enter single-user mode.
  </td>
</tr>
<tr>
  <td>1.5.3</td>
  <td>Require Authentication for Emergency Systemd Target</td>
  <td xml:lang="en-US">
Emergency mode is intended as a system recovery
method, providing a single user root access to the system
during a failed boot sequence.
<br /><br />
By default, Emergency mode is protected by requiring a password and is set
in <tt>/usr/lib/systemd/system/emergency.service</tt>.
  </td>
  <td xml:lang="en-US">
This prevents attackers with physical access from trivially bypassing security
on the machine and gaining root access. Such accesses are further prevented
by configuring the bootloader password.
  </td>
</tr>
<tr>
  <td>1.5.3</td>
  <td>Require Authentication for Single User Mode</td>
  <td xml:lang="en-US">
Single-user mode is intended as a system recovery
method, providing a single user root access to the system by
providing a boot option at startup. By default, no authentication
is performed if single-user mode is selected.
<br /><br />
By default, single-user mode is protected by requiring a password and is set
in <tt>/usr/lib/systemd/system/rescue.service</tt>.
  </td>
  <td xml:lang="en-US">
This prevents attackers with physical access from trivially bypassing security
on the machine and gaining root access. Such accesses are further prevented
by configuring the bootloader password.
  </td>
</tr>
<tr>
  <td>1.6.1</td>
  <td>Disable Core Dumps for SUID programs</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>fs.suid_dumpable</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.suid_dumpable=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.suid_dumpable = 0</pre>
  </td>
  <td xml:lang="en-US">
The core dump of a setuid program is more likely to contain
sensitive data, as the program itself runs with greater privileges than the
user who initiated execution of the program.  Disabling the ability for any
setuid program to write a core file decreases the risk of unauthorized access
of such data.
  </td>
</tr>
<tr>
  <td>1.6.1</td>
  <td>Disable Core Dumps for All Users</td>
  <td xml:lang="en-US">
To disable core dumps for all users, add the following line to
<tt>/etc/security/limits.conf</tt>, or to a file within the
<tt>/etc/security/limits.d/</tt> directory:
<pre>*     hard   core    0</pre>
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.
  </td>
</tr>
<tr>
  <td>1.6.1</td>
  <td>Disable core dump backtraces</td>
  <td xml:lang="en-US">
The <tt>ProcessSizeMax</tt> option in <tt>[Coredump]</tt> section
of <tt>/etc/systemd/coredump.conf</tt>
specifies the maximum size in bytes of a core which will be processed.
Core dumps exceeding this size may be stored, but the backtrace will not
be generated.
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data
and is generally useful only for developers or system operators trying to
debug problems.

Enabling core dumps on production systems is not recommended,
however there may be overriding operational requirements to enable advanced
debuging. Permitting temporary enablement of core dumps during such situations
should be reviewed through local needs and policy.
  </td>
</tr>
<tr>
  <td>1.6.1</td>
  <td>Disable storing core dump</td>
  <td xml:lang="en-US">
The <tt>Storage</tt> option in <tt>[Coredump]</tt> section
of <tt>/etc/systemd/coredump.conf</tt>
can be set to <tt>none</tt> to disable storing core dumps permanently.
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data
and is generally useful only for developers or system operators trying to
debug problems. Enabling core dumps on production systems is not recommended,
however there may be overriding operational requirements to enable advanced
debuging. Permitting temporary enablement of core dumps during such situations
should be reviewed through local needs and policy.
  </td>
</tr>
<tr>
  <td>1.6.2</td>
  <td>Enable Randomized Layout of Virtual Address Space</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.randomize_va_space</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.randomize_va_space=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.randomize_va_space = 2</pre>
  </td>
  <td xml:lang="en-US">
Address space layout randomization (ASLR) makes it more difficult for an
attacker to predict the location of attack code they have introduced into a
process's address space during an attempt at exploitation.  Additionally,
ASLR makes it more difficult for an attacker to know the location of
existing code in order to re-purpose it using return oriented programming
(ROP) techniques.
  </td>
</tr>
<tr>
  <td>1.7.1.1</td>
  <td>Install libselinux Package</td>
  <td xml:lang="en-US">
The <code>libselinux</code> package can be installed with the following command:
<pre>
$ sudo yum install libselinux</pre>
  </td>
  <td xml:lang="en-US">
Security-enhanced Linux is a feature of the Linux kernel and a number of utilities
with enhanced security functionality designed to add mandatory access controls to Linux.

The <tt>libselinux</tt> package contains the core library of the Security-enhanced Linux system.
  </td>
</tr>
<tr>
  <td>1.7.1.2</td>
  <td>Ensure SELinux Not Disabled in /etc/default/grub</td>
  <td xml:lang="en-US">
SELinux can be disabled at boot time by an argument in
<tt>/etc/default/grub</tt>.
Remove any instances of <tt>selinux=0</tt> from the kernel arguments in that
file to prevent SELinux from being disabled at boot.
  </td>
  <td xml:lang="en-US">
Disabling a major host protection feature, such as SELinux, at boot time prevents
it from confining system services at boot time.  Further, it increases
the chances that it will remain off during system operation.
  </td>
</tr>
<tr>
  <td>1.7.1.3</td>
  <td>Configure SELinux Policy</td>
  <td xml:lang="en-US">
The SELinux <tt>targeted</tt> policy is appropriate for
general-purpose desktops and servers, as well as systems in many other roles.
To configure the system to use this policy, add or correct the following line
in <tt>/etc/selinux/config</tt>:
<pre>SELINUXTYPE=<abbr title="$var_selinux_policy_name"><tt>targeted</tt></abbr></pre>
Other policies, such as <tt>mls</tt>, provide additional security labeling
and greater confinement but are not compatible with many general-purpose
use cases.
  </td>
  <td xml:lang="en-US">
Setting the SELinux policy to <tt>targeted</tt> or a more specialized policy
ensures the system will confine processes that are likely to be
targeted for exploitation, such as network or system services.
<br /><br />
Note: During the development or debugging of SELinux modules, it is common to
temporarily place non-production systems in <tt>permissive</tt> mode. In such
temporary cases, SELinux policies should be developed, and once work
is completed, the system should be reconfigured to
<tt><sub idref="var_selinux_policy_name" /></tt>.
  </td>
</tr>
<tr>
  <td>1.7.1.4</td>
  <td>Ensure SELinux State is Enforcing</td>
  <td xml:lang="en-US">
The SELinux state should be set to <tt><abbr title="$var_selinux_state"><tt>enforcing</tt></abbr></tt> at
system boot time.  In the file <tt>/etc/selinux/config</tt>, add or correct the
following line to configure the system to boot into enforcing mode:
<pre>SELINUX=<abbr title="$var_selinux_state"><tt>enforcing</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
Setting the SELinux state to enforcing ensures SELinux is able to confine
potentially compromised processes to the security policy, which is designed to
prevent them from causing damage to the system or further elevating their
privileges.
  </td>
</tr>
<tr>
  <td>1.7.1.5</td>
  <td>Ensure No Daemons are Unconfined by SELinux</td>
  <td xml:lang="en-US">
Daemons for which the SELinux policy does not contain rules will inherit the
context of the parent process. Because daemons are launched during
startup and descend from the <tt>init</tt> process, they inherit the <tt>unconfined_service_t</tt> context.
<br />
<br />
To check for unconfined daemons, run the following command:
<pre>$ sudo ps -eZ | grep "unconfined_service_t"</pre>
It should produce no output in a well-configured system.
  </td>
  <td xml:lang="en-US">
Daemons which run with the <tt>unconfined_service_t</tt> context may cause AVC denials,
or allow privileges that the daemon does not require.
  </td>
</tr>
<tr>
  <td>1.7.1.6</td>
  <td>Uninstall setroubleshoot Package</td>
  <td xml:lang="en-US">
The SETroubleshoot service notifies desktop users of SELinux
denials. The service provides information around configuration errors,
unauthorized intrusions, and other potential errors.
The <code>setroubleshoot</code> package can be removed with the following command:
<pre>
$ sudo yum erase setroubleshoot</pre>
  </td>
  <td xml:lang="en-US">
The SETroubleshoot service is an unnecessary daemon to
have running on a server, especially if
X Windows is removed or disabled.
  </td>
</tr>
<tr>
  <td>1.7.1.7</td>
  <td>Uninstall mcstrans Package</td>
  <td xml:lang="en-US">
The <tt>mcstransd</tt> daemon provides category label information
to client processes requesting information. The label translations are defined
in <tt>/etc/selinux/targeted/setrans.conf</tt>.
The <code>mcstrans</code> package can be removed with the following command:
<pre>
$ sudo yum erase mcstrans</pre>
  </td>
  <td xml:lang="en-US">
Since this service is not used very often, disable it to reduce the
amount of potentially vulnerable code running on the system.
  </td>
</tr>
<tr>
  <td>1.8.1.1</td>
  <td>Modify the System Message of the Day Banner</td>
  <td xml:lang="en-US">
To configure the system message banner edit <tt>/etc/motd</tt>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.

The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.
  </td>
</tr>
<tr>
  <td>1.8.1.2</td>
  <td>Modify the System Login Banner</td>
  <td xml:lang="en-US">

To configure the system login banner edit <tt>/etc/issue</tt>. Replace the
default text with a message compliant with the local site policy or a legal
disclaimer.


The DoD required text is either:
<br /><br />
<tt>You are accessing a U.S. Government (USG) Information System (IS) that
is provided for USG-authorized use only. By using this IS (which includes
any device attached to this IS), you consent to the following conditions:
<br />-The USG routinely intercepts and monitors communications on this IS
for purposes including, but not limited to, penetration testing, COMSEC
monitoring, network operations and defense, personnel misconduct (PM), law
enforcement (LE), and counterintelligence (CI) investigations.
<br />-At any time, the USG may inspect and seize data stored on this IS.
<br />-Communications using, or data stored on, this IS are not private,
are subject to routine monitoring, interception, and search, and may be
disclosed or used for any USG-authorized purpose.
<br />-This IS includes security measures (e.g., authentication and access
controls) to protect USG interests -- not for your personal benefit or
privacy.
<br />-Notwithstanding the above, using this IS does not constitute consent
to PM, LE or CI investigative searching or monitoring of the content of
privileged communications, or work product, related to personal
representation or services by attorneys, psychotherapists, or clergy, and
their assistants. Such communications and work product are private and
confidential. See User Agreement for details.</tt>
<br /><br />
OR:
<br /><br />
<tt>I've read &amp; consent to terms in IS user agreem't.</tt>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.
<br /><br />
System use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not
exist.
  </td>
</tr>
<tr>
  <td>1.8.1.4</td>
  <td>Verify Group Ownership of Message of the Day Banner</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/motd</code>, run the command:
<pre>$ sudo chgrp root /etc/motd</pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper group ownership will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.1.4<br/>1.8.1.5<br/>1.8.1.6<br/>6.1.1<br/>6.1.2<br/>6.1.3<br/>6.1.4<br/>6.1.5<br/>6.1.6<br/>6.1.7<br/>6.1.8<br/>6.1.9</td>
  <td>Verify and Correct File Permissions with RPM</td>
  <td xml:lang="en-US">
The RPM package management system can check file access permissions
of installed software packages, including many that are important
to system security.
Verify that the file permissions of system files
and commands match vendor values. Check the file permissions
with the following command:
<pre>$ sudo rpm -Va | awk '{ if (substr($0,2,1)=="M") print $NF }'</pre>
Output indicates files that do not match vendor defaults.
After locating a file with incorrect permissions,
run the following command to determine which package owns it:
<pre>$ rpm -qf <i>FILENAME</i></pre>
<br />
Next, run the following command to reset its permissions to
the correct values:
<pre>$ sudo rpm --setperms <i>PACKAGENAME</i></pre>
  </td>
  <td xml:lang="en-US">
Permissions on system binaries and configuration files that are too generous
could allow an unauthorized user to gain privileges that they should not have.
The permissions set by the vendor should be maintained. Any deviations from
this baseline should be investigated.
  </td>
</tr>
<tr>
  <td>1.8.1.4</td>
  <td>Verify ownership of Message of the Day Banner</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/motd</code>, run the command:
<pre>$ sudo chown root /etc/motd </pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper ownership will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.1.4</td>
  <td>Verify permissions on Message of the Day Banner</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/motd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/motd</pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper permissions will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.1.4<br/>1.8.1.5<br/>1.8.1.6<br/>6.1.1<br/>6.1.2<br/>6.1.3<br/>6.1.4<br/>6.1.5<br/>6.1.6<br/>6.1.7<br/>6.1.8<br/>6.1.9</td>
  <td>Verify and Correct Ownership with RPM</td>
  <td xml:lang="en-US">
The RPM package management system can check file ownership
permissions of installed software packages, including many that are
important to system security. After locating a file with incorrect
permissions, which can be found with
<pre>rpm -Va | awk '{ if (substr($0,6,1)=="U" || substr($0,7,1)=="G") print $NF }'</pre>
run the following command to determine which package owns it:
<pre>$ rpm -qf <i>FILENAME</i></pre>
Next, run the following command to reset its permissions to
the correct values:
<pre>$ sudo rpm --setugids <i>PACKAGENAME</i></pre>
  </td>
  <td xml:lang="en-US">
Ownership of binaries and configuration files that is incorrect
could allow an unauthorized user to gain privileges that they should
not have. The ownership set by the vendor should be maintained. Any
deviations from this baseline should be investigated.
  </td>
</tr>
<tr>
  <td>1.8.1.5</td>
  <td>Verify Group Ownership of System Login Banner</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/issue</code>, run the command:
<pre>$ sudo chgrp root /etc/issue</pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper group ownership will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.1.5</td>
  <td>Verify ownership of System Login Banner</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/issue</code>, run the command:
<pre>$ sudo chown root /etc/issue </pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper ownership will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.1.5</td>
  <td>Verify permissions on System Login Banner</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/issue</code>, run the command:
<pre>$ sudo chmod 0644 /etc/issue</pre>
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting
access to the operating system ensures privacy and security notification
verbiage used is consistent with applicable federal laws, Executive Orders,
directives, policies, regulations, standards, and guidance.<br />
Proper permissions will ensure that only root user can modify the banner.
  </td>
</tr>
<tr>
  <td>1.8.2</td>
  <td>Set the GNOME3 Login Warning Banner Text</td>
  <td xml:lang="en-US">
In the default graphical environment, configuring the login warning banner text
in the GNOME Display Manager's login screen can be configured on the login
screen by setting <tt>banner-message-text</tt> to <tt>'<i>APPROVED_BANNER</i>'</tt>
where <i>APPROVED_BANNER</i> is the approved banner for your environment.
<br /><br />
To enable, add or edit <tt>banner-message-text</tt> to

<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
banner-message-text='<i>APPROVED_BANNER</i>'</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/banner-message-text</pre>

After the settings have been set, run <tt>dconf update</tt>.
When entering a warning banner that spans several lines, remember
to begin and end the string with <tt>'</tt> and use <tt>\n</tt> for new lines.
  </td>
  <td xml:lang="en-US">
An appropriate warning message reinforces policy awareness during the logon
process and facilitates possible legal action against attackers.
  </td>
</tr>
<tr>
  <td>1.8.2</td>
  <td>Enable GNOME3 Login Warning Banner</td>
  <td xml:lang="en-US">
In the default graphical environment, displaying a login warning banner
in the GNOME Display Manager's login screen can be enabled on the login
screen by setting <tt>banner-message-enable</tt> to <tt>true</tt>.
<br /><br />
To enable, add or edit <tt>banner-message-enable</tt> to
<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
banner-message-enable=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/banner-message-enable</pre>
After the settings have been set, run <tt>dconf update</tt>.
The banner text must also be set.
  </td>
  <td xml:lang="en-US">
Display of a standardized and approved use notification before granting access to the operating system
ensures privacy and security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.
<br /><br />
For U.S. Government systems, system use notifications are required only for access via login interfaces
with human users and are not required when such human interfaces do not exist.
  </td>
</tr>
<tr>
  <td>1.8.2</td>
  <td>Make sure that the dconf databases are up-to-date with regards to respective keyfiles</td>
  <td xml:lang="en-US">
By default, DConf uses a binary database as a data backend.
The system-level database is compiled from keyfiles in the /etc/dconf/db/
directory by the <pre>dconf update</pre> command. More specifically, content present
in the following directories:
<pre>/etc/dconf/db/gdm.d</pre>
<pre>/etc/dconf/db/local.d</pre>
  </td>
  <td xml:lang="en-US">
Unlike text-based keyfiles, the binary database is impossible to check by OVAL.
Therefore, in order to evaluate dconf configuration, both have to be true at the same time -
configuration files have to be compliant, and the database needs to be more recent than those keyfiles,
which gives confidence that it reflects them.
  </td>
</tr>
<tr>
  <td>1.9</td>
  <td>Ensure Software Patches Installed</td>
  <td xml:lang="en-US">

If the system is joined to the Red Hat Network, a Red Hat Satellite Server,
or a yum server, run the following command to install updates:
<pre>$ sudo yum update</pre>
If the system is not configured to use one of these sources, updates (in the form of RPM packages)
can be manually downloaded from the Red Hat Network and installed using <tt>rpm</tt>.

<br /><br />
NOTE: U.S. Defense systems are required to be patched within 30 days or sooner as local policy
dictates.
  </td>
  <td xml:lang="en-US">
Installing software updates is a fundamental mitigation against
the exploitation of publicly-known vulnerabilities. If the most
recent security patches and updates are not installed, unauthorized
users may take advantage of weaknesses in the unpatched software. The
lack of prompt attention to patching could result in a system compromise.
  </td>
</tr>
<tr>
  <td>1.10<br/>1.11</td>
  <td>Configure System Cryptography Policy</td>
  <td xml:lang="en-US">
To configure the system cryptography policy to use ciphers only from the <tt><abbr title="$var_system_crypto_policy"><tt>DEFAULT</tt></abbr></tt>
policy, run the following command:
<pre>$ sudo update-crypto-policies --set <abbr title="$var_system_crypto_policy"><tt>DEFAULT</tt></abbr></pre>
The rule checks if settings for selected crypto policy are configured as expected. Configuration files in the <tt>/etc/crypto-policies/back-ends</tt> are either symlinks to correct files provided by Crypto-policies package or they are regular files in case crypto policy customizations are applied.
Crypto policies may be customized by crypto policy modules, in which case it is delimited from the base policy using a colon.
  </td>
  <td xml:lang="en-US">
Centralized cryptographic policies simplify applying secure ciphers across an operating system and
the applications that run on that operating system. Use of weak or untested encryption algorithms
undermines the purposes of utilizing encryption to protect data.
  </td>
</tr>
<tr>
  <td>2.1.1</td>
  <td>Uninstall xinetd Package</td>
  <td xml:lang="en-US">
The <code>xinetd</code> package can be removed with the following command:
<pre>
$ sudo yum erase xinetd</pre>
  </td>
  <td xml:lang="en-US">
Removing the <tt>xinetd</tt> package decreases the risk of the
xinetd service's accidental (or intentional) activation.
  </td>
</tr>
<tr>
  <td>2.1.7</td>
  <td>Disable xinetd Service</td>
  <td xml:lang="en-US">

The <code>xinetd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now xinetd.service</pre>
  </td>
  <td xml:lang="en-US">
The xinetd service provides a dedicated listener service for some programs,
which is no longer necessary for commonly-used network services. Disabling
it ensures that these uncommon services are not running, and also prevents
attacks against xinetd itself.
  </td>
</tr>
<tr>
  <td>2.2.1.1</td>
  <td>Enable the NTP Daemon</td>
  <td xml:lang="en-US">


Run the following command to determine the current status of the
<code>chronyd</code> service:
<pre>$ systemctl is-active chronyd</pre>
If the service is running, it should return the following: <pre>active</pre>
Note: The <tt>chronyd</tt> daemon is enabled by default.
<br /><br />


Run the following command to determine the current status of the
<code>ntpd</code> service:
<pre>$ systemctl is-active ntpd</pre>
If the service is running, it should return the following: <pre>active</pre>
Note: The <tt>ntpd</tt> daemon is not enabled by default. Though as mentioned
in the previous sections in certain environments the <tt>ntpd</tt> daemon might
be preferred to be used rather than the <tt>chronyd</tt> one. Refer to:

    
    <a xmlns='http://www.w3.org/1999/xhtml' href='https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite'>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite</a>

for guidance which NTP daemon to choose depending on the environment used.
  </td>
  <td xml:lang="en-US">
Enabling some of <tt>chronyd</tt> or <tt>ntpd</tt> services ensures
that the NTP daemon will be running and that the system will synchronize its
time to any servers specified. This is important whether the system is
configured to be a client (and synchronize only its own clock) or it is also
acting as an NTP server to other systems.  Synchronizing time is essential for
authentication services such as Kerberos, but it is also important for
maintaining accurate logs and auditing possible security breaches.
<br /><br />
The <tt>chronyd</tt> and <tt>ntpd</tt> NTP daemons offer all of the
functionality of <tt>ntpdate</tt>, which is now deprecated.
  </td>
</tr>
<tr>
  <td>2.2.1.1</td>
  <td>The Chrony package is installed</td>
  <td xml:lang="en-US">
System time should be synchronized between all systems in an environment. This is
typically done by establishing an authoritative time server or set of servers and having all
systems synchronize their clocks to them.
The <code>chrony</code> package can be installed with the following command:
<pre>
$ sudo yum install chrony</pre>
  </td>
  <td xml:lang="en-US">
Time synchronization is important to support time sensitive security mechanisms like
Kerberos and also ensures log files have consistent time records across the enterprise,
which aids in forensic investigations.
  </td>
</tr>
<tr>
  <td>2.2.1.2</td>
  <td>Ensure that chronyd is running under chrony user account</td>
  <td xml:lang="en-US">
chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to
synchronize system clocks across a variety of systems and use a source that is highly
accurate. More information on chrony can be found at

    <a xmlns='http://www.w3.org/1999/xhtml' href='http://chrony.tuxfamily.org/'>http://chrony.tuxfamily.org/</a>.
Chrony can be configured to be a client and/or a server.
To ensure that chronyd is running under chrony user account, Add or edit the
<tt>OPTIONS</tt> variable in <tt>/etc/sysconfig/chronyd</tt> to include <tt>-u chrony</tt>:
<pre>OPTIONS="-u chrony"</pre>
This recommendation only applies if chrony is in use on the system.
  </td>
  <td xml:lang="en-US">
If chrony is in use on the system proper configuration is vital to ensuring time synchronization
is working properly.
  </td>
</tr>
<tr>
  <td>2.2.1.2</td>
  <td>A remote time server for Chrony is configured</td>
  <td xml:lang="en-US">
<tt>Chrony</tt> is a daemon which implements the Network Time Protocol (NTP). It is designed to
synchronize system clocks across a variety of systems and use a source that is highly
accurate. More information on <tt>chrony</tt> can be found at

    <a xmlns='http://www.w3.org/1999/xhtml' href='http://chrony.tuxfamily.org/'>http://chrony.tuxfamily.org/</a>.
<tt>Chrony</tt> can be configured to be a client and/or a server.
Add or edit server or pool lines to <tt>/etc/chrony.conf</tt> as appropriate:
<pre>server &lt;remote-server&gt;</pre>
Multiple servers may be configured.
  </td>
  <td xml:lang="en-US">
If <tt>chrony</tt> is in use on the system proper configuration is vital to ensuring time
synchronization is working properly.
  </td>
</tr>
<tr>
  <td>2.2.1.2</td>
  <td>Specify a Remote NTP Server</td>
  <td xml:lang="en-US">
Depending on specific functional requirements of a concrete
production environment, the Red Hat Enterprise Linux 8 system can be
configured to utilize the services of the <tt>chronyd</tt> NTP daemon (the
default), or services of the <tt>ntpd</tt> NTP daemon. Refer to

    
    <a xmlns='http://www.w3.org/1999/xhtml' href='https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite'>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite</a>

for more detailed comparison of the features of both of the choices, and for
further guidance how to choose between the two NTP daemons.
<br />
To specify a remote NTP server for time synchronization, perform the following:
<ul>
<li> if the system is configured to use the <tt>chronyd</tt> as the NTP daemon (the
default), edit the file <tt>/etc/chrony.conf</tt> as follows,</li>
<li> if the system is configured to use the <tt>ntpd</tt> as the NTP daemon,
edit the file <tt>/etc/ntp.conf</tt> as documented below.</li>
</ul>
Add or correct the following lines, substituting the IP or hostname of a remote
NTP server for <em>ntpserver</em>:
<pre>server <i>ntpserver</i></pre>
This instructs the NTP software to contact that remote server to obtain time
data.
  </td>
  <td xml:lang="en-US">
Synchronizing with an NTP server makes it possible to collate system
logs from multiple sources or correlate computer events with real time events.
  </td>
</tr>
<tr>
  <td>2.2.1.2</td>
  <td>The Chronyd service is enabled</td>
  <td xml:lang="en-US">
chrony is a daemon which implements the Network Time Protocol (NTP) is designed to
synchronize system clocks across a variety of systems and use a source that is highly
accurate. More information on chrony can be found at

    <a xmlns='http://www.w3.org/1999/xhtml' href='http://chrony.tuxfamily.org/'>http://chrony.tuxfamily.org/</a>.
Chrony can be configured to be a client and/or a server.
To enable Chronyd service, you can run:
<tt># systemctl enable chronyd.service</tt>
This recommendation only applies if chrony is in use on the system.
  </td>
  <td xml:lang="en-US">
If chrony is in use on the system proper configuration is vital to ensuring time
synchronization is working properly.
  </td>
</tr>
<tr>
  <td>2.2.2</td>
  <td>Disable graphical user interface</td>
  <td xml:lang="en-US">
By removing the following packages,  the system no longer has X Windows installed.

<tt>xorg-x11-server-Xorg xorg-x11-server-common xorg-x11-server-utils xorg-x11-server-Xwayland</tt>

If X Windows is not installed then the system cannot boot into graphical user mode.
This prevents the system from being accidentally or maliciously booted into a <tt>graphical.target</tt>
mode. To do so, run the following command:

<pre>sudo yum remove xorg-x11-server-Xorg xorg-x11-server-common xorg-x11-server-utils xorg-x11-server-Xwayland</pre>
  </td>
  <td xml:lang="en-US">
Unnecessary service packages must not be installed to decrease the attack surface of the system. X windows has a long history of security
vulnerabilities and should not be installed unless approved and documented.
  </td>
</tr>
<tr>
  <td>2.2.2</td>
  <td>Remove the X Windows Package Group</td>
  <td xml:lang="en-US">
By removing the xorg-x11-server-common package, the system no longer has X Windows
installed. If X Windows is not installed then the system cannot boot into graphical user mode.
This prevents the system from being accidentally or maliciously booted into a <tt>graphical.target</tt>
mode. To do so, run the following command:<pre>$ sudo yum groupremove base-x</pre>
<pre>$ sudo yum remove xorg-x11-server-common</pre>
  </td>
  <td xml:lang="en-US">
Unnecessary service packages must not be installed to decrease the attack surface of the system. X windows has a long history of security
vulnerabilities and should not be installed unless approved and documented.
  </td>
</tr>
<tr>
  <td>2.2.2</td>
  <td>Disable X Windows Startup By Setting Default Target</td>
  <td xml:lang="en-US">
Systems that do not require a graphical user interface should only boot by
default into <tt>multi-user.target</tt> mode. This prevents accidental booting of the system
into a <tt>graphical.target</tt> mode. Setting the system's default target to
<tt>multi-user.target</tt> will prevent automatic startup of the X server. To do so, run:
<pre>$ systemctl set-default multi-user.target</pre>
You should see the following output:
<pre>Removed symlink /etc/systemd/system/default.target.
Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/multi-user.target.</pre>
  </td>
  <td xml:lang="en-US">
Services that are not required for system and application processes
must not be active to decrease the attack surface of the system. X windows has a
long history of security vulnerabilities and should not be used unless approved
and documented.
  </td>
</tr>
<tr>
  <td>2.2.3</td>
  <td>Ensure rsyncd service is diabled</td>
  <td xml:lang="en-US">

The <code>rsyncd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now rsyncd.service</pre>
  </td>
  <td xml:lang="en-US">
The rsyncd service presents a security risk as it uses unencrypted protocols for
communication.
  </td>
</tr>
<tr>
  <td>2.2.4</td>
  <td>Disable Avahi Server Software</td>
  <td xml:lang="en-US">

The <code>avahi-daemon</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now avahi-daemon.service</pre>
  </td>
  <td xml:lang="en-US">
Because the Avahi daemon service keeps an open network
port, it is subject to network attacks. Its functionality
is convenient but is only appropriate if the local network
can be trusted.
  </td>
</tr>
<tr>
  <td>2.2.5</td>
  <td>Disable snmpd Service</td>
  <td xml:lang="en-US">

The <code>snmpd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now snmpd.service</pre>
  </td>
  <td xml:lang="en-US">
Running SNMP software provides a network-based avenue of attack, and
should be disabled if not needed.
  </td>
</tr>
<tr>
  <td>2.2.6</td>
  <td>Disable Squid</td>
  <td xml:lang="en-US">

The <code>squid</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now squid.service</pre>
  </td>
  <td xml:lang="en-US">
Running proxy server software provides a network-based avenue
of attack, and should be removed if not needed.
  </td>
</tr>
<tr>
  <td>2.2.6</td>
  <td>Uninstall squid Package</td>
  <td xml:lang="en-US">
The <code>squid</code> package can be removed with the following command: <pre> $ sudo yum erase squid</pre>
  </td>
  <td xml:lang="en-US">
If there is no need to make the proxy server software available,
removing it provides a safeguard against its activation.
  </td>
</tr>
<tr>
  <td>2.2.7</td>
  <td>Disable Samba</td>
  <td xml:lang="en-US">

The <code>smb</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now smb.service</pre>
  </td>
  <td xml:lang="en-US">
Running a Samba server provides a network-based avenue of attack, and
should be disabled if not needed.
  </td>
</tr>
<tr>
  <td>2.2.8</td>
  <td>Disable Dovecot Service</td>
  <td xml:lang="en-US">

The <code>dovecot</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now dovecot.service</pre>
  </td>
  <td xml:lang="en-US">
Running an IMAP or POP3 server provides a network-based
avenue of attack, and should be disabled if not needed.
  </td>
</tr>
<tr>
  <td>2.2.9</td>
  <td>Disable httpd Service</td>
  <td xml:lang="en-US">

The <code>httpd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now httpd.service</pre>
  </td>
  <td xml:lang="en-US">
Running web server software provides a network-based avenue
of attack, and should be disabled if not needed.
  </td>
</tr>
<tr>
  <td>2.2.10</td>
  <td>Disable vsftpd Service</td>
  <td xml:lang="en-US">

The <code>vsftpd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now vsftpd.service</pre>
  </td>
  <td xml:lang="en-US">
Running FTP server software provides a network-based avenue
of attack, and should be disabled if not needed.
Furthermore, the FTP protocol is unencrypted and creates
a risk of compromising sensitive information.
  </td>
</tr>
<tr>
  <td>2.2.11</td>
  <td>Disable named Service</td>
  <td xml:lang="en-US">

The <code>named</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now named.service</pre>
  </td>
  <td xml:lang="en-US">
All network services involve some risk of compromise due to
implementation flaws and should be disabled if possible.
  </td>
</tr>
<tr>
  <td>2.2.12</td>
  <td>Disable Network File System (nfs)</td>
  <td xml:lang="en-US">
The Network File System (NFS) service allows remote hosts to mount
and interact with shared filesystems on the local system. If the local system
is not designated as a NFS server then this service should be disabled.

The <code>nfs-server</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now nfs-server.service</pre>
  </td>
  <td xml:lang="en-US">
Unnecessary services should be disabled to decrease the attack surface of the system.
  </td>
</tr>
<tr>
  <td>2.2.13</td>
  <td>Disable rpcbind Service</td>
  <td xml:lang="en-US">
The rpcbind utility maps RPC services to the ports on which they listen.
RPC processes notify rpcbind when they start, registering the ports they
are listening on and the RPC program numbers they expect to serve. The
rpcbind service redirects the client to the proper port number so it can
communicate with the requested service. If the system does not require RPC
(such as for NFS servers) then this service should be disabled.

The <code>rpcbind</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now rpcbind.service</pre>
  </td>
  <td xml:lang="en-US">
If the system does not require rpc based services, it is recommended that
rpcbind be disabled to reduce the attack surface.
  </td>
</tr>
<tr>
  <td>2.2.14</td>
  <td>Disable LDAP Server (slapd)</td>
  <td xml:lang="en-US">
The Lightweight Directory Access Protocol (LDAP) is a service that provides a method for looking up information from a central database.
  </td>
  <td xml:lang="en-US">
If the system will not need to act as an LDAP server, it is recommended that the software be
disabled to reduce the potential attack surface.
  </td>
</tr>
<tr>
  <td>2.2.15</td>
  <td>Disable DHCP Service</td>
  <td xml:lang="en-US">
The <tt>dhcpd</tt> service should be disabled on
any system that does not need to act as a DHCP server.

The <code>dhcpd</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now dhcpd.service</pre>
  </td>
  <td xml:lang="en-US">
Unmanaged or unintentionally activated DHCP servers may provide faulty information
to clients, interfering with the operation of a legitimate site
DHCP server if there is one.
  </td>
</tr>
<tr>
  <td>2.2.16</td>
  <td>Disable the CUPS Service</td>
  <td xml:lang="en-US">

The <code>cups</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now cups.service</pre>
  </td>
  <td xml:lang="en-US">
Turn off unneeded services to reduce attack surface.
  </td>
</tr>
<tr>
  <td>2.2.17</td>
  <td>Disable ypserv Service</td>
  <td xml:lang="en-US">
The <tt>ypserv</tt> service, which allows the system to act as a client in
a NIS or NIS+ domain, should be disabled.

The <code>ypserv</code> service can be disabled with the following command:
<pre>$ sudo systemctl mask --now ypserv.service</pre>
  </td>
  <td xml:lang="en-US">
Disabling the <tt>ypserv</tt> service ensures the system is not acting
as a client in a NIS or NIS+ domain. This service should be disabled
unless in use.
  </td>
</tr>
<tr>
  <td>2.2.17</td>
  <td>Uninstall ypserv Package</td>
  <td xml:lang="en-US">
The <code>ypserv</code> package can be removed with the following command:
<pre>
$ sudo yum erase ypserv</pre>
  </td>
  <td xml:lang="en-US">
The NIS service provides an unencrypted authentication service which does
not provide for the confidentiality and integrity of user passwords or the
remote session.

Removing the <tt>ypserv</tt> package decreases the risk of the accidental
(or intentional) activation of NIS or NIS+ services.
  </td>
</tr>
<tr>
  <td>2.2.18</td>
  <td>Disable Postfix Network Listening</td>
  <td xml:lang="en-US">
Edit the file <tt>/etc/postfix/main.cf</tt> to ensure that only the following
<tt>inet_interfaces</tt> line appears:
<pre>inet_interfaces = <abbr title="$var_postfix_inet_interfaces"><tt>loopback-only</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
This ensures <tt>postfix</tt> accepts mail messages
(such as cron job reports) from the local system only,
and not from the network, which protects it from network attack.
  </td>
</tr>
<tr>
  <td>2.3.1</td>
  <td>Remove NIS Client</td>
  <td xml:lang="en-US">
The Network Information Service (NIS), formerly known as Yellow Pages,
is a client-server directory service protocol used to distribute system configuration
files. The NIS client (<tt>ypbind</tt>) was used to bind a system to an NIS server
and receive the distributed configuration files.
  </td>
  <td xml:lang="en-US">
The NIS service is inherently an insecure system that has been vulnerable
to DOS attacks, buffer overflows and has poor authentication for querying
NIS maps. NIS generally has been replaced by such protocols as Lightweight
Directory Access Protocol (LDAP). It is recommended that the service be
removed.
  </td>
</tr>
<tr>
  <td>2.3.2</td>
  <td>Remove telnet Clients</td>
  <td xml:lang="en-US">
The telnet client allows users to start connections to other systems via
the telnet protocol.
  </td>
  <td xml:lang="en-US">
The <tt>telnet</tt> protocol is insecure and unencrypted. The use
of an unencrypted transmission medium could allow an unauthorized user
to steal credentials. The <tt>ssh</tt> package provides an
encrypted session and stronger security and is included in Red Hat Enterprise Linux 8.
  </td>
</tr>
<tr>
  <td>2.3.3</td>
  <td>Ensure LDAP client is not installed</td>
  <td xml:lang="en-US">
The Lightweight Directory Access Protocol (LDAP) is a service that provides
a method for looking up information from a central database.
The <code>openldap-clients</code> package can be removed with the following command:
<pre>
$ sudo yum erase openldap-clients</pre>
  </td>
  <td xml:lang="en-US">
If the system does not need to act as an LDAP client, it is recommended that the software is removed to reduce the potential attack surface.
  </td>
</tr>
<tr>
  <td>3.1.1</td>
  <td>Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.ip_forward</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.ip_forward=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.ip_forward = 0</pre>
  </td>
  <td xml:lang="en-US">
Routing protocol daemons are typically used on routers to exchange
network topology information with other routers. If this capability is used when
not required, system network information may be unnecessarily transmitted across
the network.
  </td>
</tr>
<tr>
  <td>3.1.1</td>
  <td>Disable Kernel Parameter for IPv6 Forwarding</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.forwarding=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.forwarding = 0</pre>
  </td>
  <td xml:lang="en-US">
IP forwarding permits the kernel to forward packets from one network
interface to another. The ability to forward packets between two networks is
only appropriate for systems acting as routers.
  </td>
</tr>
<tr>
  <td>3.1.2</td>
  <td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.send_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.
  </td>
</tr>
<tr>
  <td>3.1.2</td>
  <td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.send_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.
  </td>
</tr>
<tr>
  <td>3.2.1</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures.
<br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required, such as when
IPv4 forwarding is enabled and the system is legitimately functioning as a
router.
  </td>
</tr>
<tr>
  <td>3.2.1</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures. This requirement
applies only to the forwarding of source-routerd traffic, such as when IPv4
forwarding is enabled and the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.1</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.

Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.1</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.2</td>
  <td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />This feature of the IPv4 protocol has few legitimate uses. It should
be disabled unless absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.2</td>
  <td>Disable Accepting ICMP Redirects for All IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />
This feature of the IPv4 protocol has few legitimate uses. It should be
disabled unless absolutely required."
  </td>
</tr>
<tr>
  <td>3.2.2</td>
  <td>Disable Accepting ICMP Redirects for All IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit ICMP redirect message could result in a man-in-the-middle attack.
  </td>
</tr>
<tr>
  <td>3.2.2</td>
  <td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit ICMP redirect message could result in a man-in-the-middle attack.
  </td>
</tr>
<tr>
  <td>3.2.3</td>
  <td>Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.secure_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.3</td>
  <td>Configure Kernel Parameter for Accepting Secure Redirects By Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.secure_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.
  </td>
</tr>
<tr>
  <td>3.2.4</td>
  <td>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.log_martians = 1</pre>
  </td>
  <td xml:lang="en-US">
The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.
  </td>
</tr>
<tr>
  <td>3.2.4</td>
  <td>Enable Kernel Paremeter to Log Martian Packets on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.log_martians = 1</pre>
  </td>
  <td xml:lang="en-US">
The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.
  </td>
</tr>
<tr>
  <td>3.2.5</td>
  <td>Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.icmp_echo_ignore_broadcasts</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_echo_ignore_broadcasts = 1</pre>
  </td>
  <td xml:lang="en-US">
Responding to broadcast (ICMP) echoes facilitates network mapping
and provides a vector for amplification attacks.
<br />
Ignoring ICMP echo requests (pings) sent to broadcast or multicast
addresses makes the system slightly more difficult to enumerate on the network.
  </td>
</tr>
<tr>
  <td>3.2.6</td>
  <td>Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.icmp_ignore_bogus_error_responses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_ignore_bogus_error_responses = 1</pre>
  </td>
  <td xml:lang="en-US">
Ignoring bogus ICMP error responses reduces
log size, although some activity would not be logged.
  </td>
</tr>
<tr>
  <td>3.2.7</td>
  <td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.rp_filter = 1</pre>
  </td>
  <td xml:lang="en-US">
Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.
  </td>
</tr>
<tr>
  <td>3.2.7</td>
  <td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.rp_filter = 1</pre>
  </td>
  <td xml:lang="en-US">
Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.
  </td>
</tr>
<tr>
  <td>3.2.8</td>
  <td>Enable Kernel Parameter to Use TCP Syncookies on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.tcp_syncookies</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_syncookies=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.tcp_syncookies = 1</pre>
  </td>
  <td xml:lang="en-US">
A TCP SYN flood attack can cause a denial of service by filling a
system's TCP connection table with connections in the SYN_RCVD state.
Syncookies can be used to track a connection when a subsequent ACK is received,
verifying the initiator is attempting a valid connection and is not a flood
source. This feature is activated when a flood condition is detected, and
enables the system to continue servicing valid connection requests.
  </td>
</tr>
<tr>
  <td>3.2.9</td>
  <td>Configure Accepting Router Advertisements on All IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit router advertisement message could result in a man-in-the-middle attack.
  </td>
</tr>
<tr>
  <td>3.2.9</td>
  <td>Disable Accepting Router Advertisements on all IPv6 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit router advertisement message could result in a man-in-the-middle attack.
  </td>
</tr>
<tr>
  <td>3.3.1</td>
  <td>Disable DCCP Support</td>
  <td xml:lang="en-US">
The Datagram Congestion Control Protocol (DCCP) is a
relatively new transport layer protocol, designed to support
streaming media and telephony.

To configure the system to prevent the <code>dccp</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install dccp /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling DCCP protects
the system against exploitation of any flaws in its implementation.
  </td>
</tr>
<tr>
  <td>3.3.2</td>
  <td>Disable SCTP Support</td>
  <td xml:lang="en-US">
The Stream Control Transmission Protocol (SCTP) is a
transport layer protocol, designed to support the idea of
message-oriented communication, with several streams of messages
within one connection.

To configure the system to prevent the <code>sctp</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install sctp /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling SCTP protects
the system against exploitation of any flaws in its implementation.
  </td>
</tr>
<tr>
  <td>3.3.3</td>
  <td>Disable RDS Support</td>
  <td xml:lang="en-US">
The Reliable Datagram Sockets (RDS) protocol is a transport
layer protocol designed to provide reliable high-bandwidth,
low-latency communications between nodes in a cluster.

To configure the system to prevent the <code>rds</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install rds /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling RDS protects
the system against exploitation of any flaws in its implementation.
  </td>
</tr>
<tr>
  <td>3.3.4</td>
  <td>Disable TIPC Support</td>
  <td xml:lang="en-US">
The Transparent Inter-Process Communication (TIPC) protocol
is designed to provide communications between nodes in a
cluster.

To configure the system to prevent the <code>tipc</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install tipc /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling TIPC protects
the system against exploitation of any flaws in its implementation.
  </td>
</tr>
<tr>
  <td>3.4.1.1</td>
  <td>Install firewalld Package</td>
  <td xml:lang="en-US">
The <code>firewalld</code> package can be installed with the following command:
<pre>
$ sudo yum install firewalld</pre>
  </td>
  <td xml:lang="en-US">
The firewalld package should be installed to provide access control methods.
  </td>
</tr>
<tr>
  <td>3.4.1.1</td>
  <td>Install iptables Package</td>
  <td xml:lang="en-US">
The <code>iptables</code> package can be installed with the following command:
<pre>
$ sudo yum install iptables</pre>
  </td>
  <td xml:lang="en-US">
<tt>iptables</tt> controls the Linux kernel network packet filtering
code. <tt>iptables</tt> allows system operators to set up firewalls and IP
masquerading, etc.
  </td>
</tr>
<tr>
  <td>3.4.2.1</td>
  <td>Verify firewalld Enabled</td>
  <td xml:lang="en-US">

The <code>firewalld</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable firewalld.service</pre>
  </td>
  <td xml:lang="en-US">
Access control methods provide the ability to enhance system security posture
by restricting services and known good IP addresses and address ranges. This
prevents connections from unknown hosts and protocols.
  </td>
</tr>
<tr>
  <td>3.4.2.4</td>
  <td>Set Default firewalld Zone for Incoming Packets</td>
  <td xml:lang="en-US">
To set the default zone to <tt>drop</tt> for
the built-in default zone which processes incoming IPv4 and IPv6 packets,
modify the following line in
<tt>/etc/firewalld/firewalld.conf</tt> to be:
<pre>DefaultZone=drop</pre>
  </td>
  <td xml:lang="en-US">
In <tt>firewalld</tt> the default zone is applied only after all
the applicable rules in the table are examined for a match. Setting the
default zone to <tt>drop</tt> implements proper design for a firewall, i.e.
any packets which are not explicitly permitted should not be
accepted.
  </td>
</tr>
<tr>
  <td>3.5</td>
  <td>Deactivate Wireless Network Interfaces</td>
  <td xml:lang="en-US">
Deactivating wireless network interfaces should prevent
normal usage of the wireless capability.
<br /><br />

Configure the system to disable all wireless network interfaces with the
following command:
<pre>$ sudo nmcli radio wifi off</pre>
  </td>
  <td xml:lang="en-US">
The use of wireless networking can introduce many different attack vectors into
the organization's network. Common attack vectors such as malicious association
and ad hoc networks will allow an attacker to spoof a wireless access point
(AP), allowing validated systems to connect to the malicious AP and enabling the
attacker to monitor and record network traffic. These malicious APs can also
serve to create a man-in-the-middle attack or be used to create a denial of
service to valid network resources.
  </td>
</tr>
<tr>
  <td>3.6</td>
  <td>Ensure IPv6 is disabled through kernel boot parameter</td>
  <td xml:lang="en-US">
To disable IPv6 protocol support in the Linux kernel,
add the argument <tt>ipv6.disable=1</tt> to the default
GRUB2 command line for the Linux operating system.
To ensure that <tt>ipv6.disable=1</tt> is added as a kernel command line
argument to newly installed kernels, ad <tt>ipv6.disable=1</tt> to the
default Grub2 command line for Linux operating systems.  Modify the line within
<tt>/etc/default/grub</tt> as shown below:
<pre>GRUB_CMDLINE_LINUX="... ipv6.disable=1 ..."</pre>
Run the following command to update command line for already installed kernels:<pre># grubby --update-kernel=ALL --args="ipv6.disable=1"</pre>
  </td>
  <td xml:lang="en-US">
Any unnecessary network stacks, including IPv6, should be disabled to reduce
the vulnerability to exploitation.
  </td>
</tr>
<tr>
  <td>3.6</td>
  <td>Disable IPv6 Networking Support Automatic Loading</td>
  <td xml:lang="en-US">
To prevent the IPv6 kernel module (<tt>ipv6</tt>) from binding to the
IPv6 networking stack, add the following line to
<tt>/etc/modprobe.d/disabled.conf</tt> (or another file in
<tt>/etc/modprobe.d</tt>):
<pre>options ipv6 disable=1</pre>
This permits the IPv6 module to be loaded (and thus satisfy other modules that
depend on it), while disabling support for the IPv6 protocol.
  </td>
  <td xml:lang="en-US">
Any unnecessary network stacks - including IPv6 - should be disabled, to reduce
the vulnerability to exploitation.
  </td>
</tr>
<tr>
  <td>4.1.1.1</td>
  <td>Ensure the audit Subsystem is Installed</td>
  <td xml:lang="en-US">
The audit package should be installed.
  </td>
  <td xml:lang="en-US">
The auditd service is an access monitoring and accounting daemon, watching system calls to audit any access, in comparison with potential local access control policy such as SELinux policy.
  </td>
</tr>
<tr>
  <td>4.1.1.2</td>
  <td>Enable auditd Service</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service is an essential userspace component of
the Linux Auditing System, as it is responsible for writing audit records to
disk.

The <code>auditd</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable auditd.service</pre>
  </td>
  <td xml:lang="en-US">
Without establishing what type of events occurred, it would be difficult
to establish, correlate, and investigate the events leading up to an outage or attack.
Ensuring the <tt>auditd</tt> service is active ensures audit records
generated by the kernel are appropriately recorded.
<br /><br />
Additionally, a properly configured audit subsystem ensures that actions of
individual system users can be uniquely traced to those users so they
can be held accountable for their actions.
  </td>
</tr>
<tr>
  <td>4.1.1.3</td>
  <td>Enable Auditing for Processes Which Start Prior to the Audit Daemon</td>
  <td xml:lang="en-US">
To ensure all processes can be audited, even those which start
prior to the audit daemon, add the argument <tt>audit=1</tt> to the default
GRUB 2 command line for the Linux operating system.
To ensure that <tt>audit=1</tt> is added as a kernel command line
argument to newly installed kernels, ad <tt>audit=1</tt> to the
default Grub2 command line for Linux operating systems.  Modify the line within
<tt>/etc/default/grub</tt> as shown below:
<pre>GRUB_CMDLINE_LINUX="... audit=1 ..."</pre>
Run the following command to update command line for already installed kernels:<pre># grubby --update-kernel=ALL --args="audit=1"</pre>
  </td>
  <td xml:lang="en-US">
Each process on the system carries an "auditable" flag which indicates whether
its activities can be audited. Although <tt>auditd</tt> takes care of enabling
this for all processes which launch after it does, adding the kernel argument
ensures it is set for every process during boot.
  </td>
</tr>
<tr>
  <td>4.1.1.4</td>
  <td>Extend Audit Backlog Limit for the Audit Daemon</td>
  <td xml:lang="en-US">
To improve the kernel capacity to queue all log events, even those which occurred
prior to the audit daemon, add the argument <tt>audit_backlog_limit=8192</tt> to the default
GRUB 2 command line for the Linux operating system.
To ensure that <tt>audit_backlog_limit=8192</tt> is added as a kernel command line
argument to newly installed kernels, ad <tt>audit_backlog_limit=8192</tt> to the
default Grub2 command line for Linux operating systems.  Modify the line within
<tt>/etc/default/grub</tt> as shown below:
<pre>GRUB_CMDLINE_LINUX="... audit_backlog_limit=8192 ..."</pre>
Run the following command to update command line for already installed kernels:<pre># grubby --update-kernel=ALL --args="audit_backlog_limit=8192"</pre>
  </td>
  <td xml:lang="en-US">
audit_backlog_limit sets the queue length for audit events awaiting transfer
to the audit daemon. Until the audit daemon is up and running, all log messages
are stored in this queue.  If the queue is overrun during boot process, the action
defined by audit failure flag is taken.
  </td>
</tr>
<tr>
  <td>4.1.2.1</td>
  <td>Configure auditd Max Log File Size</td>
  <td xml:lang="en-US">
Determine the amount of audit data (in megabytes)
which should be retained in each log file. Edit the file
<tt>/etc/audit/auditd.conf</tt>. Add or modify the following line, substituting
the correct value of <abbr title="$var_auditd_max_log_file"><tt>6</tt></abbr> for <i>STOREMB</i>:
<pre>max_log_file = <i>STOREMB</i></pre>
Set the value to <tt>6</tt> (MB) or higher for general-purpose systems.
Larger values, of course,
support retention of even more audit data.
  </td>
  <td xml:lang="en-US">
The total storage for audit log files must be large enough to retain
log information over the period required. This is a function of the maximum
log file size and the number of logs retained.
  </td>
</tr>
<tr>
  <td>4.1.2.2</td>
  <td>Configure auditd max_log_file_action Upon Reaching Maximum Log Size</td>
  <td xml:lang="en-US">
The default action to take when the logs reach their maximum size
is to rotate the log files, discarding the oldest one. To configure the action taken
by <tt>auditd</tt>, add or correct the line in <tt>/etc/audit/auditd.conf</tt>:
<pre>max_log_file_action = <i>ACTION</i></pre>
Possible values for <i>ACTION</i> are described in the <tt>auditd.conf</tt> man
page. These include:
<ul>
<li><tt>ignore</tt></li>
<li><tt>syslog</tt></li>
<li><tt>suspend</tt></li>
<li><tt>rotate</tt></li>
<li><tt>keep_logs</tt></li>
</ul>
Set the <tt><i>ACTION</i></tt> to <tt>rotate</tt> to ensure log rotation
occurs. This is the default. The setting is case-insensitive.
  </td>
  <td xml:lang="en-US">
Automatically rotating logs (by setting this to <tt>rotate</tt>)
minimizes the chances of the system unexpectedly running out of disk space by
being overwhelmed with log data. However, for systems that must never discard
log data, or which use external processes to transfer it and reclaim space,
<tt>keep_logs</tt> can be employed.
  </td>
</tr>
<tr>
  <td>4.1.2.3</td>
  <td>Configure auditd space_left Action on Low Disk Space</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service can be configured to take an action
when disk space <i>starts</i> to run low.
Edit the file <tt>/etc/audit/auditd.conf</tt>. Modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>space_left_action = <i>ACTION</i></pre>
Possible values for <i>ACTION</i> are described in the <tt>auditd.conf</tt> man page.
These include:
<ul>
<li><tt>syslog</tt></li>
<li><tt>email</tt></li>
<li><tt>exec</tt></li>
<li><tt>suspend</tt></li>
<li><tt>single</tt></li>
<li><tt>halt</tt></li>
</ul>
Set this to <tt>email</tt> (instead of the default,
which is <tt>suspend</tt>) as it is more likely to get prompt attention. Acceptable values
also include <tt>suspend</tt>, <tt>single</tt>, and <tt>halt</tt>.
  </td>
  <td xml:lang="en-US">
Notifying administrators of an impending disk space problem may
allow them to take corrective action prior to any disruption.
  </td>
</tr>
<tr>
  <td>4.1.2.3</td>
  <td>Configure auditd admin_space_left Action on Low Disk Space</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service can be configured to take an action
when disk space is running low but prior to running out of space completely.
Edit the file <tt>/etc/audit/auditd.conf</tt>. Add or modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>admin_space_left_action = <i>ACTION</i></pre>
Set this value to <tt>single</tt> to cause the system to switch to single user
mode for corrective action. Acceptable values also include <tt>suspend</tt> and
<tt>halt</tt>. For certain systems, the need for availability
outweighs the need to log all actions, and a different setting should be
determined. Details regarding all possible values for <i>ACTION</i> are described in the
<tt>auditd.conf</tt> man page.
  </td>
  <td xml:lang="en-US">
Administrators should be made aware of an inability to record
audit records. If a separate partition or logical volume of adequate size
is used, running low on space for audit records should never occur.
  </td>
</tr>
<tr>
  <td>4.1.2.3</td>
  <td>Configure auditd mail_acct Action on Low Disk Space</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service can be configured to send email to
a designated account in certain situations. Add or correct the following line
in <tt>/etc/audit/auditd.conf</tt> to ensure that administrators are notified
via email for those situations:
<pre>action_mail_acct = <abbr title="$var_auditd_action_mail_acct"><tt>root</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
Email sent to the root account is typically aliased to the
administrators of the system, who can take appropriate action.
  </td>
</tr>
<tr>
  <td>4.1.3</td>
  <td>Ensure auditd Collects System Administrator Actions</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect administrator actions
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the default),
add the following line to a file with suffix <tt>.rules</tt> in the directory
<tt>/etc/audit/rules.d</tt>:
<pre>-w /etc/sudoers -p wa -k actions
-w /etc/sudoers.d/ -p wa -k actions</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-w /etc/sudoers -p wa -k actions
-w /etc/sudoers.d/ -p wa -k actions</pre>
  </td>
  <td xml:lang="en-US">
The actions taken by system administrators should be audited to keep a record
of what was executed on the system, as well as, for accountability purposes.
  </td>
</tr>
<tr>
  <td>4.1.4</td>
  <td>Record Attempts to Alter Logon and Logout Events - lastlog</td>
  <td xml:lang="en-US">
The audit system already collects login information for all users
and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt> in order to watch for attempted manual
edits of files involved in storing logon events:
<pre>-w /var/log/lastlog -p wa -k logins</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file in order to watch for unattempted manual
edits of files involved in storing logon events:
<pre>-w /var/log/lastlog -p wa -k logins</pre>
  </td>
  <td xml:lang="en-US">
Manual editing of these files may indicate nefarious activity, such
as an attacker attempting to remove evidence of an intrusion.
  </td>
</tr>
<tr>
  <td>4.1.4</td>
  <td>Record Attempts to Alter Logon and Logout Events - faillock</td>
  <td xml:lang="en-US">
The audit system already collects login information for all users
and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt> in order to watch for attempted manual
edits of files involved in storing logon events:
<pre>-w /var/run/faillock -p wa -k logins</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file in order to watch for unattempted manual
edits of files involved in storing logon events:
<pre>-w /var/run/faillock -p wa -k logins</pre>
  </td>
  <td xml:lang="en-US">
Manual editing of these files may indicate nefarious activity, such
as an attacker attempting to remove evidence of an intrusion.
  </td>
</tr>
<tr>
  <td>4.1.5</td>
  <td>Record Attempts to Alter Process and Session Initiation Information</td>
  <td xml:lang="en-US">
The audit system already collects process information for all
users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt> in order to watch for attempted manual
edits of files involved in storing such process information:
<pre>-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file in order to watch for attempted manual
edits of files involved in storing such process information:
<pre>-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session</pre>
  </td>
  <td xml:lang="en-US">
Manual editing of these files may indicate nefarious activity, such
as an attacker attempting to remove evidence of an intrusion.
  </td>
</tr>
<tr>
  <td>4.1.6</td>
  <td>Record attempts to alter time through settimeofday</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can be
used for better reporting capability through ausearch and aureport. Multiple
system calls can be defined on the same line to save space if desired, but is
not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
  </td>
  <td xml:lang="en-US">
Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.
  </td>
</tr>
<tr>
  <td>4.1.6</td>
  <td>Record attempts to alter time through adjtimex</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can be
used for better reporting capability through ausearch and aureport. Multiple
system calls can be defined on the same line to save space if desired, but is
not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
  </td>
  <td xml:lang="en-US">
Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.
  </td>
</tr>
<tr>
  <td>4.1.6</td>
  <td>Record Attempts to Alter Time Through clock_settime</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change</pre>
The -k option allows for the specification of a key in string form that can
be used for better reporting capability through ausearch and aureport.
Multiple system calls can be defined on the same line to save space if
desired, but is not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
  </td>
  <td xml:lang="en-US">
Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.
  </td>
</tr>
<tr>
  <td>4.1.6</td>
  <td>Record Attempts to Alter Time Through stime</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt> for both 32 bit and 64 bit systems:
<pre>-a always,exit -F arch=b32 -S stime -F key=audit_time_rules</pre>
Since the 64 bit version of the "stime" system call is not defined in the audit
lookup table, the corresponding "-F arch=b64" form of this rule is not expected
to be defined on 64 bit systems (the aforementioned "-F arch=b32" stime rule
form itself is sufficient for both 32 bit and 64 bit systems). If the
<tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility to
read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file for both 32 bit and 64 bit systems:
<pre>-a always,exit -F arch=b32 -S stime -F key=audit_time_rules</pre>
Since the 64 bit version of the "stime" system call is not defined in the audit
lookup table, the corresponding "-F arch=b64" form of this rule is not expected
to be defined on 64 bit systems (the aforementioned "-F arch=b32" stime rule
form itself is sufficient for both 32 bit and 64 bit systems). The -k option
allows for the specification of a key in string form that can be used for
better reporting capability through ausearch and aureport. Multiple system
calls can be defined on the same line to save space if desired, but is not
required. See an example of multiple combined system calls:
<pre>-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules</pre>
  </td>
  <td xml:lang="en-US">
Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.
  </td>
</tr>
<tr>
  <td>4.1.6</td>
  <td>Record Attempts to Alter the localtime File</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the default),
add the following line to a file with suffix <tt>.rules</tt> in the directory
<tt>/etc/audit/rules.d</tt>:
<pre>-w /etc/localtime -p wa -k audit_time_rules</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-w /etc/localtime -p wa -k audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can
be used for better reporting capability through ausearch and aureport and
should always be used.
  </td>
  <td xml:lang="en-US">
Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.
  </td>
</tr>
<tr>
  <td>4.1.7</td>
  <td>Record Events that Modify the System's Mandatory Access Controls</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>:
<pre>-w /etc/selinux/ -p wa -k MAC-policy</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-w /etc/selinux/ -p wa -k MAC-policy</pre>
  </td>
  <td xml:lang="en-US">
The system's mandatory access policy (SELinux) should not be
arbitrarily changed by anything other than administrator action. All changes to
MAC policy should be audited.
  </td>
</tr>
<tr>
  <td>4.1.8</td>
  <td>Record Events that Modify the System's Network Environment</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification
-w /etc/issue -p wa -k audit_rules_networkconfig_modification
-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification
-w /etc/hosts -p wa -k audit_rules_networkconfig_modification
-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification
-w /etc/issue -p wa -k audit_rules_networkconfig_modification
-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification
-w /etc/hosts -p wa -k audit_rules_networkconfig_modification
-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification</pre>
  </td>
  <td xml:lang="en-US">
The network environment should not be modified by anything other
than administrator action. Any change to network parameters should be
audited.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fsetxattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - lchown</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - lsetxattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - removexattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root.
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>augenrules</tt>
program to read audit rules during daemon startup (the default), add the
following line to a file with suffix <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S removexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S removexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S removexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S removexattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - setxattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S setxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S setxattr -F auid=0 -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S setxattr -F auid=0 -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S setxattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fremovexattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root.
<br /><br />
If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fchown</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>

If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - chown</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured to
use the <tt>augenrules</tt> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <tt>.rules</tt> in
the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chown -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fchmod</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured to
use the <tt>augenrules</tt> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <tt>.rules</tt> in
the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - chmod</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured to
use the <tt>augenrules</tt> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <tt>.rules</tt> in
the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S chmod -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fchmodat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured to
use the <tt>augenrules</tt> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <tt>.rules</tt> in
the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - lremovexattr</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root.
<br /><br />
If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -F key=perm_mod</pre>
<br /><br />
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.9</td>
  <td>Record Events that Modify the System's Discretionary Access Controls - fchownat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file permission
changes for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
If the system is 64 bit then also add the following line:
<pre>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod</pre>
  </td>
  <td xml:lang="en-US">
The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - creat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - ftruncate</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S ftruncate -F exiu=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - open_by_handle_at</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - truncate</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - openat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.10</td>
  <td>Record Unsuccessful Access Attempts to Files - open</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect unauthorized file
accesses for all users and root. If the <tt>auditd</tt> daemon is configured
to use the <tt>augenrules</tt> program to read audit rules during daemon
startup (the default), add the following lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:
<pre>-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file:
<pre>-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>

If the system is 64 bit then also add the following lines:
<pre>
-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=access
-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=access</pre>
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.
  </td>
</tr>
<tr>
  <td>4.1.11</td>
  <td>Record Events that Modify User/Group Information - /etc/group</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/group -p wa -k audit_rules_usergroup_modification</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/group -p wa -k audit_rules_usergroup_modification</pre>
  </td>
  <td xml:lang="en-US">
In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications should be investigated for legitimacy.
  </td>
</tr>
<tr>
  <td>4.1.11</td>
  <td>Record Events that Modify User/Group Information - /etc/security/opasswd</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification</pre>
  </td>
  <td xml:lang="en-US">
In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications should be investigated for legitimacy.
  </td>
</tr>
<tr>
  <td>4.1.11</td>
  <td>Record Events that Modify User/Group Information - /etc/shadow</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/shadow -p wa -k audit_rules_usergroup_modification</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/shadow -p wa -k audit_rules_usergroup_modification</pre>
  </td>
  <td xml:lang="en-US">
In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications should be investigated for legitimacy.
  </td>
</tr>
<tr>
  <td>4.1.11</td>
  <td>Record Events that Modify User/Group Information - /etc/gshadow</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/gshadow -p wa -k audit_rules_usergroup_modification</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/gshadow -p wa -k audit_rules_usergroup_modification</pre>
  </td>
  <td xml:lang="en-US">
In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications should be investigated for legitimacy.
  </td>
</tr>
<tr>
  <td>4.1.11</td>
  <td>Record Events that Modify User/Group Information - /etc/passwd</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following lines to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/passwd -p wa -k audit_rules_usergroup_modification</pre>
<br /><br />
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following lines to
<tt>/etc/audit/audit.rules</tt> file, in order to capture events that modify
account changes:
<br /><br />
<pre>-w /etc/passwd -p wa -k audit_rules_usergroup_modification</pre>
  </td>
  <td xml:lang="en-US">
In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications should be investigated for legitimacy.
  </td>
</tr>
<tr>
  <td>4.1.12</td>
  <td>Ensure auditd Collects Information on Exporting to Media (successful)</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect media exportation
events for all users and root. If the <tt>auditd</tt> daemon is configured to
use the <tt>augenrules</tt> program to read audit rules during daemon startup
(the default), add the following line to a file with suffix <tt>.rules</tt> in
the directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S mount -F auid&gt;=1000 -F auid!=unset -F key=export</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S mount -F auid&gt;=1000 -F auid!=unset -F key=export</pre>
  </td>
  <td xml:lang="en-US">
The unauthorized exportation of data to external media could result in an information leak
where classified information, Privacy Act information, and intellectual property could be lost. An audit
trail should be created each time a filesystem is mounted to help identify and guard against information
loss.
  </td>
</tr>
<tr>
  <td>4.1.13</td>
  <td>Ensure auditd Collects Information on the Use of Privileged Commands</td>
  <td xml:lang="en-US">
The audit system should collect information about usage of privileged
commands for all users and root. To find the relevant setuid /
setgid programs, run the following command for each local partition
<i>PART</i>:
<pre>$ sudo find <i>PART</i> -xdev -type f -perm -4000 -o -type f -perm -2000 2&gt;/dev/null</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>augenrules</tt>
program to read audit rules during daemon startup (the default), add a line of
the following form to a file with suffix <tt>.rules</tt> in the directory
<tt>/etc/audit/rules.d</tt> for each setuid / setgid program on the system,
replacing the <i>SETUID_PROG_PATH</i> part with the full path of that setuid /
setgid program in the list:
<pre>-a always,exit -F path=<i>SETUID_PROG_PATH</i> -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add a line of the following
form to <tt>/etc/audit/audit.rules</tt> for each setuid / setgid program on the
system, replacing the <i>SETUID_PROG_PATH</i> part with the full path of that
setuid / setgid program in the list:
<pre>-a always,exit -F path=<i>SETUID_PROG_PATH</i> -F auid&gt;=1000 -F auid!=unset -F key=privileged</pre>
  </td>
  <td xml:lang="en-US">
Misuse of privileged functions, either intentionally or unintentionally by
authorized users, or by unauthorized external entities that have compromised system accounts,
is a serious and ongoing concern and can have significant adverse impacts on organizations.
Auditing the use of privileged functions is one way to detect such misuse and identify
the risk from insider and advanced persistent threats.
<br /><br />
Privileged programs are subject to escalation-of-privilege attacks,
which attempt to subvert their normal role of providing some necessary but
limited capability. As such, motivation exists to monitor these programs for
unusual activity.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User - unlink</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S unlink -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S unlink -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User</td>
  <td xml:lang="en-US">
At a minimum the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rmdir,unlink,unlinkat,rename,renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rmdir,unlink,unlinkat,rename -S renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User - rmdir</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rmdir -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rmdir -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User - unlinkat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S unlinkat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S unlinkat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User - rename</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rename -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rename -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.14</td>
  <td>Ensure auditd Collects File Deletion Events by User - renameat</td>
  <td xml:lang="en-US">
At a minimum, the audit system should collect file deletion events
for all users and root. If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S renameat -F auid&gt;=1000 -F auid!=unset -F key=delete</pre>
  </td>
  <td xml:lang="en-US">
Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.
  </td>
</tr>
<tr>
  <td>4.1.15</td>
  <td>Ensure auditd Collects Information on Kernel Module Unloading - delete_module</td>
  <td xml:lang="en-US">
To capture kernel module unloading events, use following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=<i>ARCH</i> -S delete_module -F key=modules</pre>

Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.
  </td>
  <td xml:lang="en-US">
The removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.
  </td>
</tr>
<tr>
  <td>4.1.15</td>
  <td>Ensure auditd Collects Information on Kernel Module Loading and Unloading</td>
  <td xml:lang="en-US">
To capture kernel module loading and unloading events, use following lines, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>
-a always,exit -F arch=<i>ARCH</i> -S init_module,finit_module,delete_module -F key=modules
</pre>

The place to add the lines depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the lines to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the lines to file <tt>/etc/audit/audit.rules</tt>.
  </td>
  <td xml:lang="en-US">
The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.
  </td>
</tr>
<tr>
  <td>4.1.15</td>
  <td>Ensure auditd Collects Information on Kernel Module Loading - init_module</td>
  <td xml:lang="en-US">
To capture kernel module loading events, use following line, setting ARCH to
either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:
<pre>-a always,exit -F arch=<i>ARCH</i> -S init_module -F key=modules</pre>

Place to add the line depends on a way <tt>auditd</tt> daemon is configured. If it is configured
to use the <tt>augenrules</tt> program (the default), add the line to a file with suffix
<tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility,
add the line to file <tt>/etc/audit/audit.rules</tt>.
  </td>
  <td xml:lang="en-US">
The addition of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.
  </td>
</tr>
<tr>
  <td>4.1.15</td>
  <td>Ensure auditd Collects Information on Kernel Module Loading and Unloading - finit_module</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the <tt>augenrules</tt> program
to read audit rules during daemon startup (the default), add the following lines to a file
with suffix <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt> to capture kernel module
loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:
<pre>-a always,exit -F arch=<i>ARCH</i> -S finit_module -F key=modules</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt> utility to read audit
rules during daemon startup, add the following lines to <tt>/etc/audit/audit.rules</tt> file
in order to capture kernel module loading and unloading events, setting ARCH to either b32 or
b64 as appropriate for your system:
<pre>-a always,exit -F arch=<i>ARCH</i> -S finit_module -F key=modules</pre>
  </td>
  <td xml:lang="en-US">
The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.
  </td>
</tr>
<tr>
  <td>4.1.17</td>
  <td>Make the auditd Configuration Immutable</td>
  <td xml:lang="en-US">
If the <tt>auditd</tt> daemon is configured to use the
<tt>augenrules</tt> program to read audit rules during daemon startup (the
default), add the following line to a file with suffix <tt>.rules</tt> in the
directory <tt>/etc/audit/rules.d</tt> in order to make the auditd configuration
immutable:
<pre>-e 2</pre>
If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
utility to read audit rules during daemon startup, add the following line to
<tt>/etc/audit/audit.rules</tt> file in order to make the auditd configuration
immutable:
<pre>-e 2</pre>
With this setting, a reboot will be required to change any audit rules.
  </td>
  <td xml:lang="en-US">
Making the audit configuration immutable prevents accidental as
well as malicious modification of the audit rules, although it may be
problematic if legitimate changes are needed during system
operation
  </td>
</tr>
<tr>
  <td>4.2.1.1</td>
  <td>Ensure rsyslog is Installed</td>
  <td xml:lang="en-US">
Rsyslog is installed by default. The <code>rsyslog</code> package can be installed with the following command: <pre> $ sudo yum install rsyslog</pre>
  </td>
  <td xml:lang="en-US">
The rsyslog package provides the rsyslog daemon, which provides
system logging services.
  </td>
</tr>
<tr>
  <td>4.2.1.2</td>
  <td>Enable rsyslog Service</td>
  <td xml:lang="en-US">
The <tt>rsyslog</tt> service provides syslog-style logging by default on Red Hat Enterprise Linux 8.

The <code>rsyslog</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable rsyslog.service</pre>
  </td>
  <td xml:lang="en-US">
The <tt>rsyslog</tt> service must be running in order to provide
logging services, which are essential to system administration.
  </td>
</tr>
<tr>
  <td>4.2.1.3</td>
  <td>Ensure System Log Files Have Correct Permissions</td>
  <td xml:lang="en-US">
The file permissions for all log files written by <tt>rsyslog</tt> should
be set to 600, or more restrictive. These log files are determined by the
second part of each Rule line in <tt>/etc/rsyslog.conf</tt> and typically
all appear in <tt>/var/log</tt>. For each log file <i>LOGFILE</i>
referenced in <tt>/etc/rsyslog.conf</tt>, run the following command to
inspect the file's permissions:
<pre>$ ls -l <i>LOGFILE</i></pre>
If the permissions are not 600 or more restrictive, run the following
command to correct this:
<pre>$ sudo chmod 0600 <i>LOGFILE</i></pre>"
  </td>
  <td xml:lang="en-US">
Log files can contain valuable information regarding system
configuration. If the system log files are not protected unauthorized
users could change the logged data, eliminating their forensic value.
  </td>
</tr>
<tr>
  <td>4.2.1.5</td>
  <td>Ensure Logs Sent To Remote Host</td>
  <td xml:lang="en-US">
To configure rsyslog to send logs to a remote log server,
open <tt>/etc/rsyslog.conf</tt> and read and understand the last section of the file,
which describes the multiple directives necessary to activate remote
logging.
Along with these other directives, the system can be configured
to forward its logs to a particular log server by
adding or correcting one of the following lines,
substituting <tt><i><abbr title="$rsyslog_remote_loghost_address"><tt>logcollector</tt></abbr></i></tt> appropriately.
The choice of protocol depends on the environment of the system;
although TCP and RELP provide more reliable message delivery,
they may not be supported in all environments.
<br />
To use UDP for log message delivery:
<pre>*.* @<i><abbr title="$rsyslog_remote_loghost_address"><tt>logcollector</tt></abbr></i></pre>
<br />
To use TCP for log message delivery:
<pre>*.* @@<i><abbr title="$rsyslog_remote_loghost_address"><tt>logcollector</tt></abbr></i></pre>
<br />
To use RELP for log message delivery:
<pre>*.* :omrelp:<i><abbr title="$rsyslog_remote_loghost_address"><tt>logcollector</tt></abbr></i></pre>
<br />
There must be a resolvable DNS CNAME or Alias record set to "<abbr title="$rsyslog_remote_loghost_address"><tt>logcollector</tt></abbr>" for logs to be sent correctly to the centralized logging utility.
  </td>
  <td xml:lang="en-US">
A log server (loghost) receives syslog messages from one or more
systems. This data can be used as an additional log source in the event a
system is compromised and its local logs are suspect. Forwarding log messages
to a remote loghost also provides system administrators with a centralized
place to view the status of multiple hosts within the enterprise.
  </td>
</tr>
<tr>
  <td>4.2.1.6</td>
  <td>Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server</td>
  <td xml:lang="en-US">
The <tt>rsyslog</tt> daemon should not accept remote messages
unless the system acts as a log server.
To ensure that it is not listening on the network, ensure the following lines are
<i>not</i> found in <tt>/etc/rsyslog.conf</tt>:
<pre>$ModLoad imtcp
$InputTCPServerRun <i>port</i>
$ModLoad imudp
$UDPServerRun <i>port</i>
$ModLoad imrelp
$InputRELPServerRun <i>port</i></pre>
  </td>
  <td xml:lang="en-US">
Any process which receives messages from the network incurs some risk
of receiving malicious messages. This risk can be eliminated for
rsyslog by configuring it not to listen on the network.
  </td>
</tr>
<tr>
  <td>4.2.2.1</td>
  <td>Ensure journald is configured to send logs to rsyslog</td>
  <td xml:lang="en-US">
Data from journald may be stored in volatile memory or persisted locally.
Utilities exist to accept remote export of journald logs.
  </td>
  <td xml:lang="en-US">
Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
  </td>
</tr>
<tr>
  <td>4.2.2.2</td>
  <td>Ensure journald is configured to compress large log files</td>
  <td xml:lang="en-US">
The journald system can compress large log files to avoid fill the system disk.
  </td>
  <td xml:lang="en-US">
Log files that are not properly compressed run the risk of growing so large that they fill up the log partition. Valuable logging information could be lost if the log partition becomes full.
  </td>
</tr>
<tr>
  <td>4.2.2.3</td>
  <td>Ensure journald is configured to write log files to persistent disk</td>
  <td xml:lang="en-US">
The journald system may store log files in volatile memory or locally on disk.
If the logs are only stored in volatile memory they will we lost upon reboot.
  </td>
  <td xml:lang="en-US">
Log files contain valuable data and need to be persistent to aid in possible investigations.
  </td>
</tr>
<tr>
  <td>4.3</td>
  <td>Ensure Logrotate Runs Periodically</td>
  <td xml:lang="en-US">
The <tt>logrotate</tt> utility allows for the automatic rotation of
log files.  The frequency of rotation is specified in <tt>/etc/logrotate.conf</tt>,
which triggers a cron task.  To configure logrotate to run daily, add or correct
the following line in <tt>/etc/logrotate.conf</tt>:
<pre># rotate log files <i>frequency</i>
daily</pre>
  </td>
  <td xml:lang="en-US">
Log files that are not properly rotated run the risk of growing so large
that they fill up the /var/log partition. Valuable logging information could be lost
if the /var/log partition becomes full.
  </td>
</tr>
<tr>
  <td>5.1.1</td>
  <td>Enable cron Service</td>
  <td xml:lang="en-US">
The <tt>crond</tt> service is used to execute commands at
preconfigured times. It is required by almost all systems to perform necessary
maintenance tasks, such as notifying root of system activity.

The <code>crond</code> service can be enabled with the following command:
<pre>$ sudo systemctl enable crond.service</pre>
  </td>
  <td xml:lang="en-US">
Due to its usage for maintenance and security-supporting tasks,
enabling the cron daemon is essential.
  </td>
</tr>
<tr>
  <td>5.1.2</td>
  <td>Verify Group Who Owns Crontab</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/crontab</code>, run the command:
<pre>$ sudo chgrp root /etc/crontab</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.2</td>
  <td>Verify Permissions on crontab</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/crontab</code>, run the command:
<pre>$ sudo chmod 0600 /etc/crontab</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.2</td>
  <td>Verify Owner on crontab</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/crontab</code>, run the command:
<pre>$ sudo chown root /etc/crontab </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.3</td>
  <td>Verify Owner on cron.hourly</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/cron.hourly</code>, run the command:
<pre>$ sudo chown root /etc/cron.hourly </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.3</td>
  <td>Verify Permissions on cron.hourly</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/cron.hourly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.hourly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.3</td>
  <td>Verify Group Who Owns cron.hourly</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/cron.hourly</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.hourly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.4</td>
  <td>Verify Owner on cron.daily</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/cron.daily</code>, run the command:
<pre>$ sudo chown root /etc/cron.daily </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.4</td>
  <td>Verify Group Who Owns cron.daily</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/cron.daily</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.daily</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.4</td>
  <td>Verify Permissions on cron.daily</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/cron.daily</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.daily</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.5</td>
  <td>Verify Group Who Owns cron.weekly</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/cron.weekly</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.weekly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.5</td>
  <td>Verify Owner on cron.weekly</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/cron.weekly</code>, run the command:
<pre>$ sudo chown root /etc/cron.weekly </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.5</td>
  <td>Verify Permissions on cron.weekly</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/cron.weekly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.weekly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.6</td>
  <td>Verify Permissions on cron.monthly</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/cron.monthly</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.monthly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.6</td>
  <td>Verify Group Who Owns cron.monthly</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/cron.monthly</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.monthly</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.6</td>
  <td>Verify Owner on cron.monthly</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/cron.monthly</code>, run the command:
<pre>$ sudo chown root /etc/cron.monthly </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.7</td>
  <td>Verify Owner on cron.d</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/cron.d</code>, run the command:
<pre>$ sudo chown root /etc/cron.d </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct user to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.7</td>
  <td>Verify Group Who Owns cron.d</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/cron.d</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.d</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.7</td>
  <td>Verify Permissions on cron.d</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/cron.d</code>, run the command:
<pre>$ sudo chmod 0700 /etc/cron.d</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective services that if configured incorrectly
can lead to insecure and vulnerable configurations. Therefore, service configuration files should have the
correct access rights to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Verify Group Who Owns /etc/cron.allow file</td>
  <td xml:lang="en-US">
If <tt>/etc/cron.allow</tt> exists, it must be group-owned by <tt>root</tt>.

To properly set the group owner of <code>/etc/cron.allow</code>, run the command:
<pre>$ sudo chgrp root /etc/cron.allow</pre>
  </td>
  <td xml:lang="en-US">
If the owner of the cron.allow file is not set to root, the possibility exists for an
unauthorized user to view or edit sensitive information.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Ensure that /etc/cron.deny does not exist</td>
  <td xml:lang="en-US">
The file <tt>/etc/cron.deny</tt> should not exist.
Use <tt>/etc/cron.allow</tt> instead.
  </td>
  <td xml:lang="en-US">
Access to <tt>cron</tt> should be restricted.
It is easier to manage an allow list than a deny list.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Verify Permissions on /etc/at.allow file</td>
  <td xml:lang="en-US">
If <tt>/etc/at.allow</tt> exists, it must have permissions <tt>0600</tt>
or more restrictive.


To properly set the permissions of <code>/etc/at.allow</code>, run the command:
<pre>$ sudo chmod  /etc/at.allow</pre>
  </td>
  <td xml:lang="en-US">
If the permissions of the at.allow file are not set to 0600 or more restrictive,
the possibility exists for an unauthorized user to view or edit sensitive information.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Verify Group Who Owns /etc/at.allow file</td>
  <td xml:lang="en-US">
If <tt>/etc/at.allow</tt> exists, it must be group-owned by <tt>root</tt>.

To properly set the group owner of <code>/etc/at.allow</code>, run the command:
<pre>$ sudo chgrp root /etc/at.allow</pre>
  </td>
  <td xml:lang="en-US">
If the owner of the at.allow file is not set to root, the possibility exists for an
unauthorized user to view or edit sensitive information.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Ensure that /etc/at.deny does not exist</td>
  <td xml:lang="en-US">
The file <tt>/etc/at.deny</tt> should not exist.
Use <tt>/etc/at.allow</tt> instead.
  </td>
  <td xml:lang="en-US">
Access to <tt>at</tt> should be restricted.
It is easier to manage an allow list than a deny list.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Verify User Who Owns /etc/cron.allow file</td>
  <td xml:lang="en-US">
If <tt>/etc/cron.allow</tt> exists, it must be owned by <tt>root</tt>.

To properly set the owner of <code>/etc/cron.allow</code>, run the command:
<pre>$ sudo chown root /etc/cron.allow </pre>
  </td>
  <td xml:lang="en-US">
If the owner of the cron.allow file is not set to root, the possibility exists for an
unauthorized user to view or edit sensitive information.
  </td>
</tr>
<tr>
  <td>5.1.8</td>
  <td>Verify Permissions on /etc/cron.allow file</td>
  <td xml:lang="en-US">
If <tt>/etc/cron.allow</tt> exists, it must have permissions <tt>0600</tt>
or more restrictive.


To properly set the permissions of <code>/etc/cron.allow</code>, run the command:
<pre>$ sudo chmod  /etc/cron.allow</pre>
  </td>
  <td xml:lang="en-US">
If the permissions of the cron.allow file are not set to 0600 or more restrictive,
the possibility exists for an unauthorized user to view or edit sensitive information.
  </td>
</tr>
<tr>
  <td>5.2.1</td>
  <td>Verify Permissions on SSH Server config file</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/ssh/sshd_config</code>, run the command:
<pre>$ sudo chmod 0600 /etc/ssh/sshd_config</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective
services that if configured incorrectly can lead to insecure and vulnerable
configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.2.1</td>
  <td>Verify Group Who Owns SSH Server config file</td>
  <td xml:lang="en-US">

To properly set the group owner of <code>/etc/ssh/sshd_config</code>, run the command:
<pre>$ sudo chgrp root /etc/ssh/sshd_config</pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective
services that if configured incorrectly can lead to insecure and vulnerable
configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.2.1</td>
  <td>Verify Owner on SSH Server config file</td>
  <td xml:lang="en-US">

To properly set the owner of <code>/etc/ssh/sshd_config</code>, run the command:
<pre>$ sudo chown root /etc/ssh/sshd_config </pre>
  </td>
  <td xml:lang="en-US">
Service configuration files enable or disable features of their respective
services that if configured incorrectly can lead to insecure and vulnerable
configurations. Therefore, service configuration files should be owned by the
correct group to prevent unauthorized changes.
  </td>
</tr>
<tr>
  <td>5.2.3</td>
  <td>Verify Permissions on SSH Server Private *_key Key Files</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/ssh/*_key</code>, run the command:
<pre>$ sudo chmod 0600 /etc/ssh/*_key</pre>
  </td>
  <td xml:lang="en-US">
If an unauthorized user obtains the private SSH host key file, the host could be
impersonated.
  </td>
</tr>
<tr>
  <td>5.2.4</td>
  <td>Verify Permissions on SSH Server Public *.pub Key Files</td>
  <td xml:lang="en-US">
 To properly set the permissions of <code>/etc/ssh/*.pub</code>, run the command: <pre>$ sudo chmod 0644 /etc/ssh/*.pub</pre>
  </td>
  <td xml:lang="en-US">
If a public host key file is modified by an unauthorized user, the SSH service
may be compromised.
  </td>
</tr>
<tr>
  <td>5.2.5</td>
  <td>Set SSH Daemon LogLevel to VERBOSE</td>
  <td xml:lang="en-US">
The <tt>VERBOSE</tt> parameter configures the SSH daemon to record login and logout activity.
To specify the log level in
SSH, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>LogLevel VERBOSE</pre>
  </td>
  <td xml:lang="en-US">
SSH provides several logging levels with varying amounts of verbosity. <tt>DEBUG</tt> is specifically
not recommended other than strictly for debugging SSH communications since it provides
so much data that it is difficult to identify important security information. <tt>INFO</tt> or
<tt>VERBOSE</tt> level is the basic level that only records login activity of SSH users. In many
situations, such as Incident Response, it is important to determine when a particular user was active
on a system. The logout record can eliminate those users who disconnected, which helps narrow the
field.
  </td>
</tr>
<tr>
  <td>5.2.5</td>
  <td>Set LogLevel to INFO</td>
  <td xml:lang="en-US">
The INFO parameter specifices that record login and logout activity will be logged.
<br/>
The default SSH configuration sets the log level to INFO. The appropriate
configuration is used if no value is set for <tt>LogLevel</tt>.
<br/>
To explicitly specify the log level in SSH, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>LogLevel INFO</pre>
  </td>
  <td xml:lang="en-US">
SSH provides several logging levels with varying amounts of verbosity. <tt>DEBUG</tt> is specifically
not recommended other than strictly for debugging SSH communications since it provides
so much data that it is difficult to identify important security information. <tt>INFO</tt> level is the
basic level that only records login activity of SSH users. In many situations, such as Incident
Response, it is important to determine when a particular user was active on a system. The
logout record can eliminate those users who disconnected, which helps narrow the field.
  </td>
</tr>
<tr>
  <td>5.2.6</td>
  <td>Disable X11 Forwarding</td>
  <td xml:lang="en-US">
The X11Forwarding parameter provides the ability to tunnel X11 traffic
through the connection to enable remote graphic connections.
SSH has the capability to encrypt remote X11 connections when SSH's
<tt>X11Forwarding</tt> option is enabled.
<br />
The default SSH configuration disables X11Forwarding. The appropriate
configuration is used if no value is set for <tt>X11Forwarding</tt>.
<br />
To explicitly disable X11 Forwarding, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>X11Forwarding no</pre>
  </td>
  <td xml:lang="en-US">
Disable X11 forwarding unless there is an operational requirement to use X11
applications directly. There is a small risk that the remote X11 servers of
users who are logged in via SSH with X11 forwarding could be compromised by
other users on the X11 server. Note that even if X11 forwarding is disabled,
users can always install their own forwarders.
  </td>
</tr>
<tr>
  <td>5.2.7</td>
  <td>Set SSH authentication attempt limit</td>
  <td xml:lang="en-US">
The <tt>MaxAuthTries</tt> parameter specifies the maximum number of authentication attempts
permitted per connection. Once the number of failures reaches half this value, additional failures are logged.
to set MaxAUthTries edit <tt>/etc/ssh/sshd_config</tt> as follows:
<pre>MaxAuthTries <abbr title="$sshd_max_auth_tries_value"><tt>4</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
Setting the MaxAuthTries parameter to a low number will minimize the risk of successful
brute force attacks to the SSH server.
  </td>
</tr>
<tr>
  <td>5.2.8</td>
  <td>Disable SSH Support for .rhosts Files</td>
  <td xml:lang="en-US">
SSH can emulate the behavior of the obsolete rsh
command in allowing users to enable insecure access to their
accounts via <tt>.rhosts</tt> files.
<br />
The default SSH configuration disables support for <tt>.rhosts</tt>. The appropriate
configuration is used if no value is set for <tt>IgnoreRhosts</tt>.
<br/>
To explicitly disable support for .rhosts files, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>IgnoreRhosts yes</pre>
  </td>
  <td xml:lang="en-US">
SSH trust relationships mean a compromise on one host
can allow an attacker to move trivially to other hosts.
  </td>
</tr>
<tr>
  <td>5.2.9</td>
  <td>Disable Host-Based Authentication</td>
  <td xml:lang="en-US">
SSH's cryptographic host-based authentication is
more secure than <tt>.rhosts</tt> authentication. However, it is
not recommended that hosts unilaterally trust one another, even
within an organization.
<br />
The default SSH configuration disables host-based authentication. The appropriate
configuration is used if no value is set for <tt>HostbasedAuthentication</tt>.
<br />
To explicitly disable host-based authentication, add or correct the
following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>HostbasedAuthentication no</pre>
  </td>
  <td xml:lang="en-US">
SSH trust relationships mean a compromise on one host
can allow an attacker to move trivially to other hosts.
  </td>
</tr>
<tr>
  <td>5.2.10</td>
  <td>Disable SSH Root Login</td>
  <td xml:lang="en-US">
The root user should never be allowed to login to a
system directly over a network.
To disable root login via SSH, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>PermitRootLogin no</pre>
  </td>
  <td xml:lang="en-US">
Even though the communications channel may be encrypted, an additional layer of
security is gained by extending the policy of not logging directly on as root.
In addition, logging in with a user-specific account provides individual
accountability of actions performed on the system and also helps to minimize
direct attack attempts on root's password.
  </td>
</tr>
<tr>
  <td>5.2.11</td>
  <td>Disable SSH Access via Empty Passwords</td>
  <td xml:lang="en-US">
Disallow SSH login with empty passwords.
The default SSH configuration disables logins with empty passwords. The appropriate
configuration is used if no value is set for <tt>PermitEmptyPasswords</tt>.
<br />
To explicitly disallow SSH login from accounts with empty passwords,
add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<br />
<pre>PermitEmptyPasswords no</pre>
Any accounts with empty passwords should be disabled immediately, and PAM configuration
should prevent users from being able to assign themselves empty passwords.
  </td>
  <td xml:lang="en-US">
Configuring this setting for the SSH daemon provides additional assurance
that remote login via SSH will require a password, even in the event of
misconfiguration elsewhere.
  </td>
</tr>
<tr>
  <td>5.2.12</td>
  <td>Do Not Allow SSH Environment Options</td>
  <td xml:lang="en-US">
Ensure that users are not able to override environment variables of the SSH daemon.
<br/>
The default SSH configuration disables environment processing. The appropriate
configuration is used if no value is set for <tt>PermitUserEnvironment</tt>.
<br/>
To explicitly disable Environment options, add or correct the following


<tt>/etc/ssh/sshd_config</tt>:

<pre>PermitUserEnvironment no</pre>
  </td>
  <td xml:lang="en-US">
SSH environment options potentially allow users to bypass
access restriction in some configurations.
  </td>
</tr>
<tr>
  <td>5.2.13</td>
  <td>Set SSH Idle Timeout Interval</td>
  <td xml:lang="en-US">
SSH allows administrators to set an idle timeout interval. After this interval
has passed, the idle user will be automatically logged out.
<br /><br />
To set an idle timeout interval, edit the following line in <tt>/etc/ssh/sshd_config</tt> as
follows:
<pre>ClientAliveInterval <b><abbr title="$sshd_idle_timeout_value"><tt>300</tt></abbr></b></pre>
<br/><br/>
The timeout <b>interval</b> is given in seconds. For example, have a timeout
of 10 minutes, set <b>interval</b> to 600.
<br /><br />
If a shorter timeout has already been set for the login shell, that value will
preempt any SSH setting made in <tt>/etc/ssh/sshd_config</tt>. Keep in mind that
some processes may stop SSH  from correctly detecting that the user is idle.
  </td>
  <td xml:lang="en-US">
Terminating an idle ssh session within a short time period reduces the window of
opportunity for unauthorized personnel to take control of a management session
enabled on the console or console port that has been let unattended.
  </td>
</tr>
<tr>
  <td>5.2.13</td>
  <td>Set SSH Client Alive Count Max</td>
  <td xml:lang="en-US">
The SSH server sends at most <tt>ClientAliveCountMax</tt> messages
during a SSH session and waits for a response from the SSH client.
The option <tt>ClientAliveInterval</tt> configures timeout after
each <tt>ClientAliveCountMax</tt> message. If the SSH server does not
receive a response from the client, then the connection is considered idle
and terminated.
For SSH earlier than v8.2, a <tt>ClientAliveCountMax</tt> value of <tt>0</tt>
causes an idle timeout precisely when the <tt>ClientAliveInterval</tt> is set.
Starting with v8.2, a value of <tt>0</tt> disables the timeout functionality
completely. If the option is set to a number greater than <tt>0</tt>, then
the idle session will be disconnected after
<tt>ClientAliveInterval * ClientAliveCountMax</tt> seconds.
  </td>
  <td xml:lang="en-US">
This ensures a user login will be terminated as soon as the <tt>ClientAliveInterval</tt>
is reached.
  </td>
</tr>
<tr>
  <td>5.2.13</td>
  <td>Set SSH Client Alive Count Max to zero</td>
  <td xml:lang="en-US">
The SSH server sends at most <tt>ClientAliveCountMax</tt> messages
during a SSH session and waits for a response from the SSH client.
The option <tt>ClientAliveInterval</tt> configures timeout after
each <tt>ClientAliveCountMax</tt> message. If the SSH server does not
receive a response from the client, then the connection is considered idle
and terminated.

To ensure the SSH idle timeout occurs precisely when the
<tt>ClientAliveInterval</tt> is set, set the <tt>ClientAliveCountMax</tt> to
value of <tt>0</tt> in


<tt>/etc/ssh/sshd_config</tt>:
  </td>
  <td xml:lang="en-US">
This ensures a user login will be terminated as soon as the <tt>ClientAliveInterval</tt>
is reached.
  </td>
</tr>
<tr>
  <td>5.2.14</td>
  <td>Ensure SSH LoginGraceTime is configured</td>
  <td xml:lang="en-US">
The <tt>LoginGraceTime</tt> parameter to the SSH server specifies the time allowed for successful authentication to
the SSH server. The longer the Grace period is the more open unauthenticated connections
can exist. Like other session controls in this session the Grace Period should be limited to
appropriate limits to ensure the service is available for needed access.
  </td>
  <td xml:lang="en-US">
Setting the <tt>LoginGraceTime</tt> parameter to a low number will minimize the risk of successful
brute force attacks to the SSH server. It will also limit the number of concurrent
unauthenticated connections.
  </td>
</tr>
<tr>
  <td>5.2.15</td>
  <td>Enable SSH Warning Banner</td>
  <td xml:lang="en-US">
To enable the warning banner and ensure it is consistent
across the system, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>Banner /etc/issue</pre>
Another section contains information on how to create an
appropriate system-wide warning banner.
  </td>
  <td xml:lang="en-US">
The warning message reinforces policy awareness during the logon process and
facilitates possible legal action against attackers. Alternatively, systems
whose ownership should not be obvious should ensure usage of a banner that does
not provide easy attribution.
  </td>
</tr>
<tr>
  <td>5.2.16</td>
  <td>Enable PAM</td>
  <td xml:lang="en-US">
UsePAM Enables the Pluggable Authentication Module interface. If set to yes this will
enable PAM authentication using ChallengeResponseAuthentication and
PasswordAuthentication in addition to PAM account and session module processing for all
authentication types.

To enable PAM authentication, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>UsePAM yes</pre>
  </td>
  <td xml:lang="en-US">
When UsePAM is set to yes, PAM runs through account and session types properly. This is
important if you want to restrict access to services based off of IP, time or other factors of
the account. Additionally, you can make sure users inherit certain environment variables
on login or disallow access to the server.
  </td>
</tr>
<tr>
  <td>5.2.17</td>
  <td>Disable SSH TCP Forwarding</td>
  <td xml:lang="en-US">
The <tt>AllowTcpForwarding</tt> parameter specifies whether TCP forwarding is permitted.
To disable TCP forwarding, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>AllowTcpForwarding no</pre>
  </td>
  <td xml:lang="en-US">
Leaving port forwarding enabled can expose the organization to security risks and back-doors.
  </td>
</tr>
<tr>
  <td>5.2.18</td>
  <td>Ensure SSH MaxStartups is configured</td>
  <td xml:lang="en-US">
The MaxStartups parameter specifies the maximum number of concurrent
unauthenticated connections to the SSH daemon. Additional connections will be
dropped until authentication succeeds or the LoginGraceTime expires for a
connection. To confgure MaxStartups, you should add or correct the following
line in the
<tt>/etc/ssh/sshd_config</tt> file:
<pre>MaxStartups <abbr title="$var_sshd_set_maxstartups"><tt>10:30:100</tt></abbr></pre>
CIS recommends a MaxStartups value of '10:30:60', or more restrictive where
dictated by site policy.
  </td>
  <td xml:lang="en-US">
To protect a system from denial of service due to a large number of pending
authentication connection attempts, use the rate limiting function of MaxStartups
to protect availability of sshd logins and prevent overwhelming the daemon.
  </td>
</tr>
<tr>
  <td>5.2.19</td>
  <td>Set SSH MaxSessions limit</td>
  <td xml:lang="en-US">
The <tt>MaxSessions</tt> parameter specifies the maximum number of open sessions permitted
from a given connection. To set MaxSessions edit
<tt>/etc/ssh/sshd_config</tt> as follows: <pre>MaxSessions <abbr title="$var_sshd_max_sessions"><tt>10</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
To protect a system from denial of service due to a large number of concurrent
sessions, use the rate limiting function of MaxSessions to protect availability
of sshd logins and prevent overwhelming the daemon.
  </td>
</tr>
<tr>
  <td>5.2.20</td>
  <td>Configure SSH to use System Crypto Policy</td>
  <td xml:lang="en-US">
Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
SSH is supported by crypto policy, but the SSH configuration may be
set up to ignore it.
To check that Crypto Policies settings are configured correctly, ensure that
the <tt>CRYPTO_POLICY</tt> variable is either commented or not set at all
in the <tt>/etc/sysconfig/sshd</tt>.
  </td>
  <td xml:lang="en-US">
Overriding the system crypto policy makes the behavior of the SSH service violate expectations,
and makes system configuration more fragmented.
  </td>
</tr>
<tr>
  <td>5.3.3<br/>5.4.2</td>
  <td>Lock Accounts After Failed Password Attempts</td>
  <td xml:lang="en-US">
This rule configures the system to lock out accounts after a number of incorrect login attempts
using <tt>pam_faillock.so</tt>.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid any errors when manually editing these files,
it is recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.
  </td>
  <td xml:lang="en-US">
Locking out user accounts after a number of incorrect attempts prevents direct password
guessing attacks. In combination with the <tt>silent</tt> option, user enumeration attacks
are also mitigated.
  </td>
</tr>
<tr>
  <td>5.4.1</td>
  <td>Ensure PAM Enforces Password Requirements - Minimum Length</td>
  <td xml:lang="en-US">
The pam_pwquality module's <tt>minlen</tt> parameter controls requirements for
minimum characters required in a password. Add <tt>minlen=<abbr title="$var_password_pam_minlen"><tt>15</tt></abbr></tt>
after pam_pwquality to set minimum password length requirements.
  </td>
  <td xml:lang="en-US">
The shorter the password, the lower the number of possible combinations
that need to be tested before the password is compromised.
<br />
Password complexity, or strength, is a measure of the effectiveness of a
password in resisting attempts at guessing and brute-force attacks.
Password length is one factor of several that helps to determine strength
and how long it takes to crack a password. Use of more characters in a password
helps to exponentially increase the time and/or resources required to
compromose the password.
  </td>
</tr>
<tr>
  <td>5.4.1</td>
  <td>Ensure PAM Enforces Password Requirements - Minimum Different Categories</td>
  <td xml:lang="en-US">
The pam_pwquality module's <tt>minclass</tt> parameter controls
requirements for usage of different character classes, or types, of character
that must exist in a password before it is considered valid. For example,
setting this value to three (3) requires that any password must have characters
from at least three different categories in order to be approved. The default
value is zero (0), meaning there are no required classes. There are four
categories available:
<pre>
* Upper-case characters
* Lower-case characters
* Digits
* Special characters (for example, punctuation)
</pre>
Modify the <tt>minclass</tt> setting in <tt>/etc/security/pwquality.conf</tt> entry
to require <abbr title="$var_password_pam_minclass"><tt>3</tt></abbr>
differing categories of characters when changing passwords.
  </td>
  <td xml:lang="en-US">
Use of a complex password helps to increase the time and resources required to compromise the password.
Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts
at guessing and brute-force attacks.
<br /><br />
Password complexity is one factor of several that determines how long it takes to crack a password. The
more complex the password, the greater the number of possible combinations that need to be tested before
the password is compromised.
<br /><br />
Requiring a minimum number of character categories makes password guessing attacks more difficult
by ensuring a larger search space.
  </td>
</tr>
<tr>
  <td>5.4.1</td>
  <td>Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session</td>
  <td xml:lang="en-US">
To configure the number of retry prompts that are permitted per-session:

Edit the <tt>/etc/security/pwquality.conf</tt> to include

<tt>retry=<abbr title="$var_password_pam_retry"><tt>3</tt></abbr></tt>, or a lower value if site
policy is more restrictive. The DoD requirement is a maximum of 3 prompts
per session.
  </td>
  <td xml:lang="en-US">
Setting the password retry prompts that are permitted on a per-session basis to a low value
requires some software, such as SSH, to re-connect. This can slow down and
draw additional attention to some types of password-guessing attacks. Note that this
is different from account lockout, which is provided by the pam_faillock module.
  </td>
</tr>
<tr>
  <td>5.4.2</td>
  <td>Set Lockout Time for Failed Password Attempts</td>
  <td xml:lang="en-US">
This rule configures the system to lock out accounts during a specified time period after a
number of incorrect login attempts using <tt>pam_faillock.so</tt>.

pam_faillock.so module requires multiple entries in pam files. These entries must be carefully
defined to work as expected. In order to avoid any errors when manually editing these files,
it is recommended to use the appropriate tools, such as <tt>authselect</tt> or <tt>authconfig</tt>,
depending on the OS version.
  </td>
  <td xml:lang="en-US">
Locking out user accounts after a number of incorrect attempts prevents direct password
guessing attacks. Ensuring that an administrator is involved in unlocking locked accounts
draws appropriate attention to such situations.
  </td>
</tr>
<tr>
  <td>5.4.3</td>
  <td>Limit Password Reuse: password-auth</td>
  <td xml:lang="en-US">
Do not allow users to reuse recent passwords. This can be
accomplished by using the <tt>remember</tt> option for the
<tt>pam_pwhistory</tt> PAM modules.
<br /><br />
In the file <tt>/etc/pam.d/password-auth</tt>, make sure the parameter
<tt>remember</tt> is present, and that the value
for the <tt>remember</tt> parameter is <abbr title="$var_password_pam_remember"><tt>5</tt></abbr> or greater. For example:
<pre>password <abbr title="$var_password_pam_remember_control_flag"><tt>requisite</tt></abbr> pam_pwhistory.so <i>...existing_options...</i> remember=<abbr title="$var_password_pam_remember"><tt>5</tt></abbr> use_authtok</pre>
The DoD STIG requirement is 5 passwords.
  </td>
  <td xml:lang="en-US">
Preventing re-use of previous passwords helps ensure that a compromised password is not re-used by a user.
  </td>
</tr>
<tr>
  <td>5.4.3</td>
  <td>Limit Password Reuse</td>
  <td xml:lang="en-US">
Do not allow users to reuse recent passwords. This can be
accomplished by using the <tt>remember</tt> option for the <tt>pam_unix</tt>
or <tt>pam_pwhistory</tt> PAM modules.
<br /><br />
In the file <tt>/etc/pam.d/system-auth</tt>, append <tt>remember=<abbr title="$var_password_pam_unix_remember"><tt>5</tt></abbr></tt>
to the line which refers to the <tt>pam_unix.so</tt> or <tt>pam_pwhistory.so</tt>module, as shown below:
<ul>
<li>for the <tt>pam_unix.so</tt> case:
<pre>password sufficient pam_unix.so <i>...existing_options...</i> remember=<abbr title="$var_password_pam_unix_remember"><tt>5</tt></abbr></pre>
</li>
<li>for the <tt>pam_pwhistory.so</tt> case:
<pre>password requisite pam_pwhistory.so <i>...existing_options...</i> remember=<abbr title="$var_password_pam_unix_remember"><tt>5</tt></abbr></pre>
</li>
</ul>
The DoD STIG requirement is 5 passwords.
  </td>
  <td xml:lang="en-US">
Preventing re-use of previous passwords helps ensure that a compromised password is not re-used by a user.
  </td>
</tr>
<tr>
  <td>5.4.3</td>
  <td>Limit Password Reuse: system-auth</td>
  <td xml:lang="en-US">
Do not allow users to reuse recent passwords. This can be
accomplished by using the <tt>remember</tt> option for the
<tt>pam_pwhistory</tt> PAM modules.
<br /><br />
In the file <tt>/etc/pam.d/system-auth</tt>, make sure the parameter
<tt>remember</tt> is present, and that the value
for the <tt>remember</tt> parameter is <abbr title="$var_password_pam_remember"><tt>5</tt></abbr> or greater. For example:
<pre>password <abbr title="$var_password_pam_remember_control_flag"><tt>requisite</tt></abbr> pam_pwhistory.so <i>...existing_options...</i> remember=<abbr title="$var_password_pam_remember"><tt>5</tt></abbr> use_authtok</pre>
The DoD STIG requirement is 5 passwords.
  </td>
  <td xml:lang="en-US">
Preventing re-use of previous passwords helps ensure that a compromised password is not re-used by a user.
  </td>
</tr>
<tr>
  <td>5.4.4</td>
  <td>Set PAM's Password Hashing Algorithm</td>
  <td xml:lang="en-US">
The PAM system service can be configured to only store encrypted
representations of passwords. In

<tt>/etc/pam.d/system-auth</tt>,

the
<tt>password</tt> section of the file controls which PAM modules execute
during a password change. Set the <tt>pam_unix.so</tt> module in the
<tt>password</tt> section to include the argument <tt>sha512</tt>, as shown
below:
<br />

<pre>password    sufficient    pam_unix.so sha512 <i>other arguments...</i></pre>

<br />
This will help ensure when local users change their passwords, hashes for
the new passwords will be generated using the SHA-512 algorithm. This is
the default.
  </td>
  <td xml:lang="en-US">
Passwords need to be protected at all times, and encryption is the standard
method for protecting passwords. If passwords are not encrypted, they can
be plainly read (i.e., clear text) and easily compromised. Passwords that
are encrypted with a weak algorithm are no more protected than if they are
kepy in plain text.
<br /><br />
This setting ensures user and group account administration utilities are
configured to store only encrypted representations of passwords.
Additionally, the <tt>crypt_style</tt> configuration option ensures the use
of a strong hashing algorithm that makes password cracking attacks more
difficult.
  </td>
</tr>
<tr>
  <td>5.4.4</td>
  <td>Set PAM's Password Hashing Algorithm - password-auth</td>
  <td xml:lang="en-US">
The PAM system service can be configured to only store encrypted
representations of passwords. In
<tt>/etc/pam.d/password-auth</tt>,
the
<tt>password</tt> section of the file controls which PAM modules execute
during a password change. Set the <tt>pam_unix.so</tt> module in the
<tt>password</tt> section to include the argument <tt>sha512</tt>, as shown
below:
<br />
<pre>password    sufficient    pam_unix.so sha512 <i>other arguments...</i></pre>
<br />
This will help ensure when local users change their passwords, hashes for
the new passwords will be generated using the SHA-512 algorithm. This is
the default.
  </td>
  <td xml:lang="en-US">
Passwords need to be protected at all times, and encryption is the standard
method for protecting passwords. If passwords are not encrypted, they can
be plainly read (i.e., clear text) and easily compromised. Passwords that
are encrypted with a weak algorithm are no more protected than if they are
kepy in plain text.
<br /><br />
This setting ensures user and group account administration utilities are
configured to store only encrypted representations of passwords.
Additionally, the <tt>crypt_style</tt> configuration option ensures the use
of a strong hashing algorithm that makes password cracking attacks more
difficult.
  </td>
</tr>
<tr>
  <td>5.5.1.1</td>
  <td>Set Existing Passwords Maximum Age</td>
  <td xml:lang="en-US">
Configure non-compliant accounts to enforce a 60-day maximum password lifetime
restriction by running the following command:
<pre>$ sudo chage -M 60 <i>USER</i></pre>
  </td>
  <td xml:lang="en-US">
Any password, no matter how complex, can eventually be cracked. Therefore,
passwords need to be changed periodically. If the operating system does
not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.
  </td>
</tr>
<tr>
  <td>5.5.1.1</td>
  <td>Set Password Maximum Age</td>
  <td xml:lang="en-US">
To specify password maximum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MAX_DAYS <abbr title="$var_accounts_maximum_age_login_defs"><tt>60</tt></abbr></pre>
A value of 180 days is sufficient for many environments.
The DoD requirement is 60.
The profile requirement is <tt><abbr title="$var_accounts_maximum_age_login_defs"><tt>60</tt></abbr></tt>.
  </td>
  <td xml:lang="en-US">
Any password, no matter how complex, can eventually be cracked. Therefore, passwords
need to be changed periodically. If the operating system does not limit the lifetime
of passwords and force users to change their passwords, there is the risk that the
operating system passwords could be compromised.
<br /><br />
Setting the password maximum age ensures users are required to
periodically change their passwords. Requiring shorter password lifetimes
increases the risk of users writing down the password in a convenient
location subject to physical compromise.
  </td>
</tr>
<tr>
  <td>5.5.1.2</td>
  <td>Set Password Minimum Age</td>
  <td xml:lang="en-US">
To specify password minimum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MIN_DAYS <abbr title="$var_accounts_minimum_age_login_defs"><tt>7</tt></abbr></pre>
A value of 1 day is considered sufficient for many
environments. The DoD requirement is 1.
The profile requirement is <tt><abbr title="$var_accounts_minimum_age_login_defs"><tt>7</tt></abbr></tt>.
  </td>
  <td xml:lang="en-US">
Enforcing a minimum password lifetime helps to prevent repeated password
changes to defeat the password reuse or history enforcement requirement. If
users are allowed to immediately and continually change their password,
then the password could be repeatedly changed in a short period of time to
defeat the organization's policy regarding password reuse.
<br /><br />
Setting the minimum password age protects against users cycling back to a
favorite password after satisfying the password reuse requirement.
  </td>
</tr>
<tr>
  <td>5.5.1.2</td>
  <td>Set Existing Passwords Minimum Age</td>
  <td xml:lang="en-US">
Configure non-compliant accounts to enforce a 24 hours/1 day minimum password
lifetime by running the following command:
<pre>$ sudo chage -m 1 <i>USER</i></pre>
  </td>
  <td xml:lang="en-US">
Enforcing a minimum password lifetime helps to prevent repeated password
changes to defeat the password reuse or history enforcement requirement. If
users are allowed to immediately and continually change their password, the
password could be repeatedly changed in a short period of time to defeat the
organization's policy regarding password reuse.
  </td>
</tr>
<tr>
  <td>5.5.1.3</td>
  <td>Set Password Warning Age</td>
  <td xml:lang="en-US">
To specify how many days prior to password
expiration that a warning will be issued to users,
edit the file <tt>/etc/login.defs</tt> and add or correct
 the following line:
<pre>PASS_WARN_AGE <abbr title="$var_accounts_password_warn_age_login_defs"><tt>7</tt></abbr></pre>
The DoD requirement is 7.
The profile requirement is <tt><abbr title="$var_accounts_password_warn_age_login_defs"><tt>7</tt></abbr></tt>.
  </td>
  <td xml:lang="en-US">
Setting the password warning age enables users to
make the change at a practical time.
  </td>
</tr>
<tr>
  <td>5.5.1.4</td>
  <td>Set Account Expiration Following Inactivity</td>
  <td xml:lang="en-US">
To specify the number of days after a password expires (which
signifies inactivity) until an account is permanently disabled, add or correct
the following line in <tt>/etc/default/useradd</tt>:
<pre>INACTIVE=<i><abbr title="$var_account_disable_post_pw_expiration"><tt>35</tt></abbr></i></pre>
If a password is currently on the verge of expiration, then
<tt><abbr title="$var_account_disable_post_pw_expiration"><tt>35</tt></abbr></tt>
day(s) remain(s) until the account is automatically
disabled. However, if the password will not expire for another 60 days, then 60
days plus <tt><abbr title="$var_account_disable_post_pw_expiration"><tt>35</tt></abbr></tt> day(s) could
elapse until the account would be automatically disabled. See the
<tt>useradd</tt> man page for more information.
  </td>
  <td xml:lang="en-US">
Disabling inactive accounts ensures that accounts which may not
have been responsibly removed are not available to attackers
who may have compromised their credentials.
  </td>
</tr>
<tr>
  <td>5.5.2</td>
  <td>Ensure that System Accounts Do Not Run a Shell Upon Login</td>
  <td xml:lang="en-US">
Some accounts are not associated with a human user of the system, and exist to
perform some administrative function. Should an attacker be able to log into
these accounts, they should not be granted access to a shell.
<br /><br />
The login shell for each local account is stored in the last field of each line
in <tt>/etc/passwd</tt>. System accounts are those user accounts with a user ID
less than UID_MIN, where value of UID_MIN directive is set in
/etc/login.defs configuration file. In the default configuration UID_MIN is set
to 1000, thus system accounts are those user accounts with a user ID less than
1000. The user ID is stored in the third field. If any system account
<i>SYSACCT</i> (other than root) has a login shell, disable it with the
command: <pre>$ sudo usermod -s /sbin/nologin <i>SYSACCT</i></pre>
  </td>
  <td xml:lang="en-US">
Ensuring shells are not given to system accounts upon login makes it more
difficult for attackers to make use of system accounts.
  </td>
</tr>
<tr>
  <td>5.5.3</td>
  <td>Set Interactive Session Timeout</td>
  <td xml:lang="en-US">
Setting the <tt>TMOUT</tt> option in <tt>/etc/profile</tt> ensures that
all user sessions will terminate based on inactivity. The <tt>TMOUT</tt>

setting in a file loaded by <tt>/etc/profile</tt>, e.g.
<tt>/etc/profile.d/tmout.sh</tt> should read as follows:
<pre>TMOUT=<abbr title="$var_accounts_tmout"><tt>600</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
Terminating an idle session within a short time period reduces
the window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been
left unattended.
  </td>
</tr>
<tr>
  <td>5.5.4</td>
  <td>Ensure the Default Bash Umask is Set Correctly</td>
  <td xml:lang="en-US">
To ensure the default umask for users of the Bash shell is set properly,
add or correct the <tt>umask</tt> setting in <tt>/etc/bashrc</tt> to read
as follows:
<pre>umask <abbr title="$var_accounts_user_umask"><tt>027</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.
  </td>
</tr>
<tr>
  <td>5.5.4</td>
  <td>Ensure the Default Umask is Set Correctly in /etc/profile</td>
  <td xml:lang="en-US">
To ensure the default umask controlled by <tt>/etc/profile</tt> is set properly,
add or correct the <tt>umask</tt> setting in <tt>/etc/profile</tt> to read as follows:
<pre>umask <abbr title="$var_accounts_user_umask"><tt>027</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.
  </td>
</tr>
<tr>
  <td>5.5.4</td>
  <td>Verify Root Has A Primary GID 0</td>
  <td xml:lang="en-US">
The <tt>root</tt> user should have a primary group of 0.
  </td>
  <td xml:lang="en-US">
To help ensure that root-owned files are not inadvertently exposed to other users.
  </td>
</tr>
<tr>
  <td>5.5.5</td>
  <td>Ensure the Default Umask is Set Correctly in login.defs</td>
  <td xml:lang="en-US">
To ensure the default umask controlled by <tt>/etc/login.defs</tt> is set properly,
add or correct the <tt>UMASK</tt> setting in <tt>/etc/login.defs</tt> to read as follows:
<pre>UMASK <abbr title="$var_accounts_user_umask"><tt>027</tt></abbr></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read and
written to by unauthorized users.
  </td>
</tr>
<tr>
  <td>5.6</td>
  <td>Restrict Virtual Console Root Logins</td>
  <td xml:lang="en-US">
To restrict root logins through the (deprecated) virtual console devices,
ensure lines of this form do not appear in <tt>/etc/securetty</tt>:
<pre>vc/1
vc/2
vc/3
vc/4</pre>
  </td>
  <td xml:lang="en-US">
Preventing direct root login to virtual console devices
helps ensure accountability for actions taken on the system
using the root account.
  </td>
</tr>
<tr>
  <td>5.6</td>
  <td>Direct root Logins Not Allowed</td>
  <td xml:lang="en-US">
To further limit access to the <tt>root</tt> account, administrators
can disable root logins at the console by editing the <tt>/etc/securetty</tt> file.
This file lists all devices the root user is allowed to login to. If the file does
not exist at all, the root user can login through any communication device on the
system, whether via the console or via a raw network interface. This is dangerous
as user can login to the system as root via Telnet, which sends the password in
plain text over the network. By default, Red Hat Enterprise Linux 8's
<tt>/etc/securetty</tt> file only allows the root user to login at the console
physically attached to the system. To prevent root from logging in, remove the
contents of this file. To prevent direct root logins, remove the contents of this
file by typing the following command:
<pre>
$ sudo echo &gt; /etc/securetty
</pre>
  </td>
  <td xml:lang="en-US">
Disabling direct root logins ensures proper accountability and multifactor
authentication to privileged accounts. Users will first login, then escalate
to privileged (root) access via su / sudo. This is required for FISMA Low
and FISMA Moderate systems.
  </td>
</tr>
<tr>
  <td>5.7</td>
  <td>Enforce usage of pam_wheel for su authentication</td>
  <td xml:lang="en-US">
To ensure that only users who are members of the <tt>wheel</tt> group can
run commands with altered privileges through the <tt>su</tt> command, make
sure that the following line exists in the file <tt>/etc/pam.d/su</tt>:
<pre>auth             required        pam_wheel.so use_uid</pre>
  </td>
  <td xml:lang="en-US">
The <tt>su</tt> program allows to run commands with a substitute user and
group ID. It is commonly used to run commands as the root user. Limiting
access to such command is considered a good security practice.
  </td>
</tr>
<tr>
  <td>6.1.1</td>
  <td>Verify File Hashes with RPM</td>
  <td xml:lang="en-US">
Without cryptographic integrity protections, system
executables and files can be altered by unauthorized users without
detection.
The RPM package management system can check the hashes of
installed software packages, including many that are important to system
security.
To verify that the cryptographic hash of system files and commands matches vendor
values, run the following command to list which files on the system
have hashes that differ from what is expected by the RPM database:
<pre>$ rpm -Va --noconfig | grep '^..5'</pre>
A "c" in the second column indicates that a file is a configuration file, which
may appropriately be expected to change. If the file was not expected to
change, investigate the cause of the change using audit logs or other means.
The package can then be reinstalled to restore the file.
Run the following command to determine which package owns the file:
<pre>$ rpm -qf <i>FILENAME</i></pre>
The package can be reinstalled from a yum repository using the command:
<pre>$ sudo yum reinstall <i>PACKAGENAME</i></pre>
Alternatively, the package can be reinstalled from trusted media using the command:
<pre>$ sudo rpm -Uvh <i>PACKAGENAME</i></pre>
  </td>
  <td xml:lang="en-US">
The hashes of important files like system executables should match the
information given by the RPM database. Executables with erroneous hashes could
be a sign of nefarious activity on the system.
  </td>
</tr>
<tr>
  <td>6.1.2</td>
  <td>Verify Permissions on passwd File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/passwd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/passwd</pre>
  </td>
  <td xml:lang="en-US">
If the <tt>/etc/passwd</tt> file is writable by a group-owner or the
world the risk of its compromise is increased. The file contains the list of
accounts on the system and associated information, and protection of this file
is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.2</td>
  <td>Verify User Who Owns passwd File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/passwd</code>, run the command: <pre>$ sudo chown root /etc/passwd </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/passwd</tt> file contains information about the users that are configured on
the system. Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.2</td>
  <td>Verify Group Who Owns passwd File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/passwd</code>, run the command: <pre>$ sudo chgrp root /etc/passwd</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/passwd</tt> file contains information about the users that are configured on
the system. Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.3</td>
  <td>Verify User Who Owns Backup passwd File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/passwd-</code>, run the command: <pre>$ sudo chown root /etc/passwd- </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/passwd-</tt> file is a backup file of <tt>/etc/passwd</tt>, and as such,
it contains information about the users that are configured on the system.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.3</td>
  <td>Verify Group Who Owns Backup passwd File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/passwd-</code>, run the command: <pre>$ sudo chgrp root /etc/passwd-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/passwd-</tt> file is a backup file of <tt>/etc/passwd</tt>, and as such,
it contains information about the users that are configured on the system.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.3</td>
  <td>Verify Permissions on Backup passwd File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/passwd-</code>, run the command:
<pre>$ sudo chmod 0644 /etc/passwd-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/passwd-</tt> file is a backup file of <tt>/etc/passwd</tt>, and as such,
it contains information about the users that are configured on the system.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.4</td>
  <td>Verify User Who Owns shadow File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/shadow</code>, run the command: <pre>$ sudo chown root /etc/shadow </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow</tt> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.
  </td>
</tr>
<tr>
  <td>6.1.4</td>
  <td>Verify Permissions on shadow File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/shadow</code>, run the command:
<pre>$ sudo chmod 0000 /etc/shadow</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow</tt> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.
  </td>
</tr>
<tr>
  <td>6.1.4</td>
  <td>Verify Group Who Owns shadow File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/shadow</code>, run the command: <pre>$ sudo chgrp root /etc/shadow</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow</tt> file stores password hashes. Protection of this file is
critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.5</td>
  <td>Verify Group Who Owns Backup shadow File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/shadow-</code>, run the command: <pre>$ sudo chown root /etc/shadow- </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow-</tt> file is a backup file of <tt>/etc/shadow</tt>, and as such,
it contains the list of local system accounts and password hashes.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.5</td>
  <td>Verify User Who Owns Backup shadow File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/shadow-</code>, run the command: <pre>$ sudo chgrp root /etc/shadow-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow-</tt> file is a backup file of <tt>/etc/shadow</tt>, and as such,
it contains the list of local system accounts and password hashes.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.5</td>
  <td>Verify Permissions on Backup shadow File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/shadow-</code>, run the command:
<pre>$ sudo chmod 0000 /etc/shadow-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/shadow-</tt> file is a backup file of <tt>/etc/shadow</tt>, and as such,
it contains the list of local system accounts and password hashes.
Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.6</td>
  <td>Verify Group Who Owns gshadow File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/gshadow</code>, run the command: <pre>$ sudo chgrp root /etc/gshadow</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow</tt> file contains group password hashes. Protection of this file
is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.6</td>
  <td>Verify Permissions on gshadow File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/gshadow</code>, run the command:
<pre>$ sudo chmod 0000 /etc/gshadow</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow</tt> file contains group password hashes. Protection of this file
is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.6</td>
  <td>Verify User Who Owns gshadow File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/gshadow</code>, run the command: <pre>$ sudo chown root /etc/gshadow </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow</tt> file contains group password hashes. Protection of this file
is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.7</td>
  <td>Verify User Who Owns Backup gshadow File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/gshadow-</code>, run the command: <pre>$ sudo chown root /etc/gshadow- </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow-</tt> file is a backup of <tt>/etc/gshadow</tt>, and as such,
it contains group password hashes. Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.7</td>
  <td>Verify Permissions on Backup gshadow File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/gshadow-</code>, run the command:
<pre>$ sudo chmod 0000 /etc/gshadow-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow-</tt> file is a backup of <tt>/etc/gshadow</tt>, and as such,
it contains group password hashes. Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.7</td>
  <td>Verify Group Who Owns Backup gshadow File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/gshadow-</code>, run the command: <pre>$ sudo chgrp root /etc/gshadow-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/gshadow-</tt> file is a backup of <tt>/etc/gshadow</tt>, and as such,
it contains group password hashes. Protection of this file is critical for system security.
  </td>
</tr>
<tr>
  <td>6.1.8</td>
  <td>Verify Group Who Owns group File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/group</code>, run the command: <pre>$ sudo chgrp root /etc/group</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group</tt> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.8</td>
  <td>Verify User Who Owns group File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/group</code>, run the command: <pre>$ sudo chown root /etc/group </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group</tt> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.8</td>
  <td>Verify Permissions on group File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/passwd</code>, run the command:
<pre>$ sudo chmod 0644 /etc/passwd</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group</tt> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.9</td>
  <td>Verify Permissions on Backup group File</td>
  <td xml:lang="en-US">

To properly set the permissions of <code>/etc/group-</code>, run the command:
<pre>$ sudo chmod 0644 /etc/group-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group-</tt> file is a backup file of <tt>/etc/group</tt>, and as such,
it contains information regarding groups that are configured on the system.
Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.9</td>
  <td>Verify Group Who Owns Backup group File</td>
  <td xml:lang="en-US">
 To properly set the group owner of <code>/etc/group-</code>, run the command: <pre>$ sudo chgrp root /etc/group-</pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group-</tt> file is a backup file of <tt>/etc/group</tt>, and as such,
it contains information regarding groups that are configured on the system.
Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.9</td>
  <td>Verify User Who Owns Backup group File</td>
  <td xml:lang="en-US">
 To properly set the owner of <code>/etc/group-</code>, run the command: <pre>$ sudo chown root /etc/group- </pre>
  </td>
  <td xml:lang="en-US">
The <tt>/etc/group-</tt> file is a backup file of <tt>/etc/group</tt>, and as such,
it contains information regarding groups that are configured on the system.
Protection of this file is important for system security.
  </td>
</tr>
<tr>
  <td>6.1.10</td>
  <td>Ensure No World-Writable Files Exist</td>
  <td xml:lang="en-US">
It is generally a good idea to remove global (other) write
access to a file when it is discovered. However, check with
documentation for specific applications before making changes.
Also, monitor for recurring world-writable files, as these may be
symptoms of a misconfigured application or user account. Finally,
this applies to real files and not virtual files that are a part of
pseudo file systems such as <tt>sysfs</tt> or <tt>procfs</tt>.
  </td>
  <td xml:lang="en-US">
Data in world-writable files can be modified by any
user on the system. In almost all circumstances, files can be
configured using a combination of user and group permissions to
support whatever legitimate access is needed without the risk
caused by world-writable files.
  </td>
</tr>
<tr>
  <td>6.1.11</td>
  <td>Ensure All Files Are Owned by a User</td>
  <td xml:lang="en-US">
If any files are not owned by a user, then the
cause of their lack of ownership should be investigated.
Following this, the files should be deleted or assigned to an
appropriate user. The following command will discover and print
any files on local partitions which do not belong to a valid user:
<pre>$ df --local -P | awk {'if (NR!=1) print $6'} | sudo xargs -I '{}' find '{}' -xdev -nouser</pre>
To search all filesystems on a system including network mounted
filesystems the following command can be run manually for each partition:
<pre>$ sudo find PARTITION -xdev -nouser</pre>
  </td>
  <td xml:lang="en-US">
Unowned files do not directly imply a security problem, but they are generally
a sign that something is amiss. They may
be caused by an intruder, by incorrect software installation or
draft software removal, or by failure to remove all files belonging
to a deleted account. The files should be repaired so they
will not cause problems when accounts are created in the future,
and the cause should be discovered and addressed.
  </td>
</tr>
<tr>
  <td>6.1.12</td>
  <td>Ensure All Files Are Owned by a Group</td>
  <td xml:lang="en-US">
If any files are not owned by a group, then the
cause of their lack of group-ownership should be investigated.
Following this, the files should be deleted or assigned to an
appropriate group. The following command will discover and print
any files on local partitions which do not belong to a valid group:
<pre>$ df --local -P | awk '{if (NR!=1) print $6}' | sudo xargs -I '{}' find '{}' -xdev -nogroup</pre>
To search all filesystems on a system including network mounted
filesystems the following command can be run manually for each partition:
<pre>$ sudo find PARTITION -xdev -nogroup</pre>
  </td>
  <td xml:lang="en-US">
Unowned files do not directly imply a security problem, but they are generally
a sign that something is amiss. They may
be caused by an intruder, by incorrect software installation or
draft software removal, or by failure to remove all files belonging
to a deleted account. The files should be repaired so they
will not cause problems when accounts are created in the future,
and the cause should be discovered and addressed.
  </td>
</tr>
<tr>
  <td>6.1.13</td>
  <td>Ensure All SUID Executables Are Authorized</td>
  <td xml:lang="en-US">
The SUID (set user id) bit should be set only on files that were
installed via authorized means. A straightforward means of identifying
unauthorized SUID files is determine if any were not installed as part of an
RPM package, which is cryptographically verified. Investigate the origin
of any unpackaged SUID files.
This configuration check considers authorized SUID files which were installed via RPM.
It is assumed that when an individual has sudo access to install an RPM
and all packages are signed with an organizationally-recognized GPG key,
the software should be considered an approved package on the system.
Any SUID file not deployed through an RPM will be flagged for further review.
  </td>
  <td xml:lang="en-US">
Executable files with the SUID permission run with the privileges of
the owner of the file. SUID files of uncertain provenance could allow for
unprivileged users to elevate privileges. The presence of these files should be
strictly controlled on the system.
  </td>
</tr>
<tr>
  <td>6.1.14</td>
  <td>Ensure All SGID Executables Are Authorized</td>
  <td xml:lang="en-US">
The SGID (set group id) bit should be set only on files that were
installed via authorized means. A straightforward means of identifying
unauthorized SGID files is determine if any were not installed as part of an
RPM package, which is cryptographically verified. Investigate the origin
of any unpackaged SGID files.
This configuration check considers authorized SGID files which were installed via RPM.
It is assumed that when an individual has sudo access to install an RPM
and all packages are signed with an organizationally-recognized GPG key,
the software should be considered an approved package on the system.
Any SGID file not deployed through an RPM will be flagged for further review.
  </td>
  <td xml:lang="en-US">
Executable files with the SGID permission run with the privileges of
the owner of the file. SGID files of uncertain provenance could allow for
unprivileged users to elevate privileges. The presence of these files should be
strictly controlled on the system.
  </td>
</tr>
<tr>
  <td>6.2.2</td>
  <td>Ensure there are no legacy + NIS entries in /etc/passwd</td>
  <td xml:lang="en-US">
The <tt>+</tt> character in <tt>/etc/passwd</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.
  </td>
  <td xml:lang="en-US">
Using this method to include entries into <tt>/etc/passwd</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.
  </td>
</tr>
<tr>
  <td>6.2.3</td>
  <td>Ensure that Root's Path Does Not Include World or Group-Writable Directories</td>
  <td xml:lang="en-US">
For each element in root's path, run:
<pre># ls -ld <i>DIR</i></pre>
and ensure that write permissions are disabled for group and
other.
  </td>
  <td xml:lang="en-US">
Such entries increase the risk that root could
execute code provided by unprivileged users,
and potentially malicious code.
  </td>
</tr>
<tr>
  <td>6.2.3</td>
  <td>Ensure that Root's Path Does Not Include Relative Paths or Null Directories</td>
  <td xml:lang="en-US">
Ensure that none of the directories in root's path is equal to a single
<tt>.</tt> character, or
that it contains any instances that lead to relative path traversal, such as
<tt>..</tt> or beginning a path without the slash (<tt>/</tt>) character.
Also ensure that there are no "empty" elements in the path, such as in these examples:
<pre>PATH=:/bin
PATH=/bin:
PATH=/bin::/sbin</pre>
These empty elements have the same effect as a single <tt>.</tt> character.
  </td>
  <td xml:lang="en-US">
Including these entries increases the risk that root could
execute code from an untrusted location.
  </td>
</tr>
<tr>
  <td>6.2.4</td>
  <td>Ensure there are no legacy + NIS entries in /etc/shadow</td>
  <td xml:lang="en-US">
The <tt>+</tt> character in <tt>/etc/shadow</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.
  </td>
  <td xml:lang="en-US">
Using this method to include entries into <tt>/etc/shadow</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.
  </td>
</tr>
<tr>
  <td>6.2.5</td>
  <td>Ensure there are no legacy + NIS entries in /etc/group</td>
  <td xml:lang="en-US">
The <tt>+</tt> character in <tt>/etc/group</tt> file marks a place where
entries from a network information service (NIS) should be directly inserted.
  </td>
  <td xml:lang="en-US">
Using this method to include entries into <tt>/etc/group</tt> is considered legacy
and should be avoided. These entries may provide a way for an attacker
to gain access to the system.
  </td>
</tr>
<tr>
  <td>6.2.6</td>
  <td>Verify Only Root Has UID 0</td>
  <td xml:lang="en-US">
If any account other than root has a UID of 0, this misconfiguration should
be investigated and the accounts other than root should be removed or have
their UID changed.
<br />
If the account is associated with system commands or applications the UID
should be changed to one greater than "0" but less than "1000."
Otherwise assign a UID greater than "1000" that has not already been
assigned.
  </td>
  <td xml:lang="en-US">
An account has root authority if it has a UID of 0. Multiple accounts
with a UID of 0 afford more opportunity for potential intruders to
guess a password for a privileged account. Proper configuration of
sudo is recommended to afford multiple system administrators
access to root privileges in an accountable manner.
  </td>
</tr>
<tr>
  <td>6.2.7</td>
  <td>All Interactive User Home Directories Must Have mode 0750 Or Less Permissive</td>
  <td xml:lang="en-US">
Change the mode of interactive users home directories to <tt>0750</tt>. To
change the mode of interactive users home directory, use the
following command:
<pre>$ sudo chmod 0750 /home/<i>USER</i></pre>
  </td>
  <td xml:lang="en-US">
Excessive permissions on local interactive user home directories may allow
unauthorized access to user files by other users.
  </td>
</tr>
<tr>
  <td>6.2.7</td>
  <td>Ensure that User Home Directories are not Group-Writable or World-Readable</td>
  <td xml:lang="en-US">
For each human user of the system, view the
permissions of the user's home directory:
<pre># ls -ld /home/<i>USER</i></pre>
Ensure that the directory is not group-writable and that it
is not world-readable. If necessary, repair the permissions:
<pre># chmod g-w /home/<i>USER</i>
# chmod o-rwx /home/<i>USER</i></pre>
  </td>
  <td xml:lang="en-US">
User home directories contain many configuration files which
affect the behavior of a user's account. No user should ever have
write permission to another user's home directory. Group shared
directories can be configured in sub-directories or elsewhere in the
filesystem if they are needed. Typically, user home directories
should not be world-readable, as it would disclose file names
to other users. If a subset of users need read access
to one another's home directories, this can be provided using
groups or ACLs.
  </td>
</tr>
<tr>
  <td>6.2.8</td>
  <td>All User Files and Directories In The Home Directory Must Have a Valid Owner</td>
  <td xml:lang="en-US">
Either remove all files and directories from the system that
do not have a valid user, or assign a valid user to all unowned
files and directories. To assign a valid owner to a local
interactive user's files and directories, use the following command:
<pre>$ sudo chown -R <i>USER</i> /home/<i>USER</i></pre>

This rule ensures every file or directory under the home directory related
to an interactive user is owned by an interactive user.
  </td>
  <td xml:lang="en-US">
If local interactive users do not own the files in their directories,
unauthorized users may be able to access them. Additionally, if files are not
owned by the user, this could be an indication of system compromise.
  </td>
</tr>
<tr>
  <td>6.2.8</td>
  <td>All Interactive User Home Directories Must Be Group-Owned By The Primary User</td>
  <td xml:lang="en-US">
Change the group owner of interactive users home directory to the
group found in <tt>/etc/passwd</tt>. To change the group owner of
interactive users home directory, use the following command:
<pre>$ sudo chgrp <i>USER_GROUP</i> /home/<i>USER</i></pre>

This rule ensures every home directory related to an interactive user is
group-owned by an interactive user. It also ensures that interactive users
are group-owners of one and only one home directory.
  </td>
  <td xml:lang="en-US">
If the Group Identifier (GID) of a local interactive users home directory is
not the same as the primary GID of the user, this would allow unauthorized
access to the users files, and users that share the same group may not be
able to access files that they legitimately should.
  </td>
</tr>
<tr>
  <td>6.2.8</td>
  <td>All Interactive User Home Directories Must Be Owned By The Primary User</td>
  <td xml:lang="en-US">
Change the owner of interactive users home directories to that correct
owner. To change the owner of a interactive users home directory, use
the following command:
<pre>$ sudo chown <i>USER</i> /home/<i>USER</i></pre>

This rule ensures every home directory related to an interactive user is
owned by an interactive user. It also ensures that interactive users are
owners of one and only one home directory.
  </td>
  <td xml:lang="en-US">
If a local interactive user does not own their home directory, unauthorized
users could access or modify the user's files, and the users may not be able to
access their own files.
  </td>
</tr>
<tr>
  <td>6.2.11</td>
  <td>Verify No netrc Files Exist</td>
  <td xml:lang="en-US">
The <tt>.netrc</tt> files contain login information
used to auto-login into FTP servers and reside in the user's home
directory. These files may contain unencrypted passwords to
remote FTP servers making them susceptible to access by unauthorized
users and should not be used.  Any <tt>.netrc</tt> files should be removed.
  </td>
  <td xml:lang="en-US">
Unencrypted passwords for remote FTP servers may be stored in <tt>.netrc</tt>
files. 
  </td>
</tr>
<tr>
  <td>6.2.13</td>
  <td>Remove Rsh Trust Files</td>
  <td xml:lang="en-US">
The files <tt>/etc/hosts.equiv</tt> and <tt>~/.rhosts</tt> (in
each user's home directory) list remote hosts and users that are trusted by the
local system when using the rshd daemon.
To remove these files, run the following command to delete them from any
location:
<pre>$ sudo rm /etc/hosts.equiv</pre>
<pre>$ rm ~/.rhosts</pre>
  </td>
  <td xml:lang="en-US">
This action is only meaningful if <tt>.rhosts</tt> support is permitted
through PAM. Trust files are convenient, but when used in conjunction with
the R-services, they can allow unauthenticated access to a system.
  </td>
</tr>
<tr>
  <td>6.2.15</td>
  <td>Ensure All Accounts on the System Have Unique User IDs</td>
  <td xml:lang="en-US">
Change user IDs (UIDs), or delete accounts, so each has a unique name.
  </td>
  <td xml:lang="en-US">
To assure accountability and prevent unauthenticated access, interactive users must be identified and authenticated to prevent potential misuse and compromise of the system.
  </td>
</tr>
<tr>
  <td>6.2.16</td>
  <td>Ensure All Groups on the System Have Unique Group ID</td>
  <td xml:lang="en-US">
Change the group name or delete groups, so each has a unique id.
  </td>
  <td xml:lang="en-US">
To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.
  </td>
</tr>
<tr>
  <td>6.2.17</td>
  <td>Ensure All Accounts on the System Have Unique Names</td>
  <td xml:lang="en-US">
Ensure accounts on the system have unique names.

To ensure all accounts have unique names, run the following command:
<pre>$ sudo getent passwd | awk -F: '{ print $1}' | uniq -d</pre>
If a username is returned, change or delete the username.
  </td>
  <td xml:lang="en-US">
Unique usernames allow for accountability on the system.
  </td>
</tr>
<tr>
  <td>6.2.18</td>
  <td>Ensure All Groups on the System Have Unique Group Names</td>
  <td xml:lang="en-US">
Change the group name or delete groups, so each has a unique name.
  </td>
  <td xml:lang="en-US">
To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.
  </td>
</tr>
<tr>
  <td>6.2.20</td>
  <td>All Interactive Users Home Directories Must Exist</td>
  <td xml:lang="en-US">
Create home directories to all interactive users that currently do not
have a home directory assigned. Use the following commands to create the user
home directory assigned in <tt>/etc/passwd</tt>:
<pre>$ sudo mkdir /home/<i>USER</i></pre>
  </td>
  <td xml:lang="en-US">
If a local interactive user has a home directory defined that does not exist,
the user may be given access to the / directory as the current working directory
upon logon. This could create a Denial of Service because the user would not be
able to access their logon configuration files, and it may give them visibility
to system files they normally would not be able to access.
  </td>
</tr>
</table>

</body>
</html>