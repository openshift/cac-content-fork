<html xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Protection Profile for General Purpose Operating Systems</title>
</head>
<body>
	<br><br><div style="text-align: center; font-size: x-large; font-weight:bold">Protection Profile for General Purpose Operating Systems</div>
<br><br><style type="text/css">
		table
		{
			border-collapse:collapse;
		}
		table, th, td
		{
			border: 2px solid #dcdcdc;
			border-left: none;
			border-right: none;
			vertical-align: top;
			padding: 2px;
			font-family: verdana,arial,sans-serif;
			font-size:11px;
		}
		pre { 
			white-space: pre-wrap;
			white-space: -moz-pre-wrap !important;
			word-wrap:break-word; 
		}
		table tr:nth-child(2n+2) { background-color: #f4f4f4; }
		thead
		{
			display: table-header-group;
			font-weight: bold;
			background-color: #dedede;
		}
	</style>

<table>
<thead>
  <td>Mapping</td>
  <td>CCE</td>
  <td>Rule Title</td>
  <td>Description</td>
  <td>Rationale</td>
  <td>Variable Setting</td>
</thead>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful file accesses</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to access a file are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful file access (any other opens) This has to go last.
-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access
-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access    </pre>    

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to access a file might be signs of malicious activity happening within the system. Auditing of such activities helps in their monitoring and investigation.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful file accesses</td>
  <td xml:lang="en-US">
Ensure that successful attempts to access a file are audited.

The following rules configure audit as described above:
<pre>## Successful file access (any other opens) This has to go last.
## These next two are likely to result in a whole lot of events
-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-3-access-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-3-access-success.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing of successful attempts to access a file helps in investigation of activities performed on the system. 
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure basic parameters of Audit system</td>
  <td xml:lang="en-US">
Perform basic configuration of Audit system.
Make sure that any previously defined rules are cleared, the auditing system is configured to handle sudden bursts of events, and in cases of failure, messages are configured to be directed to system log.

The following rules configure audit as described above:
<pre>## First rule - delete all
-D

## Increase the buffers to survive stress events.
## Make this bigger for busy systems
-b 8192

## This determine how long to wait in burst of events
--backlog_wait_time 60000

## Set failure mode to syslog
-f 1
</pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/10-base-config.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/10-base-config.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>
  </td>
  <td xml:lang="en-US">
Without basic configurations, audit may not perform as expected. It may not be able to correctly handle events under stressful conditions, or log events in case of failure.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful file creations</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to create a file are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful file creation (open with O_CREAT)
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;0100 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;0100 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b32 -S open -F a1&amp;0100 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S open -F a1&amp;0100 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;0100 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;0100 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b32 -S open -F a1&amp;0100 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S open -F a1&amp;0100 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create
-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-create    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-1-create-failed.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-1-create-failed.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful file creations might be a sign of a malicious action being performed on the system. Keeping log of such events helps in monitoring and investigation of such actions.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful file creations</td>
  <td xml:lang="en-US">
Ensure that successful attempts to create a file are audited.

The following rules configure audit as described above:
<pre>## Successful file creation (open with O_CREAT)
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;0100 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;0100 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create
-a always,exit -F arch=b32 -S open -F a1&amp;0100 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create
-a always,exit -F arch=b64 -S open -F a1&amp;0100 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create
-a always,exit -F arch=b32 -S creat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create
-a always,exit -F arch=b64 -S creat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-create    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-1-create-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-1-create-success.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>
  </td>
  <td xml:lang="en-US">
Auditing of successful attempts to create a file helps in investigation of actions which happened on the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful file deletions</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to delete a file are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful file delete
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-delete
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-delete
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-delete
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-delete    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-4-delete-failed.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-4-delete-failed.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to delete a file might be signs of malicious activities. Auditing of such events help in monitoring and investigating of such activities. 
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful file deletions</td>
  <td xml:lang="en-US">
Ensure that successful attempts to delete a file are audited.

The following rules configure audit as described above:
<pre>## Successful file delete
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-delete
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-delete    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-4-delete-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-4-delete-success.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing of successful attempts to delete a file may help in monitoring and investigation of activities performed on the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure immutable Audit login UIDs</td>
  <td xml:lang="en-US">
Configure kernel to prevent modification of login UIDs once they are set.
Changing login UIDs while this configuration is enforced requires special capabilities which are not available to unprivileged users.

The following rules configure audit as described above:
<pre>## Make the loginuid immutable. This prevents tampering with the auid.
--loginuid-immutable
</pre>

The <tt>Audit</tt> provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/11-loginuid.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/11-loginuid.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>
  </td>
  <td xml:lang="en-US">
If modification of login UIDs is not prevented, they can be changed by unprivileged users and make auditing complicated or impossible. 
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful file modifications</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to modify a file are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful file modifications (open for write or truncate)
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;01003 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;01003 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b32 -S open -F a1&amp;01003 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S open -F a1&amp;01003 -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;01003 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;01003 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b32 -S open -F a1&amp;01003 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S open -F a1&amp;01003 -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification
-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-modification    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-2-modify-failed.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-2-modify-failed.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful file modifications might be a sign of a malicious action being performed on the system. Auditing of such events helps in detection and investigation of such actions.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful file modifications</td>
  <td xml:lang="en-US">
Ensure that successful attempts to modify a file are audited.

The following rules configure audit as described above:
<pre>## Successful file modifications (open for write or truncate)
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;01003 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;01003 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification
-a always,exit -F arch=b32 -S open -F a1&amp;01003 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification
-a always,exit -F arch=b64 -S open -F a1&amp;01003 -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification
-a always,exit -F arch=b32 -S truncate,ftruncate -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification
-a always,exit -F arch=b64 -S truncate,ftruncate -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-modification    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-2-modify-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-2-modify-success.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing of successful attempts to modify a file helps in investigation of actions which happened on the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of loading and unloading of kernel modules</td>
  <td xml:lang="en-US">
Ensure that loading and unloading of kernel modules is audited.

The following rules configure audit as described above:
<pre>## These rules watch for kernel module insertion. By monitoring
## the syscall, we do not need any watches on programs.
-a always,exit -F arch=b32 -S init_module,finit_module -F key=module-load
-a always,exit -F arch=b64 -S init_module,finit_module -F key=module-load
-a always,exit -F arch=b32 -S delete_module -F key=module-unload
-a always,exit -F arch=b64 -S delete_module -F key=module-unload    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/43-module-load.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/43-module-load.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>
  </td>
  <td xml:lang="en-US">
Loading of a malicious kernel module introduces a risk to the system, as the module has access to sensitive data and perform actions at the operating system kernel level. Having such events audited helps in monitoring and investigating of malicious activities.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Perform general configuration of Audit for OSPP</td>
  <td xml:lang="en-US">
Configure some basic <tt>Audit</tt> parameters specific for OSPP profile. 
In particular, configure <tt>Audit</tt> to watch for direct modification of files storing system user and group information, and usage of applications with special rights which can change system configuration.
Further audited events include access to audit log it self, attempts to Alter Process and Session Initiation Information, and attempts to modify MAC controls.


The following rules configure audit as described above:
<pre>## The purpose of these rules is to meet the requirements for Operating
## System Protection Profile (OSPP)v4.2. These rules depends on having
## the following rule files copied to /etc/audit/rules.d:
##
## 10-base-config.rules, 11-loginuid.rules,
## 30-ospp-v42-1-create-failed.rules, 30-ospp-v42-1-create-success.rules,
## 30-ospp-v42-2-modify-failed.rules, 30-ospp-v42-2-modify-success.rules,
## 30-ospp-v42-3-access-failed.rules, 30-ospp-v42-3-access-success.rules,
## 30-ospp-v42-4-delete-failed.rules, 30-ospp-v42-4-delete-success.rules,
## 30-ospp-v42-5-perm-change-failed.rules,
## 30-ospp-v42-5-perm-change-success.rules,
## 30-ospp-v42-6-owner-change-failed.rules,
## 30-ospp-v42-6-owner-change-success.rules
##
## original copies may be found in /usr/share/audit/sample-rules/


## User add delete modify. This is covered by pam. However, someone could
## open a file and directly create or modify a user, so we'll watch passwd and
## shadow for writes
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;03 -F path=/etc/passwd -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;03 -F path=/etc/passwd -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b32 -S open -F a1&amp;03 -F path=/etc/passwd -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b64 -S open -F a1&amp;03 -F path=/etc/passwd -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&amp;03 -F path=/etc/shadow -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&amp;03 -F path=/etc/shadow -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b32 -S open -F a1&amp;03 -F path=/etc/shadow -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F arch=b64 -S open -F a1&amp;03 -F path=/etc/shadow -F auid&gt;=1000 -F auid!=unset -F key=user-modify

## User enable and disable. This is entirely handled by pam.

## Group add delete modify. This is covered by pam. However, someone could
## open a file and directly create or modify a user, so we'll watch group and
## gshadow for writes
-a always,exit -F path=/etc/passwd -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F path=/etc/shadow -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=user-modify
-a always,exit -F path=/etc/group -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=group-modify
-a always,exit -F path=/etc/gshadow -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=group-modify


## Use of special rights for config changes. This would be use of setuid
## programs that relate to user accts. This is not all setuid apps because
## requirements are only for ones that affect system configuration.
-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/sbin/usernetctl -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/sbin/seunshare -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/mount -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/newuidmap -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/newgidmap -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/umount -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes
-a always,exit -F path=/usr/bin/at -F perm=x -F auid&gt;=1000 -F auid!=unset -F key=special-config-changes

## Privilege escalation via su or sudo. This is entirely handled by pam.

## Watch for configuration changes to privilege escalation.
-a always,exit -F path=/etc/sudoers -F perm=wa -F key=special-config-changes
-a always,exit -F dir=/etc/sudoers.d/ -F perm=wa -F key=special-config-changes

## Audit log access
-a always,exit -F dir=/var/log/audit/ -F perm=r -F auid&gt;=1000 -F auid!=unset -F key=access-audit-trail
## Attempts to Alter Process and Session Initiation Information
-a always,exit -F path=/var/run/utmp -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=session
-a always,exit -F path=/var/log/btmp -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=session
-a always,exit -F path=/var/log/wtmp -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=session

## Attempts to modify MAC controls
-a always,exit -F dir=/etc/selinux/ -F perm=wa -F auid&gt;=1000 -F auid!=unset -F key=MAC-policy

## Software updates. This is entirely handled by rpm.

## System start and shutdown. This is entirely handled by systemd

## Kernel Module loading. This is handled in 43-module-load.rules

## Application invocation. The requirements list an optional requirement
## FPT_SRP_EXT.1 Software Restriction Policies. This event is intended to
## state results from that policy. This would be handled entirely by
## that daemon.
</pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing of events listed in the description provides data for monitoring and investigation of potentially malicious events e.g. tampering with <tt>Audit</tt> logs, malicious access to files storing information about system users and groups etc.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful ownership changes</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to change an ownership of files or directories are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful ownership change
-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-owner-change
-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-owner-change
-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-owner-change
-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-owner-change    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-6-owner-change-failed.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-6-owner-change-failed.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to change an ownership of files or directories might be signs of a malicious activity. Having such events audited helps in monitoring and investigation of such activities.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful ownership changes</td>
  <td xml:lang="en-US">
Ensure that successful attempts to change an ownership of files or directories are audited.

The following rules configure audit as described above:
<pre>## Successful ownership change
-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-owner-change
-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-owner-change    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-6-owner-change-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-6-owner-change-success.rules /etc/audit/rules.d/
</pre>

The file has the following SHA-256 checksum:
<pre>7eb41a6aaf6737c2571b6424fae7fa53af4b41a9115b6c5732a5778ccd9900ad</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing of successful ownership changes of files or directories helps in monitoring or investingating of activities performed on the system. 
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of unsuccessful permission changes</td>
  <td xml:lang="en-US">
Ensure that unsuccessful attempts to change file or directory permissions are audited.

The following rules configure audit as described above:
<pre>## Unsuccessful permission change
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-perm-change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-perm-change
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-perm-change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -F key=unsuccessful-perm-change    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-5-perm-change-failed.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-5-perm-change-failed.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Unsuccessful attempts to change permissions of files or directories might be signs of malicious activity. Having such events audited helps in monitoring and investigation of such activities. 
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2(a)</td>
  <td>N/A</td>
  <td>Configure auditing of successful permission changes</td>
  <td xml:lang="en-US">
Ensure that successful attempts to modify permissions of files or directories are audited.

The following rules configure audit as described above:
<pre>## Successful permission change
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-perm-change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid&gt;=1000 -F auid!=unset -F key=successful-perm-change    </pre>

The <tt>Audit</tt> package provides pre-configured  rules in <tt>/usr/share/audit/sample-rules</tt>. The above content can be found in <tt>/usr/share/audit/sample-rules/30-ospp-v42-5-perm-change-success.rules</tt>.
To deploy this configuration, it is recommended to copy it over to the <tt>/etc/audit/rules.d/</tt> directory:
<pre>
cp /usr/share/audit/sample-rules/30-ospp-v42-5-perm-change-success.rules /etc/audit/rules.d/
</pre>

Load new Audit rules into kernel by running:
<pre>augenrules --load</pre>

Note: This rule utilizes a file provided by <tt>Audit</tt> package to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.
  </td>
  <td xml:lang="en-US">
Auditing successful file or directory permission changes helps in monitoring and investigating of activities performed on the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-2<br/>CM-8(3)<br/>IA-3</td>
  <td>CCE-82538-0</td>
  <td>Log USBGuard daemon audit events using Linux Audit</td>
  <td xml:lang="en-US">
To configure USBGuard daemon to log via Linux Audit
(as opposed directly to a file),
<tt>AuditBackend</tt> option in <tt>/etc/usbguard/usbguard-daemon.conf</tt>
needs to be set to <tt>LinuxAudit</tt>.
  </td>
  <td xml:lang="en-US">
Using the Linux Audit logging allows for centralized trace
of events.
  </td>
  <td></td>
</tr>
<tr>
  <td>IA-2<br/>AC-3<br/>CM-6(a)</td>
  <td>CCE-82550-5</td>
  <td>Require Authentication for Single User Mode</td>
  <td xml:lang="en-US">
Single-user mode is intended as a system recovery
method, providing a single user root access to the system by
providing a boot option at startup. By default, no authentication
is performed if single-user mode is selected.
<br /><br />
By default, single-user mode is protected by requiring a password and is set
in <tt>/usr/lib/systemd/system/rescue.service</tt>.
  </td>
  <td xml:lang="en-US">
This prevents attackers with physical access from trivially bypassing security
on the machine and gaining root access. Such accesses are further prevented
by configuring the bootloader password.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-2(g)<br/>AU-3<br/>AU-10<br/>AU-2(d)<br/>AU-12(c)<br/>AU-14(1)<br/>AC-6(9)<br/>CM-6(a)<br/>SI-4(23)</td>
  <td>CCE-82463-1</td>
  <td>Enable auditd Service</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service is an essential userspace component of
the Linux Auditing System, as it is responsible for writing audit records to
disk.

The <code>auditd</code> service can be enabled with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-auditd-enable
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - name: auditd.service
        enabled: true
</pre>
<p>
This will enable the <tt>auditd</tt> service in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
Without establishing what type of events occurred, it would be difficult
to establish, correlate, and investigate the events leading up to an outage or attack.
Ensuring the <tt>auditd</tt> service is active ensures audit records
generated by the kernel are appropriately recorded.
<br /><br />
Additionally, a properly configured audit subsystem ensures that actions of
individual system users can be uniquely traced to those users so they
can be held accountable for their actions.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-2(1)<br/>CM-6(a)</td>
  <td>CCE-82551-3</td>
  <td>Verify that Interactive Boot is Disabled</td>
  <td xml:lang="en-US">
Red Hat Enterprise Linux CoreOS 4 systems support an "interactive boot" option that can
be used to prevent services from being started. On a Red Hat Enterprise Linux CoreOS 4
system, interactive boot can be enabled by providing a <tt>1</tt>,
<tt>yes</tt>, <tt>true</tt>, or <tt>on</tt> value to the
<tt>systemd.confirm_spawn</tt> kernel argument in <tt>/etc/default/grub</tt>.
Remove any instance of <pre>systemd.confirm_spawn=(1|yes|true|on)</pre> from
the kernel arguments in that file to disable interactive boot. It is also
required to change the runtime configuration, run:
<pre>/sbin/grubby --update-kernel=ALL --remove-args="systemd.confirm_spawn"</pre>
  </td>
  <td xml:lang="en-US">
Using interactive boot, the console user could disable auditing, firewalls,
or other services, weakening system security.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-2(5)<br/>AC-12<br/>AC-17(a)<br/>SC-10<br/>CM-6(a)</td>
  <td>CCE-83406-9</td>
  <td>Set SSH Client Alive Count Max to zero</td>
  <td xml:lang="en-US">
The SSH server sends at most <tt>ClientAliveCountMax</tt> messages
during a SSH session and waits for a response from the SSH client.
The option <tt>ClientAliveInterval</tt> configures timeout after
each <tt>ClientAliveCountMax</tt> message. If the SSH server does not
receive a response from the client, then the connection is considered idle
and terminated.

To ensure the SSH idle timeout occurs precisely when the
<tt>ClientAliveInterval</tt> is set, set the <tt>ClientAliveCountMax</tt> to
value of <tt>0</tt> in


<tt>/etc/ssh/sshd_config</tt>:
  </td>
  <td xml:lang="en-US">
This ensures a user login will be terminated as soon as the <tt>ClientAliveInterval</tt>
is reached.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-3<br/>AC-17(a)<br/>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Disable Host-Based Authentication</td>
  <td xml:lang="en-US">
SSH's cryptographic host-based authentication is
more secure than <tt>.rhosts</tt> authentication. However, it is
not recommended that hosts unilaterally trust one another, even
within an organization.
<br />
The default SSH configuration disables host-based authentication. The appropriate
configuration is used if no value is set for <tt>HostbasedAuthentication</tt>.
<br />
To explicitly disable host-based authentication, add or correct the
following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>HostbasedAuthentication no</pre>
  </td>
  <td xml:lang="en-US">
SSH trust relationships mean a compromise on one host
can allow an attacker to move trivially to other hosts.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-3<br/>AC-3(3)(a)<br/>AU-9<br/>SC-7(21)</td>
  <td>CCE-82532-3</td>
  <td>Configure SELinux Policy</td>
  <td xml:lang="en-US">
The SELinux <tt>targeted</tt> policy is appropriate for
general-purpose desktops and servers, as well as systems in many other roles.
To configure the system to use this policy, add or correct the following line
in <tt>/etc/selinux/config</tt>:
<pre>SELINUXTYPE=<tt>targeted</tt></pre>
Other policies, such as <tt>mls</tt>, provide additional security labeling
and greater confinement but are not compatible with many general-purpose
use cases.
  </td>
  <td xml:lang="en-US">
Setting the SELinux policy to <tt>targeted</tt> or a more specialized policy
ensures the system will confine processes that are likely to be
targeted for exploitation, such as network or system services.
<br /><br />
Note: During the development or debugging of SELinux modules, it is common to
temporarily place non-production systems in <tt>permissive</tt> mode. In such
temporary cases, SELinux policies should be developed, and once work
is completed, the system should be reconfigured to
<tt><sub idref="var_selinux_policy_name" /></tt>.
  </td>
  <td>var_selinux_policy_name=targeted</td>
</tr>
<tr>
  <td>AC-3<br/>AC-3(3)(a)<br/>AU-9<br/>SC-7(21)</td>
  <td>CCE-82531-5</td>
  <td>Ensure SELinux State is Enforcing</td>
  <td xml:lang="en-US">
The SELinux state should be set to <tt><tt>enforcing</tt></tt> at
system boot time.  In the file <tt>/etc/selinux/config</tt>, add or correct the
following line to configure the system to boot into enforcing mode:
<pre>SELINUX=<tt>enforcing</tt></pre>
  </td>
  <td xml:lang="en-US">
Setting the SELinux state to enforcing ensures SELinux is able to confine
potentially compromised processes to the security policy, which is designed to
prevent them from causing damage to the system or further elevating their
privileges.
  </td>
  <td>var_selinux_state=enforcing</td>
</tr>
<tr>
  <td>AC-4<br/>CM-7(b)<br/>CA-3(5)<br/>SC-7(21)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Verify iptables Enabled</td>
  <td xml:lang="en-US">

The <code>iptables</code> service can be enabled with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-iptables-enable
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - name: iptables.service
        enabled: true
</pre>
<p>
This will enable the <tt>iptables</tt> service in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
The <tt>iptables</tt> service provides the system's host-based firewalling
capability for IPv4 and ICMP.
  </td>
  <td></td>
</tr>
<tr>
  <td>IA-5(1)(a)<br/>IA-5(c)<br/>CM-6(a)</td>
  <td>CCE-82553-9</td>
  <td>Prevent Login to Accounts With Empty Password</td>
  <td xml:lang="en-US">
If an account is configured for password authentication
but does not have an assigned password, it may be possible to log
into the account without authentication. Remove any instances of the
<tt>nullok</tt> in

<tt>/etc/pam.d/system-auth</tt>

to prevent logins with empty passwords.
Note that this rule is not applicable for systems running within a
container. Having user with empty password within a container is not
considered a risk, because it should not be possible to directly login into
a container anyway.
  </td>
  <td xml:lang="en-US">
If an account has an empty password, anyone could log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational environments.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-5(3)<br/>SI-7<br/>SC-12<br/>SC-12(3)<br/>CM-6(a)</td>
  <td>CCE-82754-3</td>
  <td>Ensure Red Hat GPG Key Installed</td>
  <td xml:lang="en-US">
To ensure the system can cryptographically verify base software packages
come from Red Hat (and to connect to the Red Hat Network to receive them),
the Red Hat GPG key must properly be installed. To install the Red Hat GPG
key, run:
<pre>$ sudo subscription-manager register</pre>

If the system is not connected to the Internet or an RHN Satellite, then
install the Red Hat GPG key from trusted media such as the Red Hat
installation CD-ROM or DVD. Assuming the disc is mounted in
<tt>/media/cdrom</tt>, use the following command as the root user to import
it into the keyring:
<pre>$ sudo rpm --import /media/cdrom/RPM-GPG-KEY</pre>

Alternatively, the key may be pre-loaded during the RHEL installation. In
such cases, the key can be installed by running the following command:
<pre>sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</pre>
  </td>
  <td xml:lang="en-US">
Changes to software components can have significant effects on the overall
security of the operating system. This requirement ensures the software has
not been tampered with and that it has been provided by a trusted vendor.
The Red Hat GPG key is necessary to cryptographically verify packages are
from Red Hat.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82512-5</td>
  <td>Set number of records to cause an explicit flush to audit logs</td>
  <td xml:lang="en-US">
To configure Audit daemon to issue an explicit flush to disk command
after writing 50 records, set <tt>freq</tt> to <tt>50</tt>
in <tt>/etc/audit/auditd.conf</tt>.
  </td>
  <td xml:lang="en-US">
If option <tt>freq</tt> isn't set to <tt>50</tt>, the flush to disk
may happen after higher number of records, increasing the danger
of audit loss.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82509-1</td>
  <td>Include Local Events in Audit Logs</td>
  <td xml:lang="en-US">
To configure Audit daemon to include local events in Audit logs, set
<tt>local_events</tt> to <tt>yes</tt> in <tt>/etc/audit/auditd.conf</tt>.
This is the default setting.
  </td>
  <td xml:lang="en-US">
If option <tt>local_events</tt> isn't set to <tt>yes</tt> only events from
network will be aggregated.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6<br/>AU-3</td>
  <td>CCE-82511-7</td>
  <td>Resolve information before writing to audit logs</td>
  <td xml:lang="en-US">
To configure Audit daemon to resolve all uid, gid, syscall,
architecture, and socket address information before writing the
events to disk, set <tt>log_format</tt> to <tt>ENRICHED</tt>
in <tt>/etc/audit/auditd.conf</tt>.
  </td>
  <td xml:lang="en-US">
If option <tt>log_format</tt> isn't set to <tt>ENRICHED</tt>, the
audit records will be stored in a format exactly as the kernel sends them.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6<br/>AU-3</td>
  <td>CCE-82513-3</td>
  <td>Set hostname as computer node name in audit logs</td>
  <td xml:lang="en-US">
To configure Audit daemon to use value returned by gethostname
syscall as computer node name in the audit events,
set <tt>name_format</tt> to <tt>hostname</tt>
in <tt>/etc/audit/auditd.conf</tt>.
  </td>
  <td xml:lang="en-US">
If option <tt>name_format</tt> is left at its default value of
<tt>none</tt>, audit events from different computers may be hard
to distinguish.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82510-9</td>
  <td>Write Audit Logs to the Disk</td>
  <td xml:lang="en-US">
To configure Audit daemon to write Audit logs to the disk, set
<tt>write_logs</tt> to <tt>yes</tt> in <tt>/etc/audit/auditd.conf</tt>.
This is the default setting.
  </td>
  <td xml:lang="en-US">
If <tt>write_logs</tt> isn't set to <tt>yes</tt>, the Audit logs will
not be written to the disk.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>MA-4(6)<br/>SC-13<br/>SC-12(2)<br/>SC-12(3)</td>
  <td>CCE-82546-3</td>
  <td>Configure Libreswan to use System Crypto Policy</td>
  <td xml:lang="en-US">
Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
Libreswan is supported by system crypto policy, but the Libreswan configuration may be
set up to ignore it.

To check that Crypto Policies settings are configured correctly, ensure that the <tt>/etc/ipsec.conf</tt>
includes the appropriate configuration file.
In <tt>/etc/ipsec.conf</tt>, make sure that the following line
is not commented out or superseded by later includes:
<tt>include /etc/crypto-policies/back-ends/libreswan.config</tt>
  </td>
  <td xml:lang="en-US">
Overriding the system crypto policy makes the behavior of the Libreswan
service violate expectations, and makes system configuration more
fragmented.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82529-9</td>
  <td>Disable core dump backtraces</td>
  <td xml:lang="en-US">
The <tt>ProcessSizeMax</tt> option in <tt>[Coredump]</tt> section
of <tt>/etc/systemd/coredump.conf</tt>
specifies the maximum size in bytes of a core which will be processed.
Core dumps exceeding this size may be stored, but the backtrace will not
be generated.
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data
and is generally useful only for developers or system operators trying to
debug problems.

Enabling core dumps on production systems is not recommended,
however there may be overriding operational requirements to enable advanced
debuging. Permitting temporary enablement of core dumps during such situations
should be reviewed through local needs and policy.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82528-1</td>
  <td>Disable storing core dump</td>
  <td xml:lang="en-US">
The <tt>Storage</tt> option in <tt>[Coredump]</tt> section
of <tt>/etc/systemd/coredump.conf</tt>
can be set to <tt>none</tt> to disable storing core dumps permanently.
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data
and is generally useful only for developers or system operators trying to
debug problems. Enabling core dumps on production systems is not recommended,
however there may be overriding operational requirements to enable advanced
debuging. Permitting temporary enablement of core dumps during such situations
should be reviewed through local needs and policy.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)</td>
  <td>CCE-82671-9</td>
  <td>Extend Audit Backlog Limit for the Audit Daemon</td>
  <td xml:lang="en-US">
To improve the kernel capacity to queue all log events, even those which occurred
prior to the audit daemon, add the argument <tt>audit_backlog_limit=8192</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
audit_backlog_limit sets the queue length for audit events awaiting transfer
to the audit daemon. Until the audit daemon is up and running, all log messages
are stored in this queue.  If the queue is overrun during boot process, the action
defined by audit failure flag is taken.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)</td>
  <td>CCE-82673-5</td>
  <td>Enable page allocator poisoning</td>
  <td xml:lang="en-US">
To enable poisoning of free pages, add the argument <tt>page_poison=1</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
Poisoning writes an arbitrary value to freed pages, so any modification or
reference to that page after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)</td>
  <td>CCE-82672-7</td>
  <td>Enable SLUB/SLAB allocator poisoning</td>
  <td xml:lang="en-US">
To enable poisoning of SLUB/SLAB objects, add the argument <tt>slub_debug=P</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
Poisoning writes an arbitrary value to freed objects, so any modification or
reference to that object after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AC-6(1)<br/>CM-6(a)</td>
  <td>CCE-82495-3</td>
  <td>Disable Ctrl-Alt-Del Burst Action</td>
  <td xml:lang="en-US">
By default, <tt>SystemD</tt> will reboot the system if the <tt>Ctrl-Alt-Del</tt>
key sequence is pressed Ctrl-Alt-Delete more than 7 times in 2 seconds.
<br /><br />
To configure the system to ignore the <tt>CtrlAltDelBurstAction</tt>

setting, create a <tt>MachineConfig</tt> similar to the following:
<pre>
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-disable-ctrlaltdel-burstaction
spec:
  config:
    ignition:
      version: 3.1.0
    storage:
      files:
      - contents:
          source: data:,CtrlAltDelBurstAction%3Dnone
        mode: 0644
        path: /etc/systemd/system.conf.d/disable_ctrlaltdelete_burstaction.conf
        overwrite: true
EOF
</pre>
<p>
This will add the relevant configuration to <tt>/etc/systemd/system.conf.d/</tt>,
thus configuring Systemd apropriately.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
A locally logged-in user who presses Ctrl-Alt-Del, when at the console,
can reboot the system. If accidentally pressed, as could happen in
the case of mixed OS environment, this can create the risk of short-term
loss of availability of systems due to unintentional reboot.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AC-6(1)</td>
  <td>CCE-82493-8</td>
  <td>Disable Ctrl-Alt-Del Reboot Activation</td>
  <td xml:lang="en-US">
By default, <tt>SystemD</tt> will reboot the system if the <tt>Ctrl-Alt-Del</tt>
key sequence is pressed.
<br /><br />
To configure the system to ignore the <tt>Ctrl-Alt-Del</tt> key sequence from the

command line instead of rebooting the system, create a <tt>MachineConfig</tt>
similar to the following:
<pre>
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-disable-ctrlaltdel-reboot
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - name: ctrl-alt-del.target
        mask: true
EOF
</pre>
<p>
This will mask the <tt>ctrl-alt-del.target</tt> systemd target for all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
A locally logged-in user who presses Ctrl-Alt-Del, when at the console,
can reboot the system. If accidentally pressed, as could happen in
the case of mixed OS environment, this can create the risk of short-term
loss of availability of systems due to unintentional reboot.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6<br/>SC-7(10)</td>
  <td>CCE-82526-5</td>
  <td>Disable Core Dumps for All Users</td>
  <td xml:lang="en-US">
To disable core dumps for all users, add the following line to
<tt>/etc/security/limits.conf</tt>, or to a file within the
<tt>/etc/security/limits.d/</tt> directory:
<pre>*     hard   core    0</pre>
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)</td>
  <td>CCE-82552-1</td>
  <td>Set the UEFI Boot Loader Password</td>
  <td xml:lang="en-US">
The grub2 boot loader should have a superuser account and password
protection enabled to protect boot-time settings.
<br /><br />
Since plaintext passwords are a security risk, generate a hash for the password
by running the following command:

<pre># grub2-setpassword</pre>

When prompted, enter the password that was selected.
<br /><br />
  </td>
  <td xml:lang="en-US">
Password protection on the boot loader configuration ensures
users with physical access cannot trivially alter
important bootloader settings. These include which kernel to use,
and whether to enter single-user mode.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>SI-4(22)</td>
  <td>CCE-82533-1</td>
  <td>Install fapolicyd Package</td>
  <td xml:lang="en-US">
The <code>fapolicyd</code> package can be installed with the following command:
<pre></pre>
  </td>
  <td xml:lang="en-US">
<tt>fapolicyd</tt> (File Access Policy Daemon)
implements application whitelisting to decide file access rights.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)</td>
  <td>N/A</td>
  <td>Install the tmux Package</td>
  <td xml:lang="en-US">
To enable console screen locking, install the <tt>tmux</tt> package.
A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.
The session lock is implemented at the point where session activity can be determined.
Rather than be forced to wait for a period of time to expire before the user session can be locked, Red Hat Enterprise Linux CoreOS 4 needs to provide users with the ability to manually invoke a session lock so users can secure their session if it is necessary to temporarily vacate the immediate physical vicinity.
Instruct users to begin new terminal sessions with the following command:
<pre>$ tmux</pre>
The console can now be locked with the following key combination:
<pre>ctrl+b :lock-session</pre>
  </td>
  <td xml:lang="en-US">
A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate
physical vicinity of the information system but does not logout because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operation system session prior to vacating the vicinity,
operating systems need to be able to identify when a user's session has idled and take action to initiate the
session lock.
<br /><br />
The <tt>tmux</tt> package allows for a session lock to be implemented and configured.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>SC-5(2)</td>
  <td>CCE-82739-4</td>
  <td>Ensure /home Located On Separate Partition</td>
  <td xml:lang="en-US">
If user home directories will be stored locally, create a separate partition
for <tt>/home</tt> at installation time (or migrate it later using LVM). If
<tt>/home</tt> will be mounted from another system such as an NFS server, then
creating a separate partition is not necessary at installation time, and the
mountpoint can instead be configured later.
  </td>
  <td xml:lang="en-US">
Ensuring that <tt>/home</tt> is mounted on its own partition enables the
setting of more restrictive mount options, and also helps ensure that
users cannot trivially fill partitions used for log or audit data storage.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>SC-5(2)</td>
  <td>N/A</td>
  <td>Ensure /var Located On Separate Partition</td>
  <td xml:lang="en-US">
The <tt>/var</tt> directory is used by daemons and other system
services to store frequently-changing data. Ensure that <tt>/var</tt> has its own partition
or logical volume at installation time, or migrate it using LVM.
  </td>
  <td xml:lang="en-US">
Ensuring that <tt>/var</tt> is mounted on its own partition enables the
setting of more restrictive mount options. This helps protect
system services such as daemons or other programs which use it.
It is not uncommon for the <tt>/var</tt> directory to contain
world-writable directories installed by other software packages.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AU-4<br/>SC-5(2)</td>
  <td>CCE-82737-8</td>
  <td>Ensure /var/log Located On Separate Partition</td>
  <td xml:lang="en-US">
System logs are stored in the <tt>/var/log</tt> directory.
<p>
Partitioning Red Hat CoreOS is a Day 1 operation and cannot
be changed afterwards. For documentation on how to add a
MachineConfig manifest that specifies a separate <code>/var/log</code>
partition, follow:

    <a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic'>https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic</a>
</p>
<p>
Note that the Red Hat OpenShift documentation often references a block
device, such as <tt>/dev/vda</tt>. The name of the available block devices depends
on the underlying infrastructure (bare metal vs cloud), and often the specific
instance type. For example in AWS, some instance types have NVMe drives
(<tt>/dev/nvme*</tt>), others use <tt>/dev/xvda*</tt>.

You will need to look for relevant documentation for your infrastructure around this.
In many cases, the simplest thing is to boot a single machine with an Ignition
configuration that just gives you SSH access, and inspect the block devices via
e.g. the <tt>lsblk</tt> command.

For physical hardware, a good best practice is to reference devices via the
<tt>/dev/disk/by-id/</tt> or <tt>/dev/disk/by-path</tt> links.
</p>
  </td>
  <td xml:lang="en-US">
Placing <tt>/var/log</tt> in its own partition
enables better separation between log files
and other files in <tt>/var/</tt>.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AU-4<br/>SC-5(2)</td>
  <td>CCE-82738-6</td>
  <td>Ensure /var/log/audit Located On Separate Partition</td>
  <td xml:lang="en-US">
Audit logs are stored in the <tt>/var/log/audit</tt> directory.
<p>
Partitioning Red Hat CoreOS is a Day 1 operation and cannot
be changed afterwards. For documentation on how to add a
MachineConfig manifest that specifies a separate <code>/var/log/audit</code>
partition, follow:

    <a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic'>https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic</a>
</p>
<p>
Note that the Red Hat OpenShift documentation often references a block
device, such as <tt>/dev/vda</tt>. The name of the available block devices depends
on the underlying infrastructure (bare metal vs cloud), and often the specific
instance type. For example in AWS, some instance types have NVMe drives
(<tt>/dev/nvme*</tt>), others use <tt>/dev/xvda*</tt>.

You will need to look for relevant documentation for your infrastructure around this.
In many cases, the simplest thing is to boot a single machine with an Ignition
configuration that just gives you SSH access, and inspect the block devices via
e.g. the <tt>lsblk</tt> command.

For physical hardware, a good best practice is to reference devices via the
<tt>/dev/disk/by-id/</tt> or <tt>/dev/disk/by-path</tt> links.
</p>

Make absolutely certain that it is large enough to store all
audit logs that will be created by the auditing daemon.
  </td>
  <td xml:lang="en-US">
Placing <tt>/var/log/audit</tt> in its own partition
enables better separation between audit files
and other files, and helps ensure that
auditing cannot be halted due to the partition running out
of space.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82496-1</td>
  <td>Disable debug-shell SystemD Service</td>
  <td xml:lang="en-US">
SystemD's <tt>debug-shell</tt> service is intended to
diagnose SystemD related boot issues with various <tt>systemctl</tt>
commands. Once enabled and following a system reboot, the root shell
will be available on <tt>tty9</tt> which is access by pressing
<tt>CTRL-ALT-F9</tt>. The <tt>debug-shell</tt> service should only be used
for SystemD related issues and should otherwise be disabled.
<br /><br />
By default, the <tt>debug-shell</tt> SystemD service is already disabled.

The <code>debug-shell</code> service can be disabled with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-debug-shell-disable
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - enabled: false
        name: debug-shell.service
</pre>
<p>
This will disable the <tt>debug-shell</tt> service in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
This prevents attackers with physical access from trivially bypassing security
on the machine through valid troubleshooting configurations and gaining root
access when the system is rebooted.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>SI-4(22)</td>
  <td>CCE-82534-9</td>
  <td>Enable the File Access Policy Service</td>
  <td xml:lang="en-US">
The File Access Policy service should be enabled.

The <code>fapolicyd</code> service can be enabled with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-fapolicyd-enable
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - name: fapolicyd.service
        enabled: true
</pre>
<p>
This will enable the <tt>fapolicyd</tt> service in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
The <tt>fapolicyd</tt> service (File Access Policy Daemon)
implements application whitelisting to decide file access rights.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-6<br/>AC-17(a)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Enable Use of Strict Mode Checking</td>
  <td xml:lang="en-US">
SSHs <tt>StrictModes</tt> option checks file and ownership permissions in
the user's home directory <tt>.ssh</tt> folder before accepting login. If world-
writable permissions are found, logon is rejected.
<br/>
The default SSH configuration has <tt>StrictModes</tt> enabled. The appropriate
configuration is used if no value is set for <tt>StrictModes</tt>.
<br/>
To explicitly enable <tt>StrictModes</tt> in SSH, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>StrictModes yes</pre>
  </td>
  <td xml:lang="en-US">
If other users have access to modify user-specific SSH configuration files, they
may be able to log into the system as another user.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AC-17(a)<br/>AC-2(5)<br/>AC-12<br/>AC-17(a)<br/>SC-10<br/>CM-6(a)</td>
  <td>CCE-82549-7</td>
  <td>Set SSH Idle Timeout Interval</td>
  <td xml:lang="en-US">
SSH allows administrators to set an idle timeout interval. After this interval
has passed, the idle user will be automatically logged out.
<br /><br />
To set an idle timeout interval, edit the following line in <tt>/etc/ssh/sshd_config</tt> as
follows:
<pre>ClientAliveInterval <b><tt>14_minutes</tt></b></pre>
<br/><br/>
The timeout <b>interval</b> is given in seconds. For example, have a timeout
of 10 minutes, set <b>interval</b> to 600.
<br /><br />
If a shorter timeout has already been set for the login shell, that value will
preempt any SSH setting made in <tt>/etc/ssh/sshd_config</tt>. Keep in mind that
some processes may stop SSH  from correctly detecting that the user is idle.
  </td>
  <td xml:lang="en-US">
Terminating an idle ssh session within a short time period reduces the window of
opportunity for unauthorized personnel to take control of a management session
enabled on the console or console port that has been let unattended.
  </td>
  <td>sshd_idle_timeout_value=14_minutes</td>
</tr>
<tr>
  <td>CM-6(a)<br/>AC-6(1)</td>
  <td>CCE-82506-7</td>
  <td>Enable Kernel Parameter to Enforce DAC on Hardlinks</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>fs.protected_hardlinks</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_hardlinks=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_hardlinks = 1</pre>
  </td>
  <td xml:lang="en-US">
By enabling this kernel parameter, users can no longer create soft or hard links to
files which they do not own. Disallowing such hardlinks mitigate vulnerabilities
based on insecure file system accessed by privileged programs, avoiding an
exploitation vector exploiting unsafe use of <tt>open()</tt> or <tt>creat()</tt>.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6(a)<br/>AC-6(1)</td>
  <td>CCE-82507-5</td>
  <td>Enable Kernel Parameter to Enforce DAC on Symlinks</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>fs.protected_symlinks</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w fs.protected_symlinks=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>fs.protected_symlinks = 1</pre>
  </td>
  <td xml:lang="en-US">
By enabling this kernel parameter, symbolic links are permitted to be followed
only when outside a sticky world-writable directory, or when the UID of the
link and follower match, or when the directory owner matches the symlink's owner.
Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system
accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of
<tt>open()</tt> or <tt>creat()</tt>.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6</td>
  <td>CCE-82500-0</td>
  <td>Disable Kernel Image Loading</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.kexec_load_disabled</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.kexec_load_disabled=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.kexec_load_disabled = 1</pre>
  </td>
  <td xml:lang="en-US">
Disabling kexec_load allows greater control of the kernel memory.
It makes it impossible to load another kernel image after it has been disabled.

  </td>
  <td></td>
</tr>
<tr>
  <td>AC-6</td>
  <td>CCE-82502-6</td>
  <td>Disallow kernel profiling by unprivileged users</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.perf_event_paranoid</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.perf_event_paranoid=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.perf_event_paranoid = 2</pre>
  </td>
  <td xml:lang="en-US">
Kernel profiling can reveal sensitive information about kernel behaviour.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-6<br/>SC-7(10)</td>
  <td>CCE-82504-2</td>
  <td>Disable Access to Network bpf() Syscall From Unprivileged Processes</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.unprivileged_bpf_disabled</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.unprivileged_bpf_disabled=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.unprivileged_bpf_disabled = 1</pre>
  </td>
  <td xml:lang="en-US">
Loading and accessing the packet filters programs and maps using the bpf()
syscall has the potential of revealing sensitive information about the kernel state.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-6<br/>SC-7(10)</td>
  <td>CCE-82505-9</td>
  <td>Harden the operation of the BPF just-in-time compiler</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.core.bpf_jit_harden</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.core.bpf_jit_harden=2</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.core.bpf_jit_harden = 2</pre>
  </td>
  <td xml:lang="en-US">
When hardened, the extended Berkeley Packet Filter just-in-time compiler
will randomize any kernel addresses in the BPF programs and maps,
and will not expose the JIT addresses in <tt>/proc/kallsyms</tt>.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-6(1)<br/>CM-6(a)</td>
  <td>CCE-84260-9</td>
  <td>Ensure the Default Bash Umask is Set Correctly</td>
  <td xml:lang="en-US">
To ensure the default umask for users of the Bash shell is set properly,
add or correct the <tt>umask</tt> setting in <tt>/etc/bashrc</tt> to read
as follows:
<pre>umask <tt>027</tt></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.
  </td>
  <td>var_accounts_user_umask=027</td>
</tr>
<tr>
  <td>AC-6(1)<br/>CM-6(a)</td>
  <td>CCE-84261-7</td>
  <td>Ensure the Default C Shell Umask is Set Correctly</td>
  <td xml:lang="en-US">
To ensure the default umask for users of the C shell is set properly,
add or correct the <tt>umask</tt> setting in <tt>/etc/csh.cshrc</tt> to read as follows:
<pre>umask <tt>027</tt></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.
  </td>
  <td>var_accounts_user_umask=027</td>
</tr>
<tr>
  <td>AC-6(1)<br/>CM-6(a)</td>
  <td>CCE-84262-5</td>
  <td>Ensure the Default Umask is Set Correctly in /etc/profile</td>
  <td xml:lang="en-US">
To ensure the default umask controlled by <tt>/etc/profile</tt> is set properly,
add or correct the <tt>umask</tt> setting in <tt>/etc/profile</tt> to read as follows:
<pre>umask <tt>027</tt></pre>
  </td>
  <td xml:lang="en-US">
The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.
  </td>
  <td>var_accounts_user_umask=027</td>
</tr>
<tr>
  <td>AC-6(2)<br/>AC-17(a)<br/>IA-2<br/>IA-2(5)<br/>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Disable SSH Root Login</td>
  <td xml:lang="en-US">
The root user should never be allowed to login to a
system directly over a network.
To disable root login via SSH, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>PermitRootLogin no</pre>
  </td>
  <td xml:lang="en-US">
Even though the communications channel may be encrypted, an additional layer of
security is gained by extending the policy of not logging directly on as root.
In addition, logging in with a user-specific account provides individual
accountability of actions performed on the system and also helps to minimize
direct attack attempts on root's password.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)</td>
  <td>CCE-82674-3</td>
  <td>Disable vsyscalls</td>
  <td xml:lang="en-US">
To disable use of virtual syscalls, add the argument <tt>vsyscall=none</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
Virtual Syscalls provide an opportunity of attack for a user who has control
of the return instruction pointer.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82514-1</td>
  <td>Disable Mounting of cramfs</td>
  <td xml:lang="en-US">

To configure the system to prevent the <code>cramfs</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install cramfs /bin/true</pre>
This effectively prevents usage of this uncommon filesystem.

The <tt>cramfs</tt> filesystem type is a compressed read-only
Linux filesystem embedded in small footprint systems. A
<tt>cramfs</tt> image can be used without having to first
decompress the image.
  </td>
  <td xml:lang="en-US">
Removing support for unneeded filesystem types reduces the local attack surface
of the server.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82516-6</td>
  <td>Disable SCTP Support</td>
  <td xml:lang="en-US">
The Stream Control Transmission Protocol (SCTP) is a
transport layer protocol, designed to support the idea of
message-oriented communication, with several streams of messages
within one connection.

To configure the system to prevent the <code>sctp</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install sctp /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling SCTP protects
the system against exploitation of any flaws in its implementation.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82520-8</td>
  <td>Disable TIPC Support</td>
  <td xml:lang="en-US">
The Transparent Inter-Process Communication (TIPC) protocol
is designed to provide communications between nodes in a
cluster.

To configure the system to prevent the <code>tipc</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install tipc /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling TIPC protects
the system against exploitation of any flaws in its implementation.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to /boot</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/boot</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/boot</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nosuid Option to /boot</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/boot</tt>. The SUID and SGID permissions
should not be required on the boot partition.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/boot</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from boot partitions.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>CCE-82867-3</td>
  <td>Add nodev Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent creation of device
files in <tt>/dev/shm</tt>. Legitimate character and block devices should
not exist within temporary directories like <tt>/dev/shm</tt>.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>CCE-82868-1</td>
  <td>Add noexec Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/dev/shm</tt>.
It can be dangerous to allow the execution of binaries
from world-writable temporary storage directories such as <tt>/dev/shm</tt>.
Add the <code>noexec</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/dev/shm</tt> can expose the system to potential compromise.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>CCE-82741-0</td>
  <td>Add nosuid Option to /dev/shm</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent execution
of setuid programs in <tt>/dev/shm</tt>.  The SUID and SGID permissions should not
be required in these world-writable directories.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/dev/shm</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nosuid Option to /home</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/home</tt>. The SUID and SGID permissions
should not be required in these user data directories.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/home</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from user home directory partitions.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to Non-Root Local Partitions</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option prevents files from being interpreted as
character or block devices. Legitimate character and block devices should
exist only in the <tt>/dev</tt> directory on the root partition or within
chroot jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of

    any non-root local partitions.
  </td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option prevents files from being
interpreted as character or block devices. The only legitimate location
for device files is the <tt>/dev</tt> directory located on the root partition.
The only exception to this is chroot jails, for which it is not advised
to set <tt>nodev</tt> on these filesystems.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/tmp</tt>. Legitimate character and block devices
should not exist within temporary directories like <tt>/tmp</tt>.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add noexec Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/tmp</tt>.
Add the <code>noexec</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/tmp</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nosuid Option to /tmp</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/tmp</tt>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/tmp</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to /var/log/audit</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/var/log/audit</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log/audit</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add noexec Option to /var/log/audit</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/var/log/audit</tt>.
Add the <code>noexec</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log/audit</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from directories containing audit log files
such as <tt>/var/log/audit</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nosuid Option to /var/log/audit</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/var/log/audit</tt>. The SUID and SGID permissions
should not be required in directories containing audit log files.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log/audit</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from partitions
designated for audit log files.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to /var/log</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/var/log</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add noexec Option to /var/log</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/var/log</tt>.
Add the <code>noexec</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from directories containing log files
such as <tt>/var/log</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nosuid Option to /var/log</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/var/log</tt>. The SUID and SGID permissions
should not be required in directories containing log files.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/log</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from partitions
designated for log files.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-6<br/>AC-6(1)<br/>MP-7</td>
  <td>N/A</td>
  <td>Add nodev Option to /var</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/var</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-7(a)<br/>AU-7(1)<br/>AU-7(2)<br/>AU-14<br/>AU-12(2)<br/>AU-2(a)<br/>CM-6(a)</td>
  <td>CCE-82669-3</td>
  <td>Ensure the audit Subsystem is Installed</td>
  <td xml:lang="en-US">
The audit package should be installed.
  </td>
  <td xml:lang="en-US">
The auditd service is an access monitoring and accounting daemon, watching system calls to audit any access, in comparison with potential local access control policy such as SELinux policy.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Uninstall Sendmail Package</td>
  <td xml:lang="en-US">
Sendmail is not the default mail transfer agent and is
not installed by default.
The <code>sendmail</code> package can be removed with the following command:
<pre></pre>
  </td>
  <td xml:lang="en-US">
The sendmail software was not developed with security in mind and
its design prevents it from being effectively contained by SELinux.  Postfix
should be used instead.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>AC-17(a)</td>
  <td>N/A</td>
  <td>Disable GSSAPI Authentication</td>
  <td xml:lang="en-US">
Unless needed, SSH should not permit extraneous or unnecessary
authentication mechanisms like GSSAPI.
<br/>
The default SSH configuration disallows authentications based on GSSAPI. The appropriate
configuration is used if no value is set for <tt>GSSAPIAuthentication</tt>.
<br/>
To explicitly disable GSSAPI authentication, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>GSSAPIAuthentication no</pre>
  </td>
  <td xml:lang="en-US">
GSSAPI authentication is used to provide additional authentication mechanisms to
applications. Allowing GSSAPI authentication through SSH exposes the system's
GSSAPI to remote hosts, increasing the attack surface of the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82469-8</td>
  <td>Disable Accepting ICMP Redirects for All IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />
This feature of the IPv4 protocol has few legitimate uses. It should be
disabled unless absolutely required."
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82478-9</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures. This requirement
applies only to the forwarding of source-routerd traffic, such as when IPv4
forwarding is enabled and the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5(3)(a)</td>
  <td>CCE-82486-2</td>
  <td>Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.log_martians = 1</pre>
  </td>
  <td xml:lang="en-US">
The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82488-8</td>
  <td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.rp_filter = 1</pre>
  </td>
  <td xml:lang="en-US">
Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82482-1</td>
  <td>Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.secure_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82484-7</td>
  <td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.all.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.all.send_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82470-6</td>
  <td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages modify the
host's route table and are unauthenticated. An illicit ICMP redirect
message could result in a man-in-the-middle attack.
<br />This feature of the IPv4 protocol has few legitimate uses. It should
be disabled unless absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5<br/>SC-7(a)</td>
  <td>CCE-82479-7</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router,
which can be used to bypass network security measures.
<br />
Accepting source-routed packets in the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required, such as when
IPv4 forwarding is enabled and the system is legitimately functioning as a
router.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5(3)(a)</td>
  <td>CCE-82487-0</td>
  <td>Enable Kernel Paremeter to Log Martian Packets on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.log_martians=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.log_martians = 1</pre>
  </td>
  <td xml:lang="en-US">
The presence of "martian" packets (which have impossible addresses)
as well as spoofed packets, source-routed packets, and redirects could be a
sign of nefarious network activity. Logging these packets enables this activity
to be detected.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82489-6</td>
  <td>Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.rp_filter = 1</pre>
  </td>
  <td xml:lang="en-US">
Enabling reverse path filtering drops packets with source addresses
that should not have been able to be received on the interface they were
received on. It should not be used on systems which are routers for
complicated networks, but is helpful for end hosts and routers serving small
networks.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5<br/>SC-7(a)</td>
  <td>CCE-82483-9</td>
  <td>Configure Kernel Parameter for Accepting Secure Redirects By Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.secure_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
Accepting "secure" ICMP redirects (from those gateways listed as
default gateways) has few legitimate uses. It should be disabled unless it is
absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5<br/>CM-6(a)<br/>SC-7(a)</td>
  <td>CCE-82485-4</td>
  <td>Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.conf.default.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.conf.default.send_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
ICMP redirect messages are used by routers to inform hosts that a more
direct route exists for a particular destination. These messages contain information
from the system's route table possibly revealing portions of the network topology.
<br />
The ability to send ICMP redirects is only appropriate for systems acting as routers.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5</td>
  <td>CCE-82491-2</td>
  <td>Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.icmp_echo_ignore_broadcasts</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_echo_ignore_broadcasts = 1</pre>
  </td>
  <td xml:lang="en-US">
Responding to broadcast (ICMP) echoes facilitates network mapping
and provides a vector for amplification attacks.
<br />
Ignoring ICMP echo requests (pings) sent to broadcast or multicast
addresses makes the system slightly more difficult to enumerate on the network.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5</td>
  <td>CCE-82490-4</td>
  <td>Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.icmp_ignore_bogus_error_responses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.icmp_ignore_bogus_error_responses = 1</pre>
  </td>
  <td xml:lang="en-US">
Ignoring bogus ICMP error responses reduces
log size, although some activity would not be logged.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>SC-5(1)<br/>SC-5(2)<br/>SC-5(3)(a)<br/>CM-6(a)</td>
  <td>CCE-82492-0</td>
  <td>Enable Kernel Parameter to Use TCP Syncookies on IPv4 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv4.tcp_syncookies</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_syncookies=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv4.tcp_syncookies = 1</pre>
  </td>
  <td xml:lang="en-US">
A TCP SYN flood attack can cause a denial of service by filling a
system's TCP connection table with connections in the SYN_RCVD state.
Syncookies can be used to track a connection when a subsequent ACK is received,
verifying the initiator is attempting a valid connection and is not a flood
source. This feature is activated when a flood condition is detected, and
enables the system to continue servicing valid connection requests.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82467-2</td>
  <td>Configure Accepting Router Advertisements on All IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_ra = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit router advertisement message could result in a man-in-the-middle attack.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>CM-6(b)<br/>CM-6.1(iv)</td>
  <td>CCE-82471-4</td>
  <td>Disable Accepting ICMP Redirects for All IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit ICMP redirect message could result in a man-in-the-middle attack.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82480-5</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.all.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.
<br /><br />
Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82468-0</td>
  <td>Disable Accepting Router Advertisements on all IPv6 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_ra = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit router advertisement message could result in a man-in-the-middle attack.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>CCE-82477-1</td>
  <td>Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_redirects = 0</pre>
  </td>
  <td xml:lang="en-US">
An illicit ICMP redirect message could result in a man-in-the-middle attack.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>CM-6(b)<br/>CM-6.1(iv)</td>
  <td>CCE-82481-3</td>
  <td>Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>net.ipv6.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>net.ipv6.conf.default.accept_source_route = 0</pre>
  </td>
  <td xml:lang="en-US">
Source-routed packets allow the source of the packet to suggest routers
forward the packet along a different path than configured on the router, which can
be used to bypass network security measures. This requirement applies only to the
forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and
the system is functioning as a router.

Accepting source-routed packets in the IPv6 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-7(1)</td>
  <td>CCE-82466-4</td>
  <td>Disable network management of chrony daemon</td>
  <td xml:lang="en-US">
The <tt>cmdport</tt> option in <tt>/etc/chrony.conf</tt> can be set to
<tt>0</tt> to stop chrony daemon from listening on the UDP port 323
for management connections made by chronyc.
  </td>
  <td xml:lang="en-US">
Not exposing the management interface of the chrony daemon on
the network diminishes the attack space.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-7(10)</td>
  <td>CCE-82530-7</td>
  <td>Disable acquiring, saving, and processing core dumps</td>
  <td xml:lang="en-US">
The <tt>systemd-coredump.socket</tt> unit is a socket activation of
the <tt>systemd-coredump@.service</tt> which processes core dumps.
By masking the unit, core dump processing is disabled.
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data
and is generally useful only for developers trying to debug problems.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-7(10)</td>
  <td>CCE-82527-3</td>
  <td>Disable storing core dumps</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.core_pattern</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.core_pattern=|/bin/false</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.core_pattern = |/bin/false</pre>
  </td>
  <td xml:lang="en-US">
A core dump includes a memory image taken at the time the operating system
terminates an application. The memory image could contain sensitive data and is generally useful
only for developers trying to debug problems.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-7(10)</td>
  <td>CCE-82501-8</td>
  <td>Restrict usage of ptrace to descendant processes</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.yama.ptrace_scope</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.yama.ptrace_scope=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.yama.ptrace_scope = 1</pre>
  </td>
  <td xml:lang="en-US">
Unrestricted usage of ptrace allows compromised binaries to run ptrace
on another processes of the user. Like this, the attacker can steal
sensitive information from the target processes (e.g. SSH sessions, web browser, ...)
without any additional assistance from the user (i.e. without resorting to phishing).

  </td>
  <td></td>
</tr>
<tr>
  <td>AC-8(a)<br/>AC-8(c)<br/>AC-17(a)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Enable SSH Warning Banner</td>
  <td xml:lang="en-US">
To enable the warning banner and ensure it is consistent
across the system, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>Banner /etc/issue</pre>
Another section contains information on how to create an
appropriate system-wide warning banner.
  </td>
  <td xml:lang="en-US">
The warning message reinforces policy awareness during the logon process and
facilitates possible legal action against attackers. Alternatively, systems
whose ownership should not be obvious should ensure usage of a banner that does
not provide easy attribution.
  </td>
  <td></td>
</tr>
<tr>
  <td>AU-8(1)</td>
  <td>CCE-82465-6</td>
  <td>Disable chrony daemon from acting as server</td>
  <td xml:lang="en-US">
The <tt>port</tt> option in <tt>/etc/chrony.conf</tt> can be set to
<tt>0</tt> to make chrony daemon to never open any listening port
for server operation and to operate strictly in a client-only mode.
  </td>
  <td xml:lang="en-US">
Minimizing the exposure of the server functionality of the chrony
daemon diminishes the attack surface.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-8(3)<br/>IA-3</td>
  <td>CCE-82524-0</td>
  <td>Install usbguard Package</td>
  <td xml:lang="en-US">

The <tt>usbguard</tt> package can be installed with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-usbguard-install
spec:
  config:
    ignition:
      version: 3.1.0
  extensions:
    - usbguard
</pre>
<p>
This will install the <tt>usbguard</tt> package in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
<tt>usbguard</tt> is a software framework that helps to protect
against rogue USB devices by implementing basic whitelisting/blacklisting
capabilities based on USB device attributes.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-8(3)(a)<br/>IA-3</td>
  <td>CCE-82537-2</td>
  <td>Enable the USBGuard Service</td>
  <td xml:lang="en-US">
The USBGuard service should be enabled.

The <code>usbguard</code> service can be enabled with the following manifest:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 75-master-usbguard-enable
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
      - name: usbguard.service
        enabled: true
</pre>
<p>
This will enable the <tt>usbguard</tt> service in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>
  </td>
  <td xml:lang="en-US">
The <tt>usbguard</tt> service must be running in order to
enforce the USB device authorization policy for all USB devices.
  </td>
  <td></td>
</tr>
<tr>
  <td>CM-8(3)<br/>IA-3</td>
  <td>CCE-82539-8</td>
  <td>Authorize Human Interface Devices and USB hubs in USBGuard daemon</td>
  <td xml:lang="en-US">
To allow authorization of USB devices combining human interface device and hub capabilities
by USBGuard daemon,
add the line
<tt>allow with-interface match-all { 03:*:* 09:00:* }</tt>
to <tt>/etc/usbguard/rules.conf</tt>.
  </td>
  <td xml:lang="en-US">
Without allowing Human Interface Devices, it might not be possible
to interact with the system. Without allowing hubs, it might not be possible to use any
USB devices on the system.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-10<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Limit the Number of Concurrent Login Sessions Allowed Per User</td>
  <td xml:lang="en-US">
Limiting the number of allowed users and sessions per user can limit risks related to Denial of
Service attacks. This addresses concurrent sessions for a single account and does not address
concurrent sessions by a single user via multiple accounts. To set the number of concurrent
sessions per user add the following line in <tt>/etc/security/limits.conf</tt> or
a file under <tt>/etc/security/limits.d/</tt>:
<pre>* hard maxlogins <tt>10</tt></pre>
  </td>
  <td xml:lang="en-US">
Limiting simultaneous user logins can insulate the system from denial of service
problems caused by excessive logins. Automated login processes operating improperly or
maliciously may result in an exceptional number of simultaneous login sessions.
  </td>
  <td>var_accounts_max_concurrent_login_sessions=10</td>
</tr>
<tr>
  <td>AU-11<br/>CM-6(a)</td>
  <td>CCE-82508-3</td>
  <td>Configure auditd flush priority</td>
  <td xml:lang="en-US">
The <tt>auditd</tt> service can be configured to
synchronously write audit event data to disk. Add or correct the following
line in <tt>/etc/audit/auditd.conf</tt> to ensure that audit event data is
fully synchronized with the log files on the disk:
<pre>flush = <tt>incremental_async</tt></pre>
  </td>
  <td xml:lang="en-US">
Audit data should be synchronously written to disk to ensure
log integrity. These parameters assure that all audit event data is fully
synchronized with the log files on the disk.
  </td>
  <td>var_auditd_flush=incremental_async</td>
</tr>
<tr>
  <td>AC-11(a)<br/>AC-11(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Configure the tmux Lock Command</td>
  <td xml:lang="en-US">
To enable console screen locking in <tt>tmux</tt> terminal multiplexer,
the <tt>vlock</tt> command must be configured to be used as a locking
mechanism.
Add the following line to <tt>/etc/tmux.conf</tt>:
<pre>set -g lock-command vlock</pre>.
The console can now be locked with the following key combination:
<pre>ctrl+b :lock-session</pre>
  </td>
  <td xml:lang="en-US">
The <tt>tmux</tt> package allows for a session lock to be implemented and configured.
However, the session lock is implemented by an external command. The <tt>tmux</tt>
default configuration does not contain an effective session lock.
  </td>
  <td></td>
</tr>
<tr>
  <td>SI-11(a)<br/>SI-11(b)</td>
  <td>CCE-82499-5</td>
  <td>Restrict Access to Kernel Message Buffer</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.dmesg_restrict</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.dmesg_restrict=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.dmesg_restrict = 1</pre>
  </td>
  <td xml:lang="en-US">
Unprivileged access to the kernel syslog can expose sensitive kernel
address information.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-12(2)<br/>SC-12(3)<br/>IA-7<br/>SC-13<br/>CM-6(a)<br/>SC-12</td>
  <td>CCE-82540-6</td>
  <td>Enable FIPS Mode</td>
  <td xml:lang="en-US">
To enable FIPS mode, run the following command:
<pre>fips-mode-setup --enable</pre>
<br />
The <tt>fips-mode-setup</tt> command will configure the system in
FIPS mode by automatically configuring the following:
<ul>
<li>Setting the kernel FIPS mode flag (<tt>/proc/sys/crypto/fips_enabled</tt>) to <tt>1</tt></li>
<li>Creating <tt>/etc/system-fips</tt></li>
<li>Setting the system crypto policy in <tt>/etc/crypto-policies/config</tt> to <tt><tt>fips_ospp</tt></tt></li>
<li>Loading the Dracut <tt>fips</tt> module</li>
</ul>
  </td>
  <td xml:lang="en-US">
Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to
protect data. The operating system must implement cryptographic modules adhering to the higher
standards approved by the federal government since this provides assurance they have been tested
and validated.
  </td>
  <td>var_system_crypto_policy=fips_ospp</td>
</tr>
<tr>
  <td>SC-13<br/>SC-12(2)<br/>SC-12(3)</td>
  <td>CCE-82547-1</td>
  <td>Configure Kerberos to use System Crypto Policy</td>
  <td xml:lang="en-US">
Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
Kerberos is supported by crypto policy, but it's configuration may be
set up to ignore it.
To check that Crypto Policies settings for Kerberos are configured correctly, examine that there is a symlink at
/etc/krb5.conf.d/crypto-policies targeting /etc/cypto-policies/back-ends/krb5.config.
If the symlink exists, kerberos is configured to use the system-wide crypto policy settings.
  </td>
  <td xml:lang="en-US">
Overriding the system crypto policy makes the behavior of Kerberos violate expectations,
and makes system configuration more fragmented.
  </td>
  <td></td>
</tr>
<tr>
  <td>SI-16</td>
  <td>CCE-82497-9</td>
  <td>Enable Kernel Page-Table Isolation (KPTI)</td>
  <td xml:lang="en-US">
To enable Kernel page-table isolation, add the argument <tt>pti=on</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
Kernel page-table isolation is a kernel feature that mitigates
the Meltdown security vulnerability and hardens the kernel
against attempts to bypass kernel address space layout
randomization (KASLR).
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-17(a)<br/>AC-17(2)<br/>CM-6(a)<br/>MA-4(6)<br/>SC-13<br/>SC-12(2)<br/>SC-12(3)</td>
  <td>CCE-82541-4</td>
  <td>Configure System Cryptography Policy</td>
  <td xml:lang="en-US">
To configure the system cryptography policy to use ciphers only from the <tt><tt>fips_ospp</tt></tt>
policy, create a <tt>MachineConfig</tt> as follows:
<pre>
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 50-master-configure-crypto-policy
spec:
  config:
    ignition:
      version: 3.1.0
    systemd:
      units:
        - name: configure-crypto-policy.service
          enabled: true
          contents: |
            [Unit]
            Before=kubelet.service
            [Service]
            Type=oneshot
            ExecStart=update-crypto-policies --set <tt>fips_ospp</tt>
            RemainAfterExit=yes
            [Install]
            WantedBy=multi-user.target
</pre>
<p>
This will configure the crypto policy appropriately in all the
nodes labeled with the "master" role.
</p>
<p>
Note that this needs to be done for each <tt>MachineConfigPool</tt>
</p>
<p>
For more information on how to configure nodes with the Machine Config
Operator see
<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the relevant documentation</a>.
</p>

The rule checks if settings for selected crypto policy are configured as expected. Configuration files in the <tt>/etc/crypto-policies/back-ends</tt> are either symlinks to correct files provided by Crypto-policies package or they are regular files in case crypto policy customizations are applied.
Crypto policies may be customized by crypto policy modules, in which case it is delimited from the base policy using a colon.
  </td>
  <td xml:lang="en-US">
Centralized cryptographic policies simplify applying secure ciphers across an operating system and
the applications that run on that operating system. Use of weak or untested encryption algorithms
undermines the purposes of utilizing encryption to protect data.
  </td>
  <td>var_system_crypto_policy=fips_ospp</td>
</tr>
<tr>
  <td>AC-17(a)<br/>AC-17(2)<br/>CM-6(a)<br/>MA-4(6)<br/>SC-13<br/>SC-12(2)<br/>SC-12(3)</td>
  <td>CCE-82545-5</td>
  <td>Configure OpenSSL library to use System Crypto Policy</td>
  <td xml:lang="en-US">
Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
OpenSSL is supported by crypto policy, but the OpenSSL configuration may be
set up to ignore it.
To check that Crypto Policies settings are configured correctly, you have to examine the OpenSSL config file
available under <tt>/etc/pki/tls/openssl.cnf</tt>.
This file has the <tt>ini</tt> format, and it enables crypto policy support
if there is a <tt>[ crypto_policy ]</tt> section that contains the <tt>.include /etc/crypto-policies/back-ends/opensslcnf.config</tt> directive.
  </td>
  <td xml:lang="en-US">
Overriding the system crypto policy makes the behavior of the Java runtime violates expectations,
and makes system configuration more fragmented.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-17(a)<br/>AC-17(2)<br/>CM-6(a)<br/>MA-4(6)<br/>SC-13</td>
  <td>N/A</td>
  <td>Configure SSH to use System Crypto Policy</td>
  <td xml:lang="en-US">
Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
SSH is supported by crypto policy, but the SSH configuration may be
set up to ignore it.
To check that Crypto Policies settings are configured correctly, ensure that
the <tt>CRYPTO_POLICY</tt> variable is either commented or not set at all
in the <tt>/etc/sysconfig/sshd</tt>.
  </td>
  <td xml:lang="en-US">
Overriding the system crypto policy makes the behavior of the SSH service violate expectations,
and makes system configuration more fragmented.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-17(a)<br/>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Disable SSH Access via Empty Passwords</td>
  <td xml:lang="en-US">
Disallow SSH login with empty passwords.
The default SSH configuration disables logins with empty passwords. The appropriate
configuration is used if no value is set for <tt>PermitEmptyPasswords</tt>.
<br />
To explicitly disallow SSH login from accounts with empty passwords,
add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<br />
<pre>PermitEmptyPasswords no</pre>
Any accounts with empty passwords should be disabled immediately, and PAM configuration
should prevent users from being able to assign themselves empty passwords.
  </td>
  <td xml:lang="en-US">
Configuring this setting for the SSH daemon provides additional assurance
that remote login via SSH will require a password, even in the event of
misconfiguration elsewhere.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-17(a)<br/>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)</td>
  <td>N/A</td>
  <td>Disable Kerberos Authentication</td>
  <td xml:lang="en-US">
Unless needed, SSH should not permit extraneous or unnecessary
authentication mechanisms like Kerberos.
<br/>
The default SSH configuration disallows authentication validation through Kerberos.
The appropriate configuration is used if no value is set for <tt>KerberosAuthentication</tt>.
<br/>
To explicitly disable Kerberos authentication, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>KerberosAuthentication no</pre>
  </td>
  <td xml:lang="en-US">
Kerberos authentication for SSH is often implemented using GSSAPI. If Kerberos
is enabled through SSH, the SSH daemon provides a means of access to the
system's Kerberos implementation. Vulnerabilities in the system's Kerberos
implementations may be subject to exploitation.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-17(1)<br/>AU-14(1)<br/>AU-10<br/>CM-6(a)<br/>IR-5(1)</td>
  <td>CCE-82670-1</td>
  <td>Enable Auditing for Processes Which Start Prior to the Audit Daemon</td>
  <td xml:lang="en-US">
To ensure all processes can be audited, even those which start
prior to the audit daemon, add the argument <tt>audit=1</tt> to all
BLS (Boot Loader Specification) entries ('options' line) for the Linux
operating system in <tt>/boot/loader/entries/*.conf</tt>.
  </td>
  <td xml:lang="en-US">
Each process on the system carries an "auditable" flag which indicates whether
its activities can be audited. Although <tt>auditd</tt> takes care of enabling
this for all processes which launch after it does, adding the kernel argument
ensures it is set for every process during boot.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-18</td>
  <td>CCE-82518-2</td>
  <td>Disable ATM Support</td>
  <td xml:lang="en-US">
The Asynchronous Transfer Mode (ATM) is a protocol operating on
network, data link, and physical layers, based on virtual circuits
and virtual paths.

To configure the system to prevent the <code>atm</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install atm /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling ATM protects the system against exploitation of any
flaws in its implementation.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-18(a)<br/>AC-18(3)<br/>CM-7(a)<br/>CM-7(b)<br/>CM-6(a)<br/>MP-7</td>
  <td>CCE-82515-8</td>
  <td>Disable Bluetooth Kernel Module</td>
  <td xml:lang="en-US">
The kernel's module loading system can be configured to prevent
loading of the Bluetooth module. Add the following to
the appropriate <tt>/etc/modprobe.d</tt> configuration file
to prevent the loading of the Bluetooth module:
<pre>install bluetooth /bin/true</pre>
  </td>
  <td xml:lang="en-US">
If Bluetooth functionality must be disabled, preventing the kernel
from loading the kernel module provides an additional safeguard against its
activation.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-18</td>
  <td>CCE-82519-0</td>
  <td>Disable CAN Support</td>
  <td xml:lang="en-US">
The Controller Area Network (CAN) is a serial communications
protocol which was initially developed for automotive and
is now also used in marine, industrial, and medical applications.

To configure the system to prevent the <code>can</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install can /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling CAN protects the system against exploitation of any
flaws in its implementation.
  </td>
  <td></td>
</tr>
<tr>
  <td>AC-18</td>
  <td>CCE-82517-4</td>
  <td>Disable IEEE 1394 (FireWire) Support</td>
  <td xml:lang="en-US">
The IEEE 1394 (FireWire) is a serial bus standard for
high-speed real-time communication.

To configure the system to prevent the <code>firewire-core</code>
kernel module from being loaded, add the following line to a file in the directory <code>/etc/modprobe.d</code>:
<pre>install firewire-core /bin/true</pre>
  </td>
  <td xml:lang="en-US">
Disabling FireWire protects the system against exploitation of any
flaws in its implementation.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-30<br/>SC-30(2)<br/>SC-30(5)<br/>CM-6(a)</td>
  <td>CCE-82498-7</td>
  <td>Restrict Exposed Kernel Pointer Addresses Access</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>kernel.kptr_restrict</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.kptr_restrict=1</pre>
To make sure that the setting is persistent, add the following line to a file in the directory <tt>/etc/sysctl.d</tt>: <pre>kernel.kptr_restrict = 1</pre>
  </td>
  <td xml:lang="en-US">
Exposing kernel pointers (through procfs or <tt>seq_printf()</tt>) exposes
kernel writeable structures that can contain functions pointers. If a write vulnereability occurs
in the kernel allowing a write access to any of this structure, the kernel can be compromise. This
option disallow any program withtout the CAP_SYSLOG capability from getting the kernel pointers addresses,
replacing them with 0.
  </td>
  <td></td>
</tr>
<tr>
  <td>SC-39<br/>CM-6(a)</td>
  <td>CCE-82503-4</td>
  <td>Disable the use of user namespaces</td>
  <td xml:lang="en-US">
To set the runtime status of the <code>user.max_user_namespaces</code> kernel parameter,
run the following command:
<pre>$ sudo sysctl -w user.max_user_namespaces=0</pre>

To make sure that the setting is persistent,
add the following line to a file in the directory <tt>/etc/sysctl.d</tt>:
<pre>user.max_user_namespaces = 0</pre>
When containers are deployed on the machine, the value should be set
to large non-zero value.
  </td>
  <td xml:lang="en-US">
User namespaces are used primarily for Linux containers. The value 0
disallows the use of user namespaces.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Support session locking with tmux</td>
  <td xml:lang="en-US">
The <tt>tmux</tt> terminal multiplexer is used to implement
automatic session locking. It should be started from
<tt>/etc/bashrc</tt> or drop-in files within <tt>/etc/profile.d/</tt>.
  </td>
  <td xml:lang="en-US">
Unlike <tt>bash</tt> itself, the <tt>tmux</tt> terminal multiplexer
provides a mechanism to lock sessions after period of inactivity.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Configure tmux to lock session after inactivity</td>
  <td xml:lang="en-US">
To enable console screen locking in <tt>tmux</tt> terminal multiplexer
after a period of inactivity,
the <tt>lock-after-time</tt> option has to be set to nonzero value in
<tt>/etc/tmux.conf</tt>.
  </td>
  <td xml:lang="en-US">
Locking the session after a period of inactivity limits the
potential exposure if the session is left unattended.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Disable Kerberos by removing host keytab</td>
  <td xml:lang="en-US">
Kerberos is not an approved key distribution method for
Common Criteria. To prevent using Kerberos by system daemons,
remove the Kerberos keytab files, especially
<tt>/etc/krb5.keytab</tt>.
  </td>
  <td xml:lang="en-US">
The key derivation function (KDF) in Kerberos is not FIPS compatible.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>CCE-82740-2</td>
  <td>Add nodev Option to /home</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/home</tt>.
Legitimate character and block devices should exist only in
the <tt>/dev</tt> directory on the root partition or within chroot
jails built for system services.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/home</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>CCE-82735-2</td>
  <td>Add nodev Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>nodev</tt> mount option can be used to prevent device files from
being created in <tt>/var/tmp</tt>. Legitimate character and block devices
should not exist within temporary directories like <tt>/var/tmp</tt>.
Add the <code>nodev</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
The only legitimate location for device files is the <tt>/dev</tt> directory
located on the root partition. The only exception to this is chroot jails.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>CCE-82866-5</td>
  <td>Add noexec Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>noexec</tt> mount option can be used to prevent binaries
from being executed out of <tt>/var/tmp</tt>.
Add the <code>noexec</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
Allowing users to execute binaries from world-writable directories
such as <tt>/var/tmp</tt> should never be necessary in normal operation and
can expose the system to potential compromise.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>CCE-82736-0</td>
  <td>Add nosuid Option to /var/tmp</td>
  <td xml:lang="en-US">
The <tt>nosuid</tt> mount option can be used to prevent
execution of setuid programs in <tt>/var/tmp</tt>. The SUID and SGID permissions
should not be required in these world-writable directories.
Add the <code>nosuid</code> option to the list of
<code>Options</code> in the <code>systemd.mount</code> unit that
controls mounting of
<code>/var/tmp</code>.
  </td>
  <td xml:lang="en-US">
The presence of SUID and SGID executables should be tightly controlled. Users
should not be able to execute SUID or SGID binaries from temporary storage partitions.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Configure session renegotiation for SSH client</td>
  <td xml:lang="en-US">
The <tt>RekeyLimit</tt> parameter specifies how often
the session key is renegotiated, both in terms of
amount of data that may be transmitted and the time
elapsed. To decrease the default limits, put line
<tt>RekeyLimit <tt>1G</tt> <tt>1hour</tt></tt> to file <tt>/etc/ssh/ssh_config.d/02-rekey-limit.conf</tt>.
Make sure that there is no other <tt>RekeyLimit</tt> configuration preceding
the <tt>include</tt> directive in the main config file
<tt>/etc/ssh/ssh_config</tt>. Check also other files in
<tt>/etc/ssh/ssh_config.d</tt> directory. Files are processed according to
lexicographical order of file names. Make sure that there is no file
processed before <tt>02-rekey-limit.conf</tt> containing definition of
<tt>RekeyLimit</tt>.
  </td>
  <td xml:lang="en-US">
By decreasing the limit based on the amount of data and enabling
time-based limit, effects of potential attacks against
encryption keys are limited.
  </td>
  <td>var_ssh_client_rekey_limit_time=1hour<br/>var_ssh_client_rekey_limit_size=1G</td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Force frequent session key renegotiation</td>
  <td xml:lang="en-US">
The <tt>RekeyLimit</tt> parameter specifies how often
the session key of the is renegotiated, both in terms of
amount of data that may be transmitted and the time
elapsed.<br/>
To decrease the default limits, add or correct the following line in


<tt>/etc/ssh/sshd_config</tt>:

<pre>RekeyLimit <tt>1G</tt> <tt>1hour</tt></pre>
  </td>
  <td xml:lang="en-US">
By decreasing the limit based on the amount of data and enabling
time-based limit, effects of potential attacks against
encryption keys are limited.
  </td>
  <td>var_rekey_limit_time=1hour<br/>var_rekey_limit_size=1G</td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Enable Auditing to Start Prior to the Audit Daemon in zIPL</td>
  <td xml:lang="en-US">
To ensure all processes can be audited, even those which start prior to the audit daemon,
check that all boot entries in <tt>/boot/loader/entries/*.conf</tt> have <tt>audit=1</tt>
included in its options.<br />

To ensure that new kernels and boot entries continue to enable audit,
add <tt>audit=1</tt> to <tt>/etc/kernel/cmdline</tt>.
  </td>
  <td xml:lang="en-US">
Each process on the system carries an "auditable" flag which indicates whether
its activities can be audited. Although <tt>auditd</tt> takes care of enabling
this for all processes which launch after it does, adding the kernel argument
ensures it is set for every process during boot.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Extend Audit Backlog Limit for the Audit Daemon in zIPL</td>
  <td xml:lang="en-US">
To improve the kernel capacity to queue all log events, even those which start prior to the audit daemon,
check that all boot entries in <tt>/boot/loader/entries/*.conf</tt> have <tt>audit_backlog_limit=8192</tt>
included in its options.<br />
To ensure that new kernels and boot entries continue to extend the audit log events queue,
add <tt>audit_backlog_limit=8192</tt> to <tt>/etc/kernel/cmdline</tt>.
  </td>
  <td xml:lang="en-US">
audit_backlog_limit sets the queue length for audit events awaiting transfer
to the audit daemon. Until the audit daemon is up and running, all log messages
are stored in this queue.  If the queue is overrun during boot process, the action
defined by audit failure flag is taken.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Ensure all zIPL boot entries are BLS compliant</td>
  <td xml:lang="en-US">
Ensure that zIPL boot entries fully adheres to Boot Loader Specification (BLS)
by checking that <tt>/etc/zipl.conf</tt> doesn't contain <tt>image = </tt>.
  </td>
  <td xml:lang="en-US">
Red Hat Enterprise Linux CoreOS 4 adheres to Boot Loader Specification (BLS) and is the prefered method of
configuration.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Ensure zIPL bootmap is up to date</td>
  <td xml:lang="en-US">
Make sure that <tt>/boot/bootmap</tt> is up to date.<br />
Every time a boot entry or zIPL configuration is changed <tt>/boot/bootmap</tt> needs to
be updated to reflect the changes.<br />
Run <tt>zipl</tt> command to generate an updated <tt>/boot/bootmap</tt>.
  </td>
  <td xml:lang="en-US">
The file <tt>/boot/bootmap</tt> contains all boot data, keeping it up to date is crucial to
boot correct kernel and options.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Enable page allocator poisoning in zIPL</td>
  <td xml:lang="en-US">
To enable poisoning of free pages,
check that all boot entries in <tt>/boot/loader/entries/*.conf</tt> have <tt>page_poison=1</tt>
included in its options.<br />
To ensure that new kernels and boot entries continue to enable page poisoning,
add <tt>page_poison=1</tt> to <tt>/etc/kernel/cmdline</tt>.
  </td>
  <td xml:lang="en-US">
Poisoning writes an arbitrary value to freed pages, so any modification or
reference to that page after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Enable SLUB/SLAB allocator poisoning in zIPL</td>
  <td xml:lang="en-US">
To enable poisoning of SLUB/SLAB objects,
check that all boot entries in <tt>/boot/loader/entries/*.conf</tt> have <tt>slub_debug=P</tt>
included in its options.<br />
To ensure that new kernels and boot entries continue to enable poisoning of SLUB/SLAB objects,
add <tt>slub_debug=P</tt> to <tt>/etc/kernel/cmdline</tt>.
  </td>
  <td xml:lang="en-US">
Poisoning writes an arbitrary value to freed objects, so any modification or
reference to that object after being freed or before being initialized will be
detected and prevented.
This prevents many types of use-after-free vulnerabilities at little performance cost.
Also prevents leak of data and detection of corrupted memory.
  </td>
  <td></td>
</tr>
<tr>
  <td></td>
  <td>N/A</td>
  <td>Disable vsyscalls in zIPL</td>
  <td xml:lang="en-US">
To disable use of virtual syscalls,
check that all boot entries in <tt>/boot/loader/entries/*.conf</tt> have <tt>vsyscall=none</tt>
included in its options.<br />
To ensure that new kernels and boot entries continue to disable virtual syscalls,
add <tt>vsyscall=none</tt> to <tt>/etc/kernel/cmdline</tt>.
  </td>
  <td xml:lang="en-US">
Virtual Syscalls provide an opportunity of attack for a user who has control
of the return instruction pointer.
  </td>
  <td></td>
</tr>
</table>

</body>
</html>